!function(r,e){"object"==typeof exports&&"object"==typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(r.acorn||(r.acorn={}))}(this,function(r){"use strict";var e,t,n,i;r.version="0.5.0",r.parse=function(s,f){return t=String(s),n=t.length,function o(s){for(var f in e=s||{},a)Object.prototype.hasOwnProperty.call(e,f)||(e[f]=a[f]);i=e.sourceFile||null}(f),function Ht(){k=1,u=U=0,m=!0,ae()}(),function nr(s){G=D=u,e.locations&&(Y=new z),F=M=null,w=[],ee();var f=s||I(),l=!0;for(s||(f.body=[]);d!==Se;){var p=B();f.body.push(p),l&&Le(p)&&De(!0),l=!1}return y(f,"Program")}(e.program)};var u,h,E,b,S,d,v,m,k,U,G,D,Y,F,w,M,a={strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null},c=function(s,f){for(var l=1,p=0;;){_e.lastIndex=p;var g=_e.exec(s);if(!(g&&g.index<f))break;++l,p=g.index+g[0].length}return{line:l,column:f-p}};function O(s,f){var l=c(t,s),p=new SyntaxError(f+=" ("+l.line+":"+l.column+")");throw p.pos=s,p.loc=l,p.raisedAt=u,p}var Ct=[],le={type:"num"},Xe={type:"regexp"},Oe={type:"string"},$={type:"name"},Se={type:"eof"},me={keyword:"break"},Ne={keyword:"case",beforeExpr:!0},He={keyword:"catch"},Je={keyword:"continue"},qe={keyword:"debugger"},We={keyword:"default"},Qe={keyword:"do",isLoop:!0},ze={keyword:"else",beforeExpr:!0},Ke={keyword:"finally"},$e={keyword:"for",isLoop:!0},Pe={keyword:"function"},Ze={keyword:"if"},et={keyword:"return",beforeExpr:!0},Te={keyword:"switch"},tt={keyword:"throw",beforeExpr:!0},rt={keyword:"try"},we={keyword:"var"},Ce={keyword:"while",isLoop:!0},it={keyword:"with"},nt={keyword:"new",beforeExpr:!0},at={keyword:"this"},ot={keyword:"null",atomValue:null},ut={keyword:"true",atomValue:!0},st={keyword:"false",atomValue:!1},pe={keyword:"in",binop:7,beforeExpr:!0},At={break:me,case:Ne,catch:He,continue:Je,debugger:qe,default:We,do:Qe,else:ze,finally:Ke,for:$e,function:Pe,if:Ze,return:et,switch:Te,throw:tt,try:rt,var:we,while:Ce,with:it,null:ot,true:ut,false:st,new:nt,in:pe,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:at,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},Ae={type:"[",beforeExpr:!0},xe={type:"]"},ie={type:"{",beforeExpr:!0},Z={type:"}"},V={type:"(",beforeExpr:!0},j={type:")"},J={type:",",beforeExpr:!0},X={type:";",beforeExpr:!0},ne={type:":",beforeExpr:!0},ct={type:"."},ft={type:"?",beforeExpr:!0},lt={binop:10,beforeExpr:!0},pt={isAssign:!0,beforeExpr:!0},Q={isAssign:!0,beforeExpr:!0},xt={postfix:!0,prefix:!0,isUpdate:!0},ht={prefix:!0,beforeExpr:!0},dt={binop:1,beforeExpr:!0},Et={binop:2,beforeExpr:!0},It={binop:3,beforeExpr:!0},Dt={binop:4,beforeExpr:!0},Lt={binop:5,beforeExpr:!0},kt={binop:6,beforeExpr:!0},Ut={binop:7,beforeExpr:!0},Mt={binop:8,beforeExpr:!0},Ft={binop:9,prefix:!0,beforeExpr:!0},Bt={binop:10,beforeExpr:!0};function he(s){s=s.split(" ");for(var f=Object.create(null),l=0;l<s.length;l++)f[s[l]]=!0;return function(p){return f[p]||!1}}var te,jt=he("class enum extends super const export import"),_t=he("implements interface let package private protected public static yield"),de=he("eval arguments"),Gt=he("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Yt=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,yt="\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",vt=new RegExp("["+yt+"]"),Xt=new RegExp("["+yt+"\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u0620-\u0649\u0672-\u06d3\u06e7-\u06e8\u06fb-\u06fc\u0730-\u074a\u0800-\u0814\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0840-\u0857\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962-\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09d7\u09df-\u09e0\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5f-\u0b60\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62-\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2-\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d46-\u0d48\u0d57\u0d62-\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e34-\u0e3a\u0e40-\u0e45\u0e50-\u0e59\u0eb4-\u0eb9\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f41-\u0f47\u0f71-\u0f84\u0f86-\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1029\u1040-\u1049\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u170e-\u1710\u1720-\u1730\u1740-\u1750\u1772\u1773\u1780-\u17b2\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1920-\u192b\u1930-\u193b\u1951-\u196d\u19b0-\u19c0\u19c8-\u19c9\u19d0-\u19d9\u1a00-\u1a15\u1a20-\u1a53\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b46-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1bb0-\u1bb9\u1be6-\u1bf3\u1c00-\u1c22\u1c40-\u1c49\u1c5b-\u1c7d\u1cd0-\u1cd2\u1d00-\u1dbe\u1e01-\u1f15\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2d81-\u2d96\u2de0-\u2dff\u3021-\u3028\u3099\u309a\ua640-\ua66d\ua674-\ua67d\ua69f\ua6f0-\ua6f1\ua7f8-\ua800\ua806\ua80b\ua823-\ua827\ua880-\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8f3-\ua8f7\ua900-\ua909\ua926-\ua92d\ua930-\ua945\ua980-\ua983\ua9b3-\ua9c0\uaa00-\uaa27\uaa40-\uaa41\uaa4c-\uaa4d\uaa50-\uaa59\uaa7b\uaae0-\uaae9\uaaf2-\uaaf3\uabc0-\uabe1\uabec\uabed\uabf0-\uabf9\ufb20-\ufb28\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]"),Ee=/[\n\r\u2028\u2029]/,_e=/\r\n|[\n\r\u2028\u2029]/g,ye=function(s){return s<65?36===s:s<91||(s<97?95===s:s<123||s>=170&&vt.test(String.fromCharCode(s)))},gt=function(s){return s<48?36===s:s<58||!(s<65)&&(s<91||(s<97?95===s:s<123||s>=170&&Xt.test(String.fromCharCode(s))))};function z(){this.line=k,this.column=u-U}function A(s,f){E=u,e.locations&&(S=new z),d=s,ae(),v=f,m=s.beforeExpr}function Jt(){var s=e.onComment&&e.locations&&new z,f=u,l=t.indexOf("*/",u+=2);if(-1===l&&O(u-2,"Unterminated comment"),u=l+2,e.locations){_e.lastIndex=f;for(var p;(p=_e.exec(t))&&p.index<u;)++k,U=p.index+p[0].length}e.onComment&&e.onComment(!0,t.slice(f+2,l),f,u,s,e.locations&&new z)}function Ie(){for(var s=u,f=e.onComment&&e.locations&&new z,l=t.charCodeAt(u+=2);u<n&&10!==l&&13!==l&&8232!==l&&8233!==l;)++u,l=t.charCodeAt(u);e.onComment&&e.onComment(!1,t.slice(s+2,u),s,u,f,e.locations&&new z)}function ae(){for(;u<n;){var s=t.charCodeAt(u);if(32===s)++u;else if(13===s)++u,10===(f=t.charCodeAt(u))&&++u,e.locations&&(++k,U=u);else if(10===s||8232===s||8233===s)++u,e.locations&&(++k,U=u);else if(s>8&&s<14)++u;else if(47===s){var f;if(42===(f=t.charCodeAt(u+1)))Jt();else{if(47!==f)break;Ie()}}else if(160===s)++u;else{if(!(s>=5760&&Yt.test(String.fromCharCode(s))))break;++u}}}function ee(s){if(s?u=h+1:h=u,e.locations&&(b=new z),s)return Rt();if(u>=n)return A(Se);var f=t.charCodeAt(u);if(ye(f)||92===f)return St();var l=function tr(s){switch(s){case 46:return function qt(){var s=t.charCodeAt(u+1);return s>=48&&s<=57?bt(!0):(++u,A(ct))}();case 40:return++u,A(V);case 41:return++u,A(j);case 59:return++u,A(X);case 44:return++u,A(J);case 91:return++u,A(Ae);case 93:return++u,A(xe);case 123:return++u,A(ie);case 125:return++u,A(Z);case 58:return++u,A(ne);case 63:return++u,A(ft);case 48:var f=t.charCodeAt(u+1);if(120===f||88===f)return function rr(){u+=2;var s=oe(16);return null==s&&O(h+2,"Expected hexadecimal number"),ye(t.charCodeAt(u))&&O(u,"Identifier directly after number"),A(le,s)}();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return bt(!1);case 34:case 39:return function ir(s){u++;for(var f="";;){u>=n&&O(h,"Unterminated string constant");var l=t.charCodeAt(u);if(l===s)return++u,A(Oe,f);if(92===l){l=t.charCodeAt(++u);var p=/^[0-7]+/.exec(t.slice(u,u+3));for(p&&(p=p[0]);p&&parseInt(p,8)>255;)p=p.slice(0,-1);if("0"===p&&(p=null),++u,p)M&&O(u-2,"Octal literal in strict mode"),f+=String.fromCharCode(parseInt(p,8)),u+=p.length-1;else switch(l){case 110:f+="\n";break;case 114:f+="\r";break;case 120:f+=String.fromCharCode(ve(2));break;case 117:f+=String.fromCharCode(ve(4));break;case 85:f+=String.fromCharCode(ve(8));break;case 116:f+="\t";break;case 98:f+="\b";break;case 118:f+="\v";break;case 102:f+="\f";break;case 48:f+="\0";break;case 13:10===t.charCodeAt(u)&&++u;case 10:e.locations&&(U=u,++k);break;default:f+=String.fromCharCode(l)}}else(13===l||10===l||8232===l||8233===l)&&O(h,"Unterminated string constant"),f+=String.fromCharCode(l),++u}}(s);case 47:return function Wt(){var s=t.charCodeAt(u+1);return m?(++u,Rt()):61===s?x(Q,2):x(lt,1)}();case 37:case 42:return function Qt(){return 61===t.charCodeAt(u+1)?x(Q,2):x(Bt,1)}();case 124:case 38:return function zt(s){var f=t.charCodeAt(u+1);return f===s?x(124===s?dt:Et,2):61===f?x(Q,2):x(124===s?It:Lt,1)}(s);case 94:return function Kt(){return 61===t.charCodeAt(u+1)?x(Q,2):x(Dt,1)}();case 43:case 45:return function $t(s){var f=t.charCodeAt(u+1);return f===s?45==f&&62==t.charCodeAt(u+2)&&Ee.test(t.slice(D,u))?(u+=3,Ie(),ae(),ee()):x(xt,2):61===f?x(Q,2):x(Ft,1)}(s);case 60:case 62:return function Zt(s){var f=t.charCodeAt(u+1),l=1;return f===s?(l=62===s&&62===t.charCodeAt(u+2)?3:2,61===t.charCodeAt(u+l)?x(Q,l+1):x(Mt,l)):33==f&&60==s&&45==t.charCodeAt(u+2)&&45==t.charCodeAt(u+3)?(u+=4,Ie(),ae(),ee()):(61===f&&(l=61===t.charCodeAt(u+2)?3:2),x(Ut,l))}(s);case 61:case 33:return function er(s){return 61===t.charCodeAt(u+1)?x(kt,61===t.charCodeAt(u+2)?3:2):x(61===s?pt:ht,1)}(s);case 126:return x(ht,1)}return!1}(f);if(!1===l){var p=String.fromCharCode(f);if("\\"===p||vt.test(p))return St();O(u,"Unexpected character '"+p+"'")}return l}function x(s,f){var l=t.slice(u,u+f);u+=f,A(s,l)}function Rt(){for(var s,f,l=u;;){u>=n&&O(l,"Unterminated regular expression");var p=t.charAt(u);if(Ee.test(p)&&O(l,"Unterminated regular expression"),s)s=!1;else{if("["===p)f=!0;else if("]"===p&&f)f=!1;else if("/"===p&&!f)break;s="\\"===p}++u}var g=t.slice(l,u);++u;var _=Ot();_&&!/^[gmi]*$/.test(_)&&O(l,"Invalid regexp flag");try{var R=new RegExp(g,_)}catch(P){P instanceof SyntaxError&&O(l,P.message),O(P)}return A(Xe,R)}function oe(s,f){for(var l=u,p=0,g=0,_=f??1/0;g<_;++g){var P,R=t.charCodeAt(u);if((P=R>=97?R-97+10:R>=65?R-65+10:R>=48&&R<=57?R-48:1/0)>=s)break;++u,p=p*s+P}return u===l||null!=f&&u-l!==f?null:p}function bt(s){var f=u,l=!1,p=48===t.charCodeAt(u);!s&&null===oe(10)&&O(f,"Invalid number"),46===t.charCodeAt(u)&&(++u,oe(10),l=!0);var g=t.charCodeAt(u);(69===g||101===g)&&((43===(g=t.charCodeAt(++u))||45===g)&&++u,null===oe(10)&&O(f,"Invalid number"),l=!0),ye(t.charCodeAt(u))&&O(u,"Identifier directly after number");var R,_=t.slice(f,u);return l?R=parseFloat(_):p&&1!==_.length?/[89]/.test(_)||M?O(f,"Invalid number"):R=parseInt(_,8):R=parseInt(_,10),A(le,R)}function ve(s){var f=oe(16,s);return null===f&&O(h,"Bad character escape sequence"),f}function Ot(){te=!1;for(var s,f=!0,l=u;;){var p=t.charCodeAt(u);if(gt(p))te&&(s+=t.charAt(u)),++u;else{if(92!==p)break;te||(s=t.slice(l,u)),te=!0,117!=t.charCodeAt(++u)&&O(u,"Expecting Unicode escape sequence \\uXXXX"),++u;var g=ve(4),_=String.fromCharCode(g);_||O(u-1,"Invalid Unicode escape"),(f?ye(g):gt(g))||O(u-4,"Invalid Unicode escape"),s+=_}f=!1}return te?s:t.slice(l,u)}function St(){var s=Ot(),f=$;return!te&&Gt(s)&&(f=At[s]),A(f,s)}function N(){G=h,D=E,Y=S,ee()}function De(s){if(M=s,u=h,e.locations)for(;u<U;)U=t.lastIndexOf("\n",U-2)+1,--k;ae(),ee()}function mt(){this.type=null,this.start=h,this.end=null}function Nt(){this.start=b,this.end=null,null!==i&&(this.source=i)}function I(){var s=new mt;return e.locations&&(s.loc=new Nt),e.directSourceFile&&(s.sourceFile=e.directSourceFile),e.ranges&&(s.range=[h,0]),s}function q(s){var f=new mt;return f.start=s.start,e.locations&&(f.loc=new Nt,f.loc.start=s.loc.start),e.ranges&&(f.range=[s.range[0],0]),f}function y(s,f){return s.type=f,s.end=D,e.locations&&(s.loc.end=Y),e.ranges&&(s.range[1]=D),s}function Le(s){return"ExpressionStatement"===s.type&&"Literal"===s.expression.type&&"use strict"===s.expression.value}function T(s){if(d===s)return N(),!0}function ge(){return!e.strictSemicolons&&(d===Se||d===Z||Ee.test(t.slice(D,h)))}function K(){!T(X)&&!ge()&&H()}function C(s){d===s?N():H()}function H(){O(h,"Unexpected token")}function Re(s){"Identifier"!==s.type&&"MemberExpression"!==s.type&&O(s.start,"Assigning to rvalue"),M&&"Identifier"===s.type&&de(s.name)&&O(s.start,"Assigning to "+s.name+" in strict mode")}var ke={kind:"loop"},ar={kind:"switch"};function B(){(d===lt||d===Q&&"/="==v)&&ee(!0);var s=d,f=I();switch(s){case me:case Je:N();var l=s===me;T(X)||ge()?f.label=null:d!==$?H():(f.label=W(),K());for(var p=0;p<w.length;++p){var g=w[p];if((null==f.label||g.name===f.label.name)&&(null!=g.kind&&(l||"loop"===g.kind)||f.label&&l))break}return p===w.length&&O(f.start,"Unsyntactic "+s.keyword),y(f,l?"BreakStatement":"ContinueStatement");case qe:return N(),K(),y(f,"DebuggerStatement");case Qe:return N(),w.push(ke),f.body=B(),w.pop(),C(Ce),f.test=ue(),K(),y(f,"DoWhileStatement");case $e:if(N(),w.push(ke),C(V),d===X)return Ue(f,null);if(d===we){var _=I();return N(),Tt(_,!0),y(_,"VariableDeclaration"),1===_.declarations.length&&T(pe)?Pt(f,_):Ue(f,_)}return _=L(!1,!0),T(pe)?(Re(_),Pt(f,_)):Ue(f,_);case Pe:return N(),Ge(f,!0);case Ze:return N(),f.test=ue(),f.consequent=B(),f.alternate=T(ze)?B():null,y(f,"IfStatement");case et:return!F&&!e.allowReturnOutsideFunction&&O(h,"'return' outside of function"),N(),T(X)||ge()?f.argument=null:(f.argument=L(),K()),y(f,"ReturnStatement");case Te:N(),f.discriminant=ue(),f.cases=[],C(ie),w.push(ar);for(var R,P;d!=Z;)if(d===Ne||d===We){var fe=d===Ne;R&&y(R,"SwitchCase"),f.cases.push(R=I()),R.consequent=[],N(),fe?R.test=L():(P&&O(G,"Multiple default clauses"),P=!0,R.test=null),C(ne)}else R||H(),R.consequent.push(B());return R&&y(R,"SwitchCase"),N(),w.pop(),y(f,"SwitchStatement");case tt:return N(),Ee.test(t.slice(D,h))&&O(D,"Illegal newline after throw"),f.argument=L(),K(),y(f,"ThrowStatement");case rt:if(N(),f.block=se(),f.handler=null,d===He){var re=I();N(),C(V),re.param=W(),M&&de(re.param.name)&&O(re.param.start,"Binding "+re.param.name+" in strict mode"),C(j),re.body=se(),f.handler=y(re,"CatchClause")}return f.finalizer=T(Ke)?se():null,!f.handler&&!f.finalizer&&O(f.start,"Missing catch or finally clause"),y(f,"TryStatement");case we:return N(),Tt(f),K(),y(f,"VariableDeclaration");case Ce:return N(),f.test=ue(),w.push(ke),f.body=B(),w.pop(),y(f,"WhileStatement");case it:return M&&O(h,"'with' in strict mode"),N(),f.object=ue(),f.body=B(),y(f,"WithStatement");case ie:return se();case X:return N(),y(f,"EmptyStatement");default:var Ve=v,be=L();if(s===$&&"Identifier"===be.type&&T(ne)){for(p=0;p<w.length;++p)w[p].name===Ve&&O(be.start,"Label '"+Ve+"' is already declared");return w.push({name:Ve,kind:d.isLoop?"loop":d===Te?"switch":null}),f.body=B(),w.pop(),f.label=be,y(f,"LabeledStatement")}return f.expression=be,K(),y(f,"ExpressionStatement")}}function ue(){C(V);var s=L();return C(j),s}function se(s){var g,f=I(),l=!0,p=!1;for(f.body=[],C(ie);!T(Z);){var _=B();f.body.push(_),l&&s&&Le(_)&&(g=p,De(p=!0)),l=!1}return p&&!g&&De(!1),y(f,"BlockStatement")}function Ue(s,f){return s.init=f,C(X),s.test=d===X?null:L(),C(X),s.update=d===j?null:L(),C(j),s.body=B(),w.pop(),y(s,"ForStatement")}function Pt(s,f){return s.left=f,s.right=L(),C(j),s.body=B(),w.pop(),y(s,"ForInStatement")}function Tt(s,f){for(s.declarations=[],s.kind="var";;){var l=I();if(l.id=W(),M&&de(l.id.name)&&O(l.id.start,"Binding "+l.id.name+" in strict mode"),l.init=T(pt)?L(!0,f):null,s.declarations.push(y(l,"VariableDeclarator")),!T(J))break}return s}function L(s,f){var l=Me(f);if(!s&&d===J){var p=q(l);for(p.expressions=[l];T(J);)p.expressions.push(Me(f));return y(p,"SequenceExpression")}return l}function Me(s){var f=function or(s){var f=function ur(s){return Fe(Be(),-1,s)}(s);if(T(ft)){var l=q(f);return l.test=f,l.consequent=L(!0),C(ne),l.alternate=L(!0,s),y(l,"ConditionalExpression")}return f}(s);if(d.isAssign){var l=q(f);return l.operator=v,l.left=f,N(),l.right=Me(s),Re(f),y(l,"AssignmentExpression")}return f}function Fe(s,f,l){var p=d.binop;if(null!=p&&(!l||d!==pe)&&p>f){var g=q(s);g.left=s,g.operator=v;var _=d;return N(),g.right=Fe(Be(),p,l),Fe(y(g,_===dt||_===Et?"LogicalExpression":"BinaryExpression"),f,l)}return s}function Be(){if(d.prefix){var s=I(),f=d.isUpdate;return s.operator=v,s.prefix=!0,m=!0,N(),s.argument=Be(),f?Re(s.argument):M&&"delete"===s.operator&&"Identifier"===s.argument.type&&O(s.start,"Deleting local variable in strict mode"),y(s,f?"UpdateExpression":"UnaryExpression")}for(var l=function sr(){return ce(je())}();d.postfix&&!ge();)(s=q(l)).operator=v,s.prefix=!1,s.argument=l,Re(l),N(),l=y(s,"UpdateExpression");return l}function ce(s,f){var l;return T(ct)?((l=q(s)).object=s,l.property=W(!0),l.computed=!1,ce(y(l,"MemberExpression"),f)):T(Ae)?((l=q(s)).object=s,l.property=L(),l.computed=!0,C(xe),ce(y(l,"MemberExpression"),f)):!f&&T(V)?((l=q(s)).callee=s,l.arguments=Ye(j,!1),ce(y(l,"CallExpression"),f)):s}function je(){switch(d){case at:var p=I();return N(),y(p,"ThisExpression");case $:return W();case le:case Oe:case Xe:return(p=I()).value=v,p.raw=t.slice(h,E),N(),y(p,"Literal");case ot:case ut:case st:return(p=I()).value=d.atomValue,p.raw=d.keyword,N(),y(p,"Literal");case V:var s=b,f=h;N();var l=L();return l.start=f,l.end=E,e.locations&&(l.loc.start=s,l.loc.end=S),e.ranges&&(l.range=[f,E]),C(j),l;case Ae:return p=I(),N(),p.elements=Ye(xe,!0,!0),y(p,"ArrayExpression");case ie:return function fr(){var s=I(),f=!0,l=!1;for(s.properties=[],N();!T(Z);){if(f)f=!1;else if(C(J),e.allowTrailingCommas&&T(Z))break;var _,p={key:wt()},g=!1;if(T(ne)?(p.value=L(!0),_=p.kind="init"):"Identifier"!==p.key.type||"get"!==p.key.name&&"set"!==p.key.name?H():(g=l=!0,_=p.kind=p.key.name,p.key=wt(),d!==V&&H(),p.value=Ge(I(),!1)),"Identifier"===p.key.type&&(M||l))for(var R=0;R<s.properties.length;++R){var P=s.properties[R];if(P.key.name===p.key.name){var fe=_==P.kind||g&&"init"===P.kind||"init"===_&&("get"===P.kind||"set"===P.kind);fe&&!M&&"init"===_&&"init"===P.kind&&(fe=!1),fe&&O(p.key.start,"Redefinition of property")}}s.properties.push(p)}return y(s,"ObjectExpression")}();case Pe:return p=I(),N(),Ge(p,!1);case nt:return function cr(){var s=I();return N(),s.callee=ce(je(),!0),s.arguments=T(V)?Ye(j,!1):Ct,y(s,"NewExpression")}();default:H()}}function wt(){return d===le||d===Oe?je():W(!0)}function Ge(s,f){d===$?s.id=W():f?H():s.id=null,s.params=[];var l=!0;for(C(V);!T(j);)l?l=!1:C(J),s.params.push(W());var p=F,g=w;if(F=!0,w=[],s.body=se(!0),F=p,w=g,M||s.body.body.length&&Le(s.body.body[0]))for(var _=s.id?-1:0;_<s.params.length;++_){var R=_<0?s.id:s.params[_];if((_t(R.name)||de(R.name))&&O(R.start,"Defining '"+R.name+"' in strict mode"),_>=0)for(var P=0;P<_;++P)R.name===s.params[P].name&&O(R.start,"Argument name clash in strict mode")}return y(s,f?"FunctionDeclaration":"FunctionExpression")}function Ye(s,f,l){for(var p=[],g=!0;!T(s);){if(g)g=!1;else if(C(J),f&&e.allowTrailingCommas&&T(s))break;p.push(l&&d===J?null:L(!0))}return p}function W(s){var f=I();return s&&"everywhere"==e.forbidReserved&&(s=!1),d===$?(!s&&(e.forbidReserved&&jt(v)||M&&_t(v))&&-1==t.slice(h,E).indexOf("\\")&&O(h,"The keyword '"+v+"' is reserved"),f.name=v):s&&d.keyword?f.name=d.keyword:H(),m=!1,N(),y(f,"Identifier")}});var DragDropTouch,Interpreter=function(r,e){"string"==typeof r&&(r=this.parse_(r,"code"));var t=r.constructor;this.newNode=function(){return new t({options:{}})};var n=this.newNode();for(var i in r)n[i]="body"===i?r[i].slice():r[i];this.ast=n,this.initFunc_=e,this.paused_=!1,this.polyfills_=[],this.functionCounter_=0,this.stepFunctions_=Object.create(null);var o,a=/^step([A-Z]\w*)$/;for(var c in this)"function"==typeof this[c]&&(o=c.match(a))&&(this.stepFunctions_[o[1]]=this[c].bind(this));this.globalScope=this.createScope(this.ast,null),this.globalObject=this.globalScope.object,this.ast=this.parse_(this.polyfills_.join("\n"),"polyfills"),this.polyfills_=void 0,Interpreter.stripLocations_(this.ast,void 0,void 0);var u=new Interpreter.State(this.ast,this.globalScope);u.done=!1,this.stateStack=[u],this.run(),this.value=void 0,this.ast=n,(u=new Interpreter.State(this.ast,this.globalScope)).done=!1,this.stateStack.length=0,this.stateStack[0]=u};Interpreter.Completion={NORMAL:0,BREAK:1,CONTINUE:2,RETURN:3,THROW:4},Interpreter.PARSE_OPTIONS={locations:!0,ecmaVersion:5},Interpreter.READONLY_DESCRIPTOR={configurable:!0,enumerable:!0,writable:!1},Interpreter.NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!0},Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!1},Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!1,enumerable:!1,writable:!1},Interpreter.VARIABLE_DESCRIPTOR={configurable:!1,enumerable:!0,writable:!0},Interpreter.STEP_ERROR={STEP_ERROR:!0},Interpreter.SCOPE_REFERENCE={SCOPE_REFERENCE:!0},Interpreter.VALUE_IN_DESCRIPTOR={VALUE_IN_DESCRIPTOR:!0},Interpreter.REGEXP_TIMEOUT={REGEXP_TIMEOUT:!0},Interpreter.toStringCycles_=[],Interpreter.vm=null,Interpreter.currentInterpreter_=null,Interpreter.nativeGlobal=typeof globalThis>"u"?this:globalThis,Interpreter.WORKER_CODE=["onmessage = function(e) {","var result;","var data = e.data;","switch (data[0]) {","case 'split':","result = data[1].split(data[2], data[3]);","break;","case 'match':","result = data[1].match(data[2]);","break;","case 'search':","result = data[1].search(data[2]);","break;","case 'replace':","result = data[1].replace(data[2], data[3]);","break;","case 'exec':","var regexp = data[1];","regexp.lastIndex = data[2];","result = [regexp.exec(data[3]), data[1].lastIndex];","break;","default:","throw Error('Unknown RegExp operation: ' + data[0]);","}","postMessage(result);","close();","};"],Interpreter.legalArrayLength=function(r){var e=r>>>0;return e===Number(r)?e:NaN},Interpreter.legalArrayIndex=function(r){var e=r>>>0;return String(e)===String(r)&&4294967295!==e?e:NaN},Interpreter.stripLocations_=function(r,e,t){for(var n in e?r.start=e:delete r.start,t?r.end=t:delete r.end,r)if("loc"!==n&&r.hasOwnProperty(n)){var i=r[n];i&&"object"==typeof i&&Interpreter.stripLocations_(i,e,t)}},Interpreter.prototype.REGEXP_MODE=2,Interpreter.prototype.REGEXP_THREAD_TIMEOUT=1e3,Interpreter.prototype.POLYFILL_TIMEOUT=1e3,Interpreter.prototype.getterStep_=!1,Interpreter.prototype.setterStep_=!1,Interpreter.prototype.appendCodeNumber_=0,Interpreter.prototype.parse_=function(r,e){var t={};for(var n in Interpreter.PARSE_OPTIONS)t[n]=Interpreter.PARSE_OPTIONS[n];return t.sourceFile=e,Interpreter.nativeGlobal.acorn.parse(r,t)},Interpreter.prototype.appendCode=function(r){var e=this.stateStack[0];if(!e||"Program"!==e.node.type)throw Error("Expecting original AST to start with a Program node");if("string"==typeof r&&(r=this.parse_(r,"appendCode"+this.appendCodeNumber_++)),!r||"Program"!==r.type)throw Error("Expecting new AST to start with a Program node");this.populateScope_(r,e.scope),Array.prototype.push.apply(e.node.body,r.body),e.node.body.variableCache_=null,e.done=!1},Interpreter.prototype.step=function(){var r=this.stateStack;do{var e=r[r.length-1];if(!e)return!1;var t=e.node,n=t.type;if("Program"===n&&e.done)return!1;if(this.paused_)return!0;var i=Interpreter.currentInterpreter_;Interpreter.currentInterpreter_=this;try{var a=this.stepFunctions_[n](r,e,t)}catch(c){if(c!==Interpreter.STEP_ERROR)throw this.value!==c&&(this.value=void 0),c}finally{Interpreter.currentInterpreter_=i}if(a&&r.push(a),this.getterStep_)throw this.value=void 0,Error("Getter not supported in this context");if(this.setterStep_)throw this.value=void 0,Error("Setter not supported in this context");if(!o&&!t.end)var o=Date.now()+this.POLYFILL_TIMEOUT}while(!t.end&&o>Date.now());return!0},Interpreter.prototype.run=function(){for(;!this.paused_&&this.step(););return this.paused_},Interpreter.prototype.initGlobal=function(r){this.setProperty(r,"NaN",NaN,Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"Infinity",1/0,Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"undefined",void 0,Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"window",r,Interpreter.READONLY_DESCRIPTOR),this.setProperty(r,"this",r,Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"self",r),this.OBJECT_PROTO=new Interpreter.Object(null),this.FUNCTION_PROTO=new Interpreter.Object(this.OBJECT_PROTO),this.initFunction(r),this.initObject(r),r.proto=this.OBJECT_PROTO,this.setProperty(r,"constructor",this.OBJECT,Interpreter.NONENUMERABLE_DESCRIPTOR),this.initArray(r),this.initString(r),this.initBoolean(r),this.initNumber(r),this.initDate(r),this.initRegExp(r),this.initError(r),this.initMath(r),this.initJSON(r);var e=this,t=this.createNativeFunction(function(o){throw EvalError("Can't happen")},!1);t.eval=!0,this.setProperty(r,"eval",t,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"parseInt",this.createNativeFunction(parseInt,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"parseFloat",this.createNativeFunction(parseFloat,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"isNaN",this.createNativeFunction(isNaN,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"isFinite",this.createNativeFunction(isFinite,!1),Interpreter.NONENUMERABLE_DESCRIPTOR);for(var n=[[escape,"escape"],[unescape,"unescape"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"]],i=0;i<n.length;i++){var a=function(o){return function(c){try{return o(c)}catch(u){e.throwException(e.URI_ERROR,u.message)}}}(n[i][0]);this.setProperty(r,n[i][1],this.createNativeFunction(a,!1),Interpreter.NONENUMERABLE_DESCRIPTOR)}this.OBJECT=this.OBJECT,this.OBJECT_PROTO=this.OBJECT_PROTO,this.FUNCTION=this.FUNCTION,this.FUNCTION_PROTO=this.FUNCTION_PROTO,this.ARRAY=this.ARRAY,this.ARRAY_PROTO=this.ARRAY_PROTO,this.REGEXP=this.REGEXP,this.REGEXP_PROTO=this.REGEXP_PROTO,this.DATE=this.DATE,this.DATE_PROTO=this.DATE_PROTO,this.initFunc_&&this.initFunc_(this,r)},Interpreter.prototype.functionCodeNumber_=0,Interpreter.prototype.initFunction=function(r){var t,e=this,n=/^[A-Za-z_$][\w$]*$/;t=function(a){if(arguments.length)var o=String(arguments[arguments.length-1]);else o="";var c=Array.prototype.slice.call(arguments,0,-1).join(",").trim();if(c){for(var u=c.split(/\s*,\s*/),h=0;h<u.length;h++){var E=u[h];n.test(E)||e.throwException(e.SYNTAX_ERROR,"Invalid function argument: "+E)}c=u.join(", ")}try{var b=e.parse_("(function("+c+") {"+o+"})","function"+e.functionCodeNumber_++)}catch(d){e.throwException(e.SYNTAX_ERROR,"Invalid code: "+d.message)}return 1!==b.body.length&&e.throwException(e.SYNTAX_ERROR,"Invalid code in function body."),e.createFunction(b.body[0].expression,e.globalScope,"anonymous")},this.FUNCTION=this.createNativeFunction(t,!0),this.setProperty(r,"Function",this.FUNCTION,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION,"prototype",this.FUNCTION_PROTO,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION_PROTO,"constructor",this.FUNCTION,Interpreter.NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.nativeFunc=function(){},this.FUNCTION_PROTO.nativeFunc.id=this.functionCounter_++,this.FUNCTION_PROTO.illegalConstructor=!0,this.setProperty(this.FUNCTION_PROTO,"length",0,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.class="Function",this.setNativeFunctionPrototype(this.FUNCTION,"apply",t=function(a,o){var c=e.stateStack[e.stateStack.length-1];c.func_=this,c.funcThis_=a,c.arguments_=[],null!=o&&(o instanceof Interpreter.Object?c.arguments_=e.arrayPseudoToNative(o):e.throwException(e.TYPE_ERROR,"CreateListFromArrayLike called on non-object")),c.doneExec_=!1}),t=function(a){var o=e.stateStack[e.stateStack.length-1];o.func_=this,o.funcThis_=a,o.arguments_=[];for(var c=1;c<arguments.length;c++)o.arguments_.push(arguments[c]);o.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"call",t),this.polyfills_.push("Object.defineProperty(Function.prototype, 'bind',","{configurable: true, writable: true, value:","function bind(oThis) {","if (typeof this !== 'function') {","throw TypeError('What is trying to be bound is not callable');","}","var aArgs   = Array.prototype.slice.call(arguments, 1),","fToBind = this,","fNOP    = function() {},","fBound  = function() {","return fToBind.apply(this instanceof fNOP","? this",": oThis,","aArgs.concat(Array.prototype.slice.call(arguments)));","};","if (this.prototype) {","fNOP.prototype = this.prototype;","}","fBound.prototype = new fNOP();","return fBound;","}","});",""),this.setNativeFunctionPrototype(this.FUNCTION,"toString",t=function(){return String(this)}),this.setProperty(this.FUNCTION,"toString",this.createNativeFunction(t,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setNativeFunctionPrototype(this.FUNCTION,"valueOf",t=function(){return this.valueOf()}),this.setProperty(this.FUNCTION,"valueOf",this.createNativeFunction(t,!1),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.initObject=function(r){var e=this;this.OBJECT=this.createNativeFunction(function(a){if(null==a)return e.calledWithNew()?this:e.createObjectProto(e.OBJECT_PROTO);if(!(a instanceof Interpreter.Object)){var o=e.createObjectProto(e.getPrototype(a));return o.data=a,o}return a},!0),this.setProperty(this.OBJECT,"prototype",this.OBJECT_PROTO,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT_PROTO,"constructor",this.OBJECT,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"Object",this.OBJECT,Interpreter.NONENUMERABLE_DESCRIPTOR);var n=function(i){null==i&&e.throwException(e.TYPE_ERROR,"Cannot convert '"+i+"' to object")};this.setProperty(this.OBJECT,"getOwnPropertyNames",this.createNativeFunction(function(a){return n(a),e.arrayNativeToPseudo(Object.getOwnPropertyNames(a instanceof Interpreter.Object?a.properties:a))},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"keys",this.createNativeFunction(function(a){return n(a),a instanceof Interpreter.Object&&(a=a.properties),e.arrayNativeToPseudo(Object.keys(a))},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"create",this.createNativeFunction(function(a){return null===a?e.createObjectProto(null):(a instanceof Interpreter.Object||e.throwException(e.TYPE_ERROR,"Object prototype may only be an Object or null"),e.createObjectProto(a))},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var create_ = Object.create;","Object.create = function create(proto, props) {","var obj = create_(proto);","props && Object.defineProperties(obj, props);","return obj;","};","})();",""),this.setProperty(this.OBJECT,"defineProperty",this.createNativeFunction(function(a,o,c){return o=String(o),a instanceof Interpreter.Object||e.throwException(e.TYPE_ERROR,"Object.defineProperty called on non-object"),c instanceof Interpreter.Object||e.throwException(e.TYPE_ERROR,"Property description must be an object"),!a.properties[o]&&a.preventExtensions&&e.throwException(e.TYPE_ERROR,"Can't define property '"+o+"', object is not extensible"),e.setProperty(a,o,Interpreter.VALUE_IN_DESCRIPTOR,c.properties),a},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var defineProperty_ = Object.defineProperty;","Object.defineProperty = function defineProperty(obj, prop, d1) {","var d2 = {};","if ('configurable' in d1) d2.configurable = d1.configurable;","if ('enumerable' in d1) d2.enumerable = d1.enumerable;","if ('writable' in d1) d2.writable = d1.writable;","if ('value' in d1) d2.value = d1.value;","if ('get' in d1) d2.get = d1.get;","if ('set' in d1) d2.set = d1.set;","return defineProperty_(obj, prop, d2);","};","})();","Object.defineProperty(Object, 'defineProperties',","{configurable: true, writable: true, value:","function defineProperties(obj, props) {","var keys = Object.keys(props);","for (var i = 0; i < keys.length; i++) {","Object.defineProperty(obj, keys[i], props[keys[i]]);","}","return obj;","}","});",""),this.setProperty(this.OBJECT,"getOwnPropertyDescriptor",this.createNativeFunction(function(a,o){if(a instanceof Interpreter.Object||e.throwException(e.TYPE_ERROR,"Object.getOwnPropertyDescriptor called on non-object"),(o=String(o))in a.properties){var c=Object.getOwnPropertyDescriptor(a.properties,o),u=a.getter[o],h=a.setter[o],E=e.createObjectProto(e.OBJECT_PROTO);return u||h?(e.setProperty(E,"get",u),e.setProperty(E,"set",h)):(e.setProperty(E,"value",c.value),e.setProperty(E,"writable",c.writable)),e.setProperty(E,"configurable",c.configurable),e.setProperty(E,"enumerable",c.enumerable),E}},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"getPrototypeOf",this.createNativeFunction(function(a){return n(a),e.getPrototype(a)},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"isExtensible",this.createNativeFunction(function(a){return Boolean(a)&&!a.preventExtensions},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"preventExtensions",this.createNativeFunction(function(a){return a instanceof Interpreter.Object&&(a.preventExtensions=!0),a},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setNativeFunctionPrototype(this.OBJECT,"toString",Interpreter.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"toLocaleString",Interpreter.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"valueOf",Interpreter.Object.prototype.valueOf),this.setNativeFunctionPrototype(this.OBJECT,"hasOwnProperty",function(a){return n(this),this instanceof Interpreter.Object?String(a)in this.properties:this.hasOwnProperty(a)}),this.setNativeFunctionPrototype(this.OBJECT,"propertyIsEnumerable",function(a){return n(this),this instanceof Interpreter.Object?Object.prototype.propertyIsEnumerable.call(this.properties,a):this.propertyIsEnumerable(a)}),this.setNativeFunctionPrototype(this.OBJECT,"isPrototypeOf",function(a){for(;;){if(!(a=e.getPrototype(a)))return!1;if(a===this)return!0}})},Interpreter.prototype.initArray=function(r){var t,e=this;t=function(i){if(e.calledWithNew())var a=this;else a=e.createArray();var o=arguments[0];if(1===arguments.length&&"number"==typeof o)isNaN(Interpreter.legalArrayLength(o))&&e.throwException(e.RANGE_ERROR,"Invalid array length"),a.properties.length=o;else{for(var c=0;c<arguments.length;c++)a.properties[c]=arguments[c];a.properties.length=c}return a},this.ARRAY=this.createNativeFunction(t,!0),this.ARRAY_PROTO=this.ARRAY.properties.prototype,this.setProperty(r,"Array",this.ARRAY,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ARRAY,"isArray",this.createNativeFunction(t=function(i){return i&&"Array"===i.class},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ARRAY_PROTO,"length",0,{configurable:!1,enumerable:!1,writable:!0}),this.ARRAY_PROTO.class="Array",this.polyfills_.push("(function() {","function createArrayMethod_(f) {","Object.defineProperty(Array.prototype, f.name,","{configurable: true, writable: true, value: f});","}","createArrayMethod_(","function pop() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","len--;","var x = o[len];","delete o[len];","o.length = len;","return x;","}",");","createArrayMethod_(","function push(var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","for (var i = 0; i < arguments.length; i++) {","o[len] = arguments[i];","len++;","}","o.length = len;","return len;","}",");","createArrayMethod_(","function shift() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","var value = o[0];","for (var i = 0; i < len - 1; i++) {","if ((i + 1) in o) {","o[i] = o[i + 1];","} else {","delete o[i];","}","}","delete o[i];","o.length = len - 1;","return value;","}",");","createArrayMethod_(","function unshift(var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","len = 0;","}","for (var i = len - 1; i >= 0; i--) {","if (i in o) {","o[i + arguments.length] = o[i];","} else {","delete o[i + arguments.length];","}","}","for (var i = 0; i < arguments.length; i++) {","o[i] = arguments[i];","}","return (o.length = len + arguments.length);","}",");","createArrayMethod_(","function reverse() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 2) {","return o;","}","for (var i = 0; i < len / 2 - 0.5; i++) {","var x = o[i];","var hasX = i in o;","if ((len - i - 1) in o) {","o[i] = o[len - i - 1];","} else {","delete o[i];","}","if (hasX) {","o[len - i - 1] = x;","} else {","delete o[len - i - 1];","}","}","return o;","}",");","createArrayMethod_(","function indexOf(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var n = fromIndex | 0;","if (!len || n >= len) {","return -1;","}","var i = Math.max(n >= 0 ? n : len - Math.abs(n), 0);","while (i < len) {","if (i in o && o[i] === searchElement) {","return i;","}","i++;","}","return -1;","}",");","createArrayMethod_(","function lastIndexOf(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len) {","return -1;","}","var n = len - 1;","if (arguments.length > 1) {","n = fromIndex | 0;","if (n) {","n = (n > 0 || -1) * Math.floor(Math.abs(n));","}","}","var i = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);","while (i >= 0) {","if (i in o && o[i] === searchElement) {","return i;","}","i--;","}","return -1;","}",");","createArrayMethod_(","function slice(start, end) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","start |= 0;","start = (start >= 0) ? start : Math.max(0, len + start);","if (typeof end !== 'undefined') {","if (end !== Infinity) {","end |= 0;","}","if (end < 0) {","end = len + end;","} else {","end = Math.min(end, len);","}","} else {","end = len;","}","var size = end - start;","var cloned = new Array(size);","for (var i = 0; i < size; i++) {","if ((start + i) in o) {","cloned[i] = o[start + i];","}","}","return cloned;","}",");","createArrayMethod_(","function splice(start, deleteCount, var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","start |= 0;","if (start < 0) {","start = Math.max(len + start, 0);","} else {","start = Math.min(start, len);","}","if (arguments.length < 1) {","deleteCount = len - start;","} else {","deleteCount |= 0;","deleteCount = Math.max(0, Math.min(deleteCount, len - start));","}","var removed = [];","for (var i = start; i < start + deleteCount; i++) {","if (i in o) {","removed.push(o[i]);","} else {","removed.length++;","}","if ((i + deleteCount) in o) {","o[i] = o[i + deleteCount];","} else {","delete o[i];","}","}","for (var i = start + deleteCount; i < len - deleteCount; i++) {","if ((i + deleteCount) in o) {","o[i] = o[i + deleteCount];","} else {","delete o[i];","}","}","for (var i = len - deleteCount; i < len; i++) {","delete o[i];","}","len -= deleteCount;","var arl = arguments.length - 2;","for (var i = len - 1; i >= start; i--) {","if (i in o) {","o[i + arl] = o[i];","} else {","delete o[i + arl];","}","}","len += arl;","for (var i = 2; i < arguments.length; i++) {","o[start + i - 2] = arguments[i];","}","o.length = len;","return removed;","}",");","createArrayMethod_(","function concat(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var cloned = [];","for (var i = -1; i < arguments.length; i++) {","var value = (i === -1) ? o : arguments[i];","if (Array.isArray(value)) {","for (var j = 0, l = value.length; j < l; j++) {","if (j in value) {","cloned.push(value[j]);","} else {","cloned.length++;","}","}","} else {","cloned.push(value);","}","}","return cloned;","}",");","createArrayMethod_(","function join(opt_separator) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var sep = typeof opt_separator === 'undefined' ?","',' : ('' + opt_separator);","var str = '';","for (var i = 0; i < len; i++) {","if (i && sep) {","str += sep;","}","str += (o[i] === null || o[i] === undefined) ? '' : o[i];","}","return str;","}",");","createArrayMethod_(","function every(callbackfn, thisArg) {","if (!this || typeof callbackfn !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","while (k < len) {","if (k in o && !callbackfn.call(t, o[k], k, o)) return false;","k++;","}","return true;","}",");","createArrayMethod_(","function filter(fun, var_args) {","if (this === void 0 || this === null || typeof fun !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var res = [];","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o) {","var val = o[i];","if (fun.call(thisArg, val, i, o)) res.push(val);","}","}","return res;","}",");","createArrayMethod_(","function forEach(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","while (k < len) {","if (k in o) callback.call(t, o[k], k, o);","k++;","}","}",");","createArrayMethod_(","function map(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","var a = new Array(len);","while (k < len) {","if (k in o) a[k] = callback.call(t, o[k], k, o);","k++;","}","return a;","}",");","createArrayMethod_(","function reduce(callback /*, initialValue*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var k = 0, value;","if (arguments.length === 2) {","value = arguments[1];","} else {","while (k < len && !(k in o)) k++;","if (k >= len) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k++];","}","for (; k < len; k++) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}",");","createArrayMethod_(","function reduceRight(callback /*, initialValue*/) {","if (null === this || 'undefined' === typeof this || 'function' !== typeof callback) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var k = len - 1, value;","if (arguments.length >= 2) {","value = arguments[1];","} else {","while (k >= 0 && !(k in o)) k--;","if (k < 0) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k--];","}","for (; k >= 0; k--) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}",");","createArrayMethod_(","function some(fun/*, thisArg*/) {","if (!this || typeof fun !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o && fun.call(thisArg, o[i], i, o)) {","return true;","}","}","return false;","}",");","createArrayMethod_(","function sort(opt_comp) {","if (!this) throw TypeError();","if (typeof opt_comp !== 'function') {","opt_comp = undefined;","}","for (var i = 0; i < this.length; i++) {","var changes = 0;","for (var j = 0; j < this.length - i - 1; j++) {","if (opt_comp ? (opt_comp(this[j], this[j + 1]) > 0) :","(String(this[j]) > String(this[j + 1]))) {","var swap = this[j];","var hasSwap = j in this;","if ((j + 1) in this) {","this[j] = this[j + 1];","} else {","delete this[j];","}","if (hasSwap) {","this[j + 1] = swap;","} else {","delete this[j + 1];","}","changes++;","}","}","if (!changes) break;","}","return this;","}",");","createArrayMethod_(","function toLocaleString() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var out = [];","for (var i = 0; i < len; i++) {","out[i] = (o[i] === null || o[i] === undefined) ? '' : o[i].toLocaleString();","}","return out.join(',');","}",");","})();","")},Interpreter.prototype.initString=function(r){var t,e=this;t=function(o){return o=arguments.length?Interpreter.nativeGlobal.String(o):"",e.calledWithNew()?(this.data=o,this):o},this.STRING=this.createNativeFunction(t,!0),this.setProperty(r,"String",this.STRING,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.STRING,"fromCharCode",this.createNativeFunction(String.fromCharCode,!1),Interpreter.NONENUMERABLE_DESCRIPTOR);for(var n=["charAt","charCodeAt","concat","indexOf","lastIndexOf","slice","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim"],i=0;i<n.length;i++)this.setNativeFunctionPrototype(this.STRING,n[i],String.prototype[n[i]]);this.setNativeFunctionPrototype(this.STRING,"localeCompare",t=function(o,c,u){c=e.pseudoToNative(c),u=e.pseudoToNative(u);try{return String(this).localeCompare(o,c,u)}catch(h){e.throwException(e.ERROR,"localeCompare: "+h.message)}}),this.setAsyncFunctionPrototype(this.STRING,"split",t=function(o,c,u){var h=String(this);if(c=c?Number(c):void 0,e.isa(o,e.REGEXP)&&(e.maybeThrowRegExp(o=o.data,u),2===e.REGEXP_MODE))if(Interpreter.vm)(v=e.vmCall("string.split(separator, limit)",{string:h,separator:o,limit:c},o,u))!==Interpreter.REGEXP_TIMEOUT&&u(e.arrayNativeToPseudo(v));else{var S=e.createWorker(),d=e.regExpTimeout(o,S,u);S.onmessage=function(m){clearTimeout(d),u(e.arrayNativeToPseudo(m.data))},S.postMessage(["split",h,o,c])}else{var v=h.split(o,c);u(e.arrayNativeToPseudo(v))}}),this.setAsyncFunctionPrototype(this.STRING,"match",t=function(o,c){var u=String(this);if(o=e.isa(o,e.REGEXP)?o.data:new RegExp(o),e.maybeThrowRegExp(o,c),2!==e.REGEXP_MODE)d=u.match(o),c(d&&e.arrayNativeToPseudo(d));else if(Interpreter.vm){var d;(d=e.vmCall("string.match(regexp)",{string:u,regexp:o},o,c))!==Interpreter.REGEXP_TIMEOUT&&c(d&&e.arrayNativeToPseudo(d))}else{var b=e.createWorker(),S=e.regExpTimeout(o,b,c);b.onmessage=function(v){clearTimeout(S),c(v.data&&e.arrayNativeToPseudo(v.data))},b.postMessage(["match",u,o])}}),this.setAsyncFunctionPrototype(this.STRING,"search",t=function(o,c){var u=String(this);if(o=e.isa(o,e.REGEXP)?o.data:new RegExp(o),e.maybeThrowRegExp(o,c),2!==e.REGEXP_MODE)c(u.search(o));else if(Interpreter.vm){var b=e.vmCall("string.search(regexp)",{string:u,regexp:o},o,c);b!==Interpreter.REGEXP_TIMEOUT&&c(b)}else{var S=e.createWorker(),d=e.regExpTimeout(o,S,c);S.onmessage=function(v){clearTimeout(d),c(v.data)},S.postMessage(["search",u,o])}}),this.setAsyncFunctionPrototype(this.STRING,"replace",t=function(o,c,u){var h=String(this);if(c=String(c),e.isa(o,e.REGEXP)&&(e.maybeThrowRegExp(o=o.data,u),2===e.REGEXP_MODE))if(Interpreter.vm){var S=e.vmCall("string.replace(substr, newSubstr)",{string:h,substr:o,newSubstr:c},o,u);S!==Interpreter.REGEXP_TIMEOUT&&u(S)}else{var d=e.createWorker(),v=e.regExpTimeout(o,d,u);d.onmessage=function(m){clearTimeout(v),u(m.data)},d.postMessage(["replace",h,o,c])}else u(h.replace(o,c))}),this.polyfills_.push("(function() {","var replace_ = String.prototype.replace;","String.prototype.replace = function replace(substr, newSubstr) {","if (typeof newSubstr !== 'function') {","return replace_.call(this, substr, newSubstr);","}","var str = this;","if (substr instanceof RegExp) {","var subs = [];","var m = substr.exec(str);","while (m) {","m.push(m.index, str);","var inject = newSubstr.apply(null, m);","subs.push([m.index, m[0].length, inject]);","m = substr.global ? substr.exec(str) : null;","}","for (var i = subs.length - 1; i >= 0; i--) {","str = str.substring(0, subs[i][0]) + subs[i][2] + str.substring(subs[i][0] + subs[i][1]);","}","} else {","var i = str.indexOf(substr);","if (i !== -1) {","var inject = newSubstr(str.substr(i, substr.length), i, str);","str = str.substring(0, i) + inject + str.substring(i + substr.length);","}","}","return str;","};","})();","")},Interpreter.prototype.initBoolean=function(r){var e=this;this.BOOLEAN=this.createNativeFunction(function(i){return i=Interpreter.nativeGlobal.Boolean(i),e.calledWithNew()?(this.data=i,this):i},!0),this.setProperty(r,"Boolean",this.BOOLEAN,Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.initNumber=function(r){var t,e=this;t=function(o){return o=arguments.length?Interpreter.nativeGlobal.Number(o):0,e.calledWithNew()?(this.data=o,this):o},this.NUMBER=this.createNativeFunction(t,!0),this.setProperty(r,"Number",this.NUMBER,Interpreter.NONENUMERABLE_DESCRIPTOR);for(var n=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],i=0;i<n.length;i++)this.setProperty(this.NUMBER,n[i],Number[n[i]],Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);this.setNativeFunctionPrototype(this.NUMBER,"toExponential",t=function(o){try{return Number(this).toExponential(o)}catch(c){e.throwException(e.ERROR,c.message)}}),this.setNativeFunctionPrototype(this.NUMBER,"toFixed",t=function(o){try{return Number(this).toFixed(o)}catch(c){e.throwException(e.ERROR,c.message)}}),this.setNativeFunctionPrototype(this.NUMBER,"toPrecision",t=function(o){try{return Number(this).toPrecision(o)}catch(c){e.throwException(e.ERROR,c.message)}}),this.setNativeFunctionPrototype(this.NUMBER,"toString",t=function(o){try{return Number(this).toString(o)}catch(c){e.throwException(e.ERROR,c.message)}}),this.setNativeFunctionPrototype(this.NUMBER,"toLocaleString",t=function(o,c){return o=o?e.pseudoToNative(o):void 0,c=c?e.pseudoToNative(c):void 0,Number(this).toLocaleString(o,c)})},Interpreter.prototype.initDate=function(r){var t,e=this;t=function(o,c){if(!e.calledWithNew())return Interpreter.nativeGlobal.Date();var u=[null].concat(Array.from(arguments));return this.data=new(Function.prototype.bind.apply(Interpreter.nativeGlobal.Date,u)),this},this.DATE=this.createNativeFunction(t,!0),this.DATE_PROTO=this.DATE.properties.prototype,this.setProperty(r,"Date",this.DATE,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"now",this.createNativeFunction(Date.now,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"parse",this.createNativeFunction(Date.parse,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"UTC",this.createNativeFunction(Date.UTC,!1),Interpreter.NONENUMERABLE_DESCRIPTOR);for(var n=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toISOString","toJSON","toGMTString","toLocaleDateString","toLocaleString","toLocaleTimeString","toTimeString","toUTCString"],i=0;i<n.length;i++)t=function(a){return function(o){var c=this.data;c instanceof Date||e.throwException(e.TYPE_ERROR,a+" not called on a Date");for(var u=[],h=0;h<arguments.length;h++)u[h]=e.pseudoToNative(arguments[h]);return c[a].apply(c,u)}}(n[i]),this.setNativeFunctionPrototype(this.DATE,n[i],t)},Interpreter.prototype.initRegExp=function(r){var e=this;this.REGEXP=this.createNativeFunction(function(i,a){if(e.calledWithNew())var o=this;else{if(void 0===a&&e.isa(i,e.REGEXP))return i;o=e.createObjectProto(e.REGEXP_PROTO)}i=void 0===i?"":String(i),a=a?String(a):"",/^[gmi]*$/.test(a)||e.throwException(e.SYNTAX_ERROR,"Invalid regexp flag");try{var c=new Interpreter.nativeGlobal.RegExp(i,a)}catch(u){e.throwException(e.SYNTAX_ERROR,u.message)}return e.populateRegExp(o,c),o},!0),this.REGEXP_PROTO=this.REGEXP.properties.prototype,this.setProperty(r,"RegExp",this.REGEXP,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"global",void 0,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"ignoreCase",void 0,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"multiline",void 0,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"source","(?:)",Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("Object.defineProperty(RegExp.prototype, 'test',","{configurable: true, writable: true, value:","function test(str) {","return !!this.exec(str);","}","});"),this.setAsyncFunctionPrototype(this.REGEXP,"exec",function(i,a){var o=this.data;if(i=String(i),o.lastIndex=Number(e.getProperty(this,"lastIndex")),e.maybeThrowRegExp(o,a),2!==e.REGEXP_MODE)S=o.exec(i),e.setProperty(this,"lastIndex",o.lastIndex),a(d(S));else if(Interpreter.vm){var S;(S=e.vmCall("regexp.exec(string)",{string:i,regexp:o},o,a))!==Interpreter.REGEXP_TIMEOUT&&(e.setProperty(this,"lastIndex",o.lastIndex),a(d(S)))}else{var h=e.createWorker(),E=e.regExpTimeout(o,h,a),b=this;h.onmessage=function(v){clearTimeout(E),e.setProperty(b,"lastIndex",v.data[1]),a(d(v.data[0]))},h.postMessage(["exec",o,o.lastIndex,i])}function d(v){if(v){var m=e.arrayNativeToPseudo(v);return e.setProperty(m,"index",v.index),e.setProperty(m,"input",v.input),m}return null}})},Interpreter.prototype.initError=function(r){var e=this;this.ERROR=this.createNativeFunction(function(i){if(e.calledWithNew())var a=this;else a=e.createObject(e.ERROR);return e.populateError(a,i),a},!0),this.setProperty(r,"Error",this.ERROR,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"message","",Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"name","Error",Interpreter.NONENUMERABLE_DESCRIPTOR);var t=function(n){var i=e.createNativeFunction(function(a){if(e.calledWithNew())var o=this;else o=e.createObject(i);return e.populateError(o,a),o},!0);return e.setProperty(i,"prototype",e.createObject(e.ERROR),Interpreter.NONENUMERABLE_DESCRIPTOR),e.setProperty(i.properties.prototype,"name",n,Interpreter.NONENUMERABLE_DESCRIPTOR),e.setProperty(r,n,i,Interpreter.NONENUMERABLE_DESCRIPTOR),i};this.EVAL_ERROR=t("EvalError"),this.RANGE_ERROR=t("RangeError"),this.REFERENCE_ERROR=t("ReferenceError"),this.SYNTAX_ERROR=t("SyntaxError"),this.TYPE_ERROR=t("TypeError"),this.URI_ERROR=t("URIError")},Interpreter.prototype.initMath=function(r){var e=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(r,"Math",e,Interpreter.NONENUMERABLE_DESCRIPTOR);for(var t=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],n=0;n<t.length;n++)this.setProperty(e,t[n],Math[t[n]],Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);var i=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"];for(n=0;n<i.length;n++)this.setProperty(e,i[n],this.createNativeFunction(Math[i[n]],!1),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.initJSON=function(r){var e=this,t=e.createObjectProto(this.OBJECT_PROTO);this.setProperty(r,"JSON",t,Interpreter.NONENUMERABLE_DESCRIPTOR);var n=function(a){try{var o=JSON.parse(String(a))}catch(c){e.throwException(e.SYNTAX_ERROR,c.message)}return e.nativeToPseudo(o)};this.setProperty(t,"parse",this.createNativeFunction(n,!1)),this.setProperty(t,"stringify",this.createNativeFunction(n=function(a,o,c){o&&"Function"===o.class?e.throwException(e.TYPE_ERROR,"Function replacer on JSON.stringify not supported"):o=o&&"Array"===o.class?(o=e.arrayPseudoToNative(o)).filter(function(E){return"string"==typeof E||"number"==typeof E}):null,"string"!=typeof c&&"number"!=typeof c&&(c=void 0);var u=e.pseudoToNative(a);try{var h=JSON.stringify(u,o,c)}catch(E){e.throwException(e.TYPE_ERROR,E.message)}return h},!1))},Interpreter.prototype.isa=function(r,e){if(null==r||!e)return!1;var t=e.properties.prototype;if(r===t)return!0;for(r=this.getPrototype(r);r;){if(r===t)return!0;r=r.proto}return!1},Interpreter.prototype.populateRegExp=function(r,e){r.data=new RegExp(e.source,e.flags),this.setProperty(r,"lastIndex",e.lastIndex,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"source",e.source,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"global",e.global,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"ignoreCase",e.ignoreCase,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(r,"multiline",e.multiline,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.populateError=function(r,e){e&&this.setProperty(r,"message",String(e),Interpreter.NONENUMERABLE_DESCRIPTOR);for(var t=[],n=this.stateStack.length-1;n>=0;n--){var i=this.stateStack[n],a=i.node;if("CallExpression"===a.type){var o=i.func_;o&&t.length&&(t[t.length-1].datumName=this.getProperty(o,"name"))}a.loc&&(!t.length||"CallExpression"===a.type)&&t.push({datumLoc:a.loc})}var h=String(this.getProperty(r,"name"))+": "+String(this.getProperty(r,"message"))+"\n";for(n=0;n<t.length;n++){var E=t[n].datumLoc,b=t[n].datumName,S=E.source+":"+E.start.line+":"+E.start.column;h+=b?"  at "+b+" ("+S+")\n":"  at "+S+"\n"}this.setProperty(r,"stack",h.trim(),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.createWorker=function(){var r=this.createWorker.blob_;return r||(r=new Blob([Interpreter.WORKER_CODE.join("\n")],{type:"application/javascript"}),this.createWorker.blob_=r),new Worker(URL.createObjectURL(r))},Interpreter.prototype.vmCall=function(r,e,t,n){var i={timeout:this.REGEXP_THREAD_TIMEOUT};try{return Interpreter.vm.runInNewContext(r,e,i)}catch{n(null),this.throwException(this.ERROR,"RegExp Timeout: "+t)}return Interpreter.REGEXP_TIMEOUT},Interpreter.prototype.maybeThrowRegExp=function(r,e){var t;if(0===this.REGEXP_MODE)t=!1;else if(1===this.REGEXP_MODE)t=!0;else if(Interpreter.vm)t=!0;else if("function"==typeof Worker&&"function"==typeof URL)t=!0;else if("function"==typeof require){try{Interpreter.vm=require("vm")}catch{}t=!!Interpreter.vm}else t=!1;t||(e(null),this.throwException(this.ERROR,"Regular expressions not supported: "+r))},Interpreter.prototype.regExpTimeout=function(r,e,t){var n=this;return setTimeout(function(){e.terminate(),t(null);try{n.throwException(n.ERROR,"RegExp Timeout: "+r)}catch{}},this.REGEXP_THREAD_TIMEOUT)},Interpreter.prototype.createObject=function(r){return this.createObjectProto(r&&r.properties.prototype)},Interpreter.prototype.createObjectProto=function(r){if("object"!=typeof r)throw Error("Non object prototype");var e=new Interpreter.Object(r);return this.isa(e,this.ERROR)&&(e.class="Error"),e},Interpreter.prototype.createArray=function(){var r=this.createObjectProto(this.ARRAY_PROTO);return this.setProperty(r,"length",0,{configurable:!1,enumerable:!1,writable:!0}),r.class="Array",r},Interpreter.prototype.createFunctionBase_=function(r,e){var t=this.createObjectProto(this.FUNCTION_PROTO);if(e){var n=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(t,"prototype",n,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(n,"constructor",t,Interpreter.NONENUMERABLE_DESCRIPTOR)}else t.illegalConstructor=!0;return this.setProperty(t,"length",r,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),t.class="Function",t},Interpreter.prototype.createFunction=function(r,e,t){var n=this.createFunctionBase_(r.params.length,!0);n.parentScope=e,n.node=r;var i=r.id?String(r.id.name):t||"";return this.setProperty(n,"name",i,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),n},Interpreter.prototype.createNativeFunction=function(r,e){var t=this.createFunctionBase_(r.length,e);return t.nativeFunc=r,r.id=this.functionCounter_++,this.setProperty(t,"name",r.name,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),t},Interpreter.prototype.createAsyncFunction=function(r){var e=this.createFunctionBase_(r.length,!0);return e.asyncFunc=r,r.id=this.functionCounter_++,this.setProperty(e,"name",r.name,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),e},Interpreter.prototype.nativeToPseudo=function(r){if(r instanceof Interpreter.Object)throw Error("Object is already pseudo");if("object"!=typeof r&&"function"!=typeof r||null===r)return r;if(r instanceof RegExp){var e=this.createObjectProto(this.REGEXP_PROTO);return this.populateRegExp(e,r),e}if(r instanceof Date){var t=this.createObjectProto(this.DATE_PROTO);return t.data=new Date(r.valueOf()),t}if("function"==typeof r){var n=this,a=Object.getOwnPropertyDescriptor(r,"prototype");return this.createNativeFunction(function(){var E=Array.prototype.slice.call(arguments).map(function(S){return n.pseudoToNative(S)}),b=r.apply(n,E);return n.nativeToPseudo(b)},!!a)}if(Array.isArray(r)){for(var o=this.createArray(),c=0;c<r.length;c++)c in r&&this.setProperty(o,c,this.nativeToPseudo(r[c]));return o}var u=this.createObjectProto(this.OBJECT_PROTO);for(var h in r)this.setProperty(u,h,this.nativeToPseudo(r[h]));return u},Interpreter.prototype.pseudoToNative=function(r,e){if("object"!=typeof r&&"function"!=typeof r||null===r)return r;if(!(r instanceof Interpreter.Object))throw Error("Object is not pseudo");if(this.isa(r,this.REGEXP)){var t=new RegExp(r.data.source,r.data.flags);return t.lastIndex=r.data.lastIndex,t}if(this.isa(r,this.DATE))return new Date(r.data.valueOf());var a,n=e||{pseudo:[],native:[]},i=n.pseudo.indexOf(r);if(-1!==i)return n.native[i];if(n.pseudo.push(r),this.isa(r,this.ARRAY)){n.native.push(a=[]);for(var o=this.getProperty(r,"length"),c=0;c<o;c++)this.hasProperty(r,c)&&(a[c]=this.pseudoToNative(this.getProperty(r,c),n))}else{var u;for(var h in n.native.push(a={}),r.properties)u=this.pseudoToNative(r.properties[h],n),Object.defineProperty(a,h,{value:u,writable:!0,enumerable:!0,configurable:!0})}return n.pseudo.pop(),n.native.pop(),a},Interpreter.prototype.arrayNativeToPseudo=function(r){for(var e=this.createArray(),t=Object.getOwnPropertyNames(r),n=0;n<t.length;n++)this.setProperty(e,t[n],r[t[n]]);return e},Interpreter.prototype.arrayPseudoToNative=function(r){var e=[];for(var t in r.properties)e[t]=this.getProperty(r,t);return e.length=Interpreter.legalArrayLength(this.getProperty(r,"length"))||0,e},Interpreter.prototype.getPrototype=function(r){switch(typeof r){case"number":return this.NUMBER.properties.prototype;case"boolean":return this.BOOLEAN.properties.prototype;case"string":return this.STRING.properties.prototype}return r?r.proto:null},Interpreter.prototype.getProperty=function(r,e){if(this.getterStep_)throw Error("Getter not supported in that context");if(e=String(e),null==r&&this.throwException(this.TYPE_ERROR,"Cannot read property '"+e+"' of "+r),"object"==typeof r&&!(r instanceof Interpreter.Object))throw TypeError("Expecting native value or pseudo object");if("length"===e){if(this.isa(r,this.STRING))return String(r).length}else if(e.charCodeAt(0)<64&&this.isa(r,this.STRING)){var t=Interpreter.legalArrayIndex(e);if(!isNaN(t)&&t<String(r).length)return String(r)[t]}do{if(r.properties&&e in r.properties){var n=r.getter[e];return n?(this.getterStep_=!0,n):r.properties[e]}}while(r=this.getPrototype(r))},Interpreter.prototype.hasProperty=function(r,e){if(!(r instanceof Interpreter.Object))throw TypeError("Primitive data type has no properties");if("length"===(e=String(e))&&this.isa(r,this.STRING))return!0;if(this.isa(r,this.STRING)){var t=Interpreter.legalArrayIndex(e);if(!isNaN(t)&&t<String(r).length)return!0}do{if(r.properties&&e in r.properties)return!0}while(r=this.getPrototype(r));return!1},Interpreter.prototype.setProperty=function(r,e,t,n){if(this.setterStep_)throw Error("Setter not supported in that context");if(e=String(e),null==r&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+e+"' of "+r),"object"==typeof r&&!(r instanceof Interpreter.Object))throw TypeError("Expecting native value or pseudo object");n&&("get"in n||"set"in n)&&("value"in n||"writable"in n)&&this.throwException(this.TYPE_ERROR,"Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");var i=!this.stateStack||this.getScope().strict;if(r instanceof Interpreter.Object){if(this.isa(r,this.STRING)){var a=Interpreter.legalArrayIndex(e);if("length"===e||!isNaN(a)&&a<String(r).length)return void(i&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+e+"' of String '"+r.data+"'"))}if("Array"===r.class){var c,o=r.properties.length;if("length"===e){if(n){if(!("value"in n))return;t=n.value}if(t=Interpreter.legalArrayLength(t),isNaN(t)&&this.throwException(this.RANGE_ERROR,"Invalid array length"),t<o)for(c in r.properties)c=Interpreter.legalArrayIndex(c),!isNaN(c)&&t<=c&&delete r.properties[c]}else isNaN(c=Interpreter.legalArrayIndex(e))||(r.properties.length=Math.max(o,c+1))}if(!r.preventExtensions||e in r.properties)if(n){var u={};"get"in n&&n.get&&(r.getter[e]=n.get,u.get=this.setProperty.placeholderGet_),"set"in n&&n.set&&(r.setter[e]=n.set,u.set=this.setProperty.placeholderSet_),"configurable"in n&&(u.configurable=n.configurable),"enumerable"in n&&(u.enumerable=n.enumerable),"writable"in n&&(u.writable=n.writable,delete r.getter[e],delete r.setter[e]),"value"in n?(u.value=n.value,delete r.getter[e],delete r.setter[e]):t!==Interpreter.VALUE_IN_DESCRIPTOR&&(u.value=t,delete r.getter[e],delete r.setter[e]);try{Object.defineProperty(r.properties,e,u)}catch{this.throwException(this.TYPE_ERROR,"Cannot redefine property: "+e)}"get"in n&&!n.get&&delete r.getter[e],"set"in n&&!n.set&&delete r.setter[e]}else{if(t===Interpreter.VALUE_IN_DESCRIPTOR)throw ReferenceError("Value not specified");for(var h=r;!(e in h.properties);)if(!(h=this.getPrototype(h))){h=r;break}if(h.setter&&h.setter[e])return this.setterStep_=!0,h.setter[e];if(h.getter&&h.getter[e])i&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+e+"' of object '"+r+"' which only has a getter");else try{r.properties[e]=t}catch{i&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+e+"' of object '"+r+"'")}}else i&&this.throwException(this.TYPE_ERROR,"Can't add property '"+e+"', object is not extensible")}else i&&this.throwException(this.TYPE_ERROR,"Can't create property '"+e+"' on '"+r+"'")},Interpreter.prototype.setProperty.placeholderGet_=function(){throw Error("Placeholder getter")},Interpreter.prototype.setProperty.placeholderSet_=function(){throw Error("Placeholder setter")},Interpreter.prototype.setNativeFunctionPrototype=function(r,e,t){this.setProperty(r.properties.prototype,e,this.createNativeFunction(t,!1),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.setAsyncFunctionPrototype=function(r,e,t){this.setProperty(r.properties.prototype,e,this.createAsyncFunction(t),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.getScope=function(){var r=this.stateStack[this.stateStack.length-1].scope;if(!r)throw Error("No scope found");return r},Interpreter.prototype.createScope=function(r,e){var t=!1;if(e&&e.strict)t=!0;else{var n=r.body&&r.body[0];n&&n.expression&&"Literal"===n.expression.type&&"use strict"===n.expression.value&&(t=!0)}var i=this.createObjectProto(null),a=new Interpreter.Scope(e,t,i);return e||this.initGlobal(a.object),this.populateScope_(r,a),a},Interpreter.prototype.createSpecialScope=function(r,e){if(!r)throw Error("parentScope required");var t=e||this.createObjectProto(null);return new Interpreter.Scope(r,r.strict,t)},Interpreter.prototype.getValueFromScope=function(r){for(var e=this.getScope();e&&e!==this.globalScope;){if(r in e.object.properties)return e.object.properties[r];e=e.parentScope}if(e===this.globalScope&&this.hasProperty(e.object,r))return this.getProperty(e.object,r);var t=this.stateStack[this.stateStack.length-1].node;"UnaryExpression"===t.type&&"typeof"===t.operator||this.throwException(this.REFERENCE_ERROR,r+" is not defined")},Interpreter.prototype.setValueToScope=function(r,e){for(var t=this.getScope(),n=t.strict;t&&t!==this.globalScope;){if(r in t.object.properties)return void(t.object.properties[r]=e);t=t.parentScope}if(t===this.globalScope&&(!n||this.hasProperty(t.object,r)))return this.setProperty(t.object,r,e);this.throwException(this.REFERENCE_ERROR,r+" is not defined")},Interpreter.prototype.populateScope_=function(r,e){var t;if(r.variableCache_)t=r.variableCache_;else{switch(t=Object.create(null),r.type){case"VariableDeclaration":for(var n=0;n<r.declarations.length;n++)t[r.declarations[n].id.name]=!0;break;case"FunctionDeclaration":t[r.id.name]=r;break;case"BlockStatement":case"CatchClause":case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"Program":case"SwitchCase":case"SwitchStatement":case"TryStatement":case"WithStatement":case"WhileStatement":var i=r.constructor;for(var a in r)if("loc"!==a){var c,o=r[a];if(o&&"object"==typeof o)if(Array.isArray(o)){for(n=0;n<o.length;n++)if(o[n]&&o[n].constructor===i)for(var a in c=this.populateScope_(o[n],e))t[a]=c[a]}else if(o.constructor===i)for(var a in c=this.populateScope_(o,e))t[a]=c[a]}}r.variableCache_=t}for(var a in t)this.setProperty(e.object,a,!0===t[a]?void 0:this.createFunction(t[a],e),Interpreter.VARIABLE_DESCRIPTOR);return t},Interpreter.prototype.calledWithNew=function(){return this.stateStack[this.stateStack.length-1].isConstructor},Interpreter.prototype.getValue=function(r){return r[0]===Interpreter.SCOPE_REFERENCE?this.getValueFromScope(r[1]):this.getProperty(r[0],r[1])},Interpreter.prototype.setValue=function(r,e){return r[0]===Interpreter.SCOPE_REFERENCE?this.setValueToScope(r[1],e):this.setProperty(r[0],r[1],e)},Interpreter.prototype.throwException=function(r,e){if(!this.globalScope)throw void 0===e?r:e;if(void 0===e)var t=r;else t=this.createObject(r),this.populateError(t,e);throw this.unwind(Interpreter.Completion.THROW,t,void 0),Interpreter.STEP_ERROR},Interpreter.prototype.unwind=function(r,e,t){if(r===Interpreter.Completion.NORMAL)throw TypeError("Should not unwind for NORMAL completions");e:for(var n=this.stateStack;n.length>0;n.pop()){var i=n[n.length-1];switch(i.node.type){case"TryStatement":return void(i.cv={type:r,value:e,label:t});case"CallExpression":case"NewExpression":if(r===Interpreter.Completion.RETURN)return void(i.value=e);if(r!==Interpreter.Completion.THROW)throw Error("Unsynatctic break/continue not rejected by Acorn");break;case"Program":i.done=!0;break e}if(r===Interpreter.Completion.BREAK){if(t?i.labels&&-1!==i.labels.indexOf(t):i.isLoop||i.isSwitch)return void n.pop()}else if(r===Interpreter.Completion.CONTINUE&&(t?i.labels&&-1!==i.labels.indexOf(t):i.isLoop))return}var a;if(this.isa(e,this.ERROR)){var o={EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},c=String(this.getProperty(e,"name")),u=this.getProperty(e,"message").valueOf();(a=(o[c]||Error)(u)).stack=String(this.getProperty(e,"stack"))}else a=String(e);throw this.value=a,a},Interpreter.prototype.createGetter_=function(r,e){if(!this.getterStep_)throw Error("Unexpected call to createGetter");this.getterStep_=!1;var t=Array.isArray(e)?e[0]:e,n=new this.newNode;n.type="CallExpression";var i=new Interpreter.State(n,this.stateStack[this.stateStack.length-1].scope);return i.doneCallee_=2,i.funcThis_=t,i.func_=r,i.doneArgs_=!0,i.arguments_=[],i},Interpreter.prototype.createSetter_=function(r,e,t){if(!this.setterStep_)throw Error("Unexpected call to createSetter");this.setterStep_=!1;var n=Array.isArray(e)?e[0]:this.globalObject,i=new this.newNode;i.type="CallExpression";var a=new Interpreter.State(i,this.stateStack[this.stateStack.length-1].scope);return a.doneCallee_=2,a.funcThis_=n,a.func_=r,a.doneArgs_=!0,a.arguments_=[t],a},Interpreter.prototype.boxThis_=function(r){if(null==r)return this.globalObject;if(!(r instanceof Interpreter.Object)){var e=this.createObjectProto(this.getPrototype(r));return e.data=r,e}return r},Interpreter.prototype.getGlobalScope=function(){return this.globalScope},Interpreter.prototype.getStateStack=function(){return this.stateStack},Interpreter.prototype.setStateStack=function(r){this.stateStack=r},Interpreter.State=function(r,e){this.node=r,this.scope=e},Interpreter.Scope=function(r,e,t){this.parentScope=r,this.strict=e,this.object=t},Interpreter.Object=function(r){this.getter=Object.create(null),this.setter=Object.create(null),this.properties=Object.create(null),this.proto=r},Interpreter.Object.prototype.proto=null,Interpreter.Object.prototype.class="Object",Interpreter.Object.prototype.data=null,Interpreter.Object.prototype.toString=function(){if(!Interpreter.currentInterpreter_)return"[object Interpreter.Object]";if(!(this instanceof Interpreter.Object))return String(this);if("Array"===this.class){(r=Interpreter.toStringCycles_).push(this);try{var e=[],t=this.properties.length,n=!1;t>1024&&(t=1e3,n=!0);for(var i=0;i<t;i++){var a=this.properties[i];e[i]=a instanceof Interpreter.Object&&-1!==r.indexOf(a)?"...":a}n&&e.push("...")}finally{r.pop()}return e.join(",")}if("Error"===this.class){var r;if(-1!==(r=Interpreter.toStringCycles_).indexOf(this))return"[object Error]";var o,c,u=this;do{if("name"in u.properties){o=u.properties.name;break}}while(u=u.proto);u=this;do{if("message"in u.properties){c=u.properties.message;break}}while(u=u.proto);r.push(this);try{o=o&&String(o),c=c&&String(c)}finally{r.pop()}return c?o+": "+c:String(o)}return null!==this.data?String(this.data):"[object "+this.class+"]"},Interpreter.Object.prototype.valueOf=function(){return Interpreter.currentInterpreter_?null==this.data||this.data instanceof RegExp?this:this.data instanceof Date?this.data.valueOf():this.data:this},Interpreter.prototype.stepArrayExpression=function(r,e,t){var n=t.elements,i=e.n_||0;for(e.array_?(this.setProperty(e.array_,i,e.value),i++):(e.array_=this.createArray(),e.array_.properties.length=n.length);i<n.length;){if(n[i])return e.n_=i,new Interpreter.State(n[i],e.scope);i++}r.pop(),r[r.length-1].value=e.array_},Interpreter.prototype.stepAssignmentExpression=function(r,e,t){if(!e.doneLeft_){e.doneLeft_=!0;var n=new Interpreter.State(t.left,e.scope);return n.components=!0,n}if(!e.doneRight_){if(e.leftReference_||(e.leftReference_=e.value),e.doneGetter_&&(e.leftValue_=e.value),!e.doneGetter_&&"="!==t.operator){var i=this.getValue(e.leftReference_);if(e.leftValue_=i,this.getterStep_)return e.doneGetter_=!0,this.createGetter_(i,e.leftReference_)}return e.doneRight_=!0,"="===t.operator&&"Identifier"===t.left.type&&(e.destinationName=t.left.name),new Interpreter.State(t.right,e.scope)}if(e.doneSetter_)return r.pop(),void(r[r.length-1].value=e.setterValue_);var o=e.leftValue_,c=e.value;switch(t.operator){case"=":o=c;break;case"+=":o+=c;break;case"-=":o-=c;break;case"*=":o*=c;break;case"/=":o/=c;break;case"%=":o%=c;break;case"<<=":o<<=c;break;case">>=":o>>=c;break;case">>>=":o>>>=c;break;case"&=":o&=c;break;case"^=":o^=c;break;case"|=":o|=c;break;default:throw SyntaxError("Unknown assignment expression: "+t.operator)}var u=this.setValue(e.leftReference_,o);if(u)return e.doneSetter_=!0,e.setterValue_=o,this.createSetter_(u,e.leftReference_,o);r.pop(),r[r.length-1].value=o},Interpreter.prototype.stepBinaryExpression=function(r,e,t){if(!e.doneLeft_)return e.doneLeft_=!0,new Interpreter.State(t.left,e.scope);if(!e.doneRight_)return e.doneRight_=!0,e.leftValue_=e.value,new Interpreter.State(t.right,e.scope);r.pop();var a,n=e.leftValue_,i=e.value;switch(t.operator){case"==":a=n==i;break;case"!=":a=n!=i;break;case"===":a=n===i;break;case"!==":a=n!==i;break;case">":a=n>i;break;case">=":a=n>=i;break;case"<":a=n<i;break;case"<=":a=n<=i;break;case"+":a=n+i;break;case"-":a=n-i;break;case"*":a=n*i;break;case"/":a=n/i;break;case"%":a=n%i;break;case"&":a=n&i;break;case"|":a=n|i;break;case"^":a=n^i;break;case"<<":a=n<<i;break;case">>":a=n>>i;break;case">>>":a=n>>>i;break;case"in":i instanceof Interpreter.Object||this.throwException(this.TYPE_ERROR,"'in' expects an object, not '"+i+"'"),a=this.hasProperty(i,n);break;case"instanceof":this.isa(i,this.FUNCTION)||this.throwException(this.TYPE_ERROR,"Right-hand side of instanceof is not an object"),a=n instanceof Interpreter.Object&&this.isa(n,i);break;default:throw SyntaxError("Unknown binary operator: "+t.operator)}r[r.length-1].value=a},Interpreter.prototype.stepBlockStatement=function(r,e,t){var n=e.n_||0,i=t.body[n];if(i)return e.n_=n+1,new Interpreter.State(i,e.scope);r.pop()},Interpreter.prototype.stepBreakStatement=function(r,e,t){this.unwind(Interpreter.Completion.BREAK,void 0,t.label&&t.label.name)},Interpreter.prototype.evalCodeNumber_=0,Interpreter.prototype.stepCallExpression=function(r,e,t){if(!e.doneCallee_){e.doneCallee_=1;var n=new Interpreter.State(t.callee,e.scope);return n.components=!0,n}if(1===e.doneCallee_){e.doneCallee_=2;var i=e.value;if(Array.isArray(i)){if(e.func_=this.getValue(i),i[0]===Interpreter.SCOPE_REFERENCE?e.directEval_="eval"===i[1]:e.funcThis_=i[0],i=e.func_,this.getterStep_)return e.doneCallee_=1,this.createGetter_(i,e.value)}else e.func_=i;e.arguments_=[],e.n_=0}if(i=e.func_,!e.doneArgs_){if(0!==e.n_&&e.arguments_.push(e.value),t.arguments[e.n_])return new Interpreter.State(t.arguments[e.n_++],e.scope);if("NewExpression"===t.type){if((!(i instanceof Interpreter.Object)||i.illegalConstructor)&&this.throwException(this.TYPE_ERROR,i+" is not a constructor"),i===this.ARRAY)e.funcThis_=this.createArray();else{var a=i.properties.prototype;("object"!=typeof a||null===a)&&(a=this.OBJECT_PROTO),e.funcThis_=this.createObjectProto(a)}e.isConstructor=!0}e.doneArgs_=!0}if(e.doneExec_)r.pop(),r[r.length-1].value=e.isConstructor&&"object"!=typeof e.value?e.funcThis_:e.value;else{e.doneExec_=!0,i instanceof Interpreter.Object||this.throwException(this.TYPE_ERROR,i+" is not a function");var o=i.node;if(o){for(var c=this.createScope(o.body,i.parentScope),u=0;u<o.params.length;u++)this.setProperty(c.object,o.params[u].name,e.arguments_.length>u?e.arguments_[u]:void 0);var b=this.createArray();for(u=0;u<e.arguments_.length;u++)this.setProperty(b,u,e.arguments_[u]);this.setProperty(c.object,"arguments",b);var S=o.id&&o.id.name;return S&&this.setProperty(c.object,S,i),c.strict||(e.funcThis_=this.boxThis_(e.funcThis_)),this.setProperty(c.object,"this",e.funcThis_,Interpreter.READONLY_DESCRIPTOR),e.value=void 0,new Interpreter.State(o.body,c)}if(i.eval){var d=e.arguments_[0];if("string"==typeof d){try{var v=this.parse_(String(d),"eval"+this.evalCodeNumber_++)}catch(F){this.throwException(this.SYNTAX_ERROR,"Invalid code: "+F.message)}var m=new this.newNode;return m.type="EvalProgram_",m.body=v.body,Interpreter.stripLocations_(m,t.start,t.end),(c=e.directEval_?e.scope:this.globalScope).strict?c=this.createScope(v,c):this.populateScope_(v,c),this.value=void 0,new Interpreter.State(m,c)}e.value=d}else if(i.nativeFunc)e.scope.strict||(e.funcThis_=this.boxThis_(e.funcThis_)),e.value=i.nativeFunc.apply(e.funcThis_,e.arguments_);else{if(i.asyncFunc){var k=this,G=i.asyncFunc.length-1,D=e.arguments_.concat(new Array(G)).slice(0,G);return D.push(function(Y){e.value=Y,k.paused_=!1}),this.paused_=!0,e.scope.strict||(e.funcThis_=this.boxThis_(e.funcThis_)),void i.asyncFunc.apply(e.funcThis_,D)}this.throwException(this.TYPE_ERROR,i.class+" is not callable")}}},Interpreter.prototype.stepConditionalExpression=function(r,e,t){var n=e.mode_||0;if(0===n)return e.mode_=1,new Interpreter.State(t.test,e.scope);if(1===n){e.mode_=2;var i=Boolean(e.value);if(i&&t.consequent)return new Interpreter.State(t.consequent,e.scope);if(!i&&t.alternate)return new Interpreter.State(t.alternate,e.scope);this.value=void 0}r.pop(),"ConditionalExpression"===t.type&&(r[r.length-1].value=e.value)},Interpreter.prototype.stepContinueStatement=function(r,e,t){this.unwind(Interpreter.Completion.CONTINUE,void 0,t.label&&t.label.name)},Interpreter.prototype.stepDebuggerStatement=function(r,e,t){r.pop()},Interpreter.prototype.stepDoWhileStatement=function(r,e,t){if("DoWhileStatement"===t.type&&void 0===e.test_&&(e.value=!0,e.test_=!0),!e.test_)return e.test_=!0,new Interpreter.State(t.test,e.scope);if(e.value){if(t.body)return e.test_=!1,e.isLoop=!0,new Interpreter.State(t.body,e.scope)}else r.pop()},Interpreter.prototype.stepEmptyStatement=function(r,e,t){r.pop()},Interpreter.prototype.stepEvalProgram_=function(r,e,t){var n=e.n_||0,i=t.body[n];if(i)return e.n_=n+1,new Interpreter.State(i,e.scope);r.pop(),r[r.length-1].value=this.value},Interpreter.prototype.stepExpressionStatement=function(r,e,t){if(!e.done_)return this.value=void 0,e.done_=!0,new Interpreter.State(t.expression,e.scope);r.pop(),this.value=e.value},Interpreter.prototype.stepForInStatement=function(r,e,t){if(!e.doneInit_&&(e.doneInit_=!0,t.left.declarations&&t.left.declarations[0].init))return e.scope.strict&&this.throwException(this.SYNTAX_ERROR,"for-in loop variable declaration may not have an initializer."),new Interpreter.State(t.left,e.scope);if(!e.doneObject_)return e.doneObject_=!0,e.variable_||(e.variable_=e.value),new Interpreter.State(t.right,e.scope);if(e.isLoop||(e.isLoop=!0,e.object_=e.value,e.visited_=Object.create(null)),void 0===e.name_)e:for(;;){if(e.object_ instanceof Interpreter.Object){for(e.props_||(e.props_=Object.getOwnPropertyNames(e.object_.properties));void 0!==(n=e.props_.shift());)if(Object.prototype.hasOwnProperty.call(e.object_.properties,n)&&!e.visited_[n]&&(e.visited_[n]=!0,Object.prototype.propertyIsEnumerable.call(e.object_.properties,n))){e.name_=n;break e}}else if(null!=e.object_)for(e.props_||(e.props_=Object.getOwnPropertyNames(e.object_));;){var n;if(void 0===(n=e.props_.shift()))break;if(e.visited_[n]=!0,Object.prototype.propertyIsEnumerable.call(e.object_,n)){e.name_=n;break e}}if(e.object_=this.getPrototype(e.object_),e.props_=null,null===e.object_)return void r.pop()}if(!e.doneVariable_){e.doneVariable_=!0;var i=t.left;if("VariableDeclaration"!==i.type){e.variable_=null;var a=new Interpreter.State(i,e.scope);return a.components=!0,a}e.variable_=[Interpreter.SCOPE_REFERENCE,i.declarations[0].id.name]}if(e.variable_||(e.variable_=e.value),!e.doneSetter_){e.doneSetter_=!0;var o=e.name_,c=this.setValue(e.variable_,o);if(c)return this.createSetter_(c,e.variable_,o)}return e.name_=void 0,e.doneVariable_=!1,e.doneSetter_=!1,t.body?new Interpreter.State(t.body,e.scope):void 0},Interpreter.prototype.stepForStatement=function(r,e,t){switch(e.mode_){default:if(e.mode_=1,t.init)return new Interpreter.State(t.init,e.scope);break;case 1:if(e.mode_=2,t.test)return new Interpreter.State(t.test,e.scope);break;case 2:if(e.mode_=3,!t.test||e.value)return e.isLoop=!0,new Interpreter.State(t.body,e.scope);r.pop();break;case 3:if(e.mode_=1,t.update)return new Interpreter.State(t.update,e.scope)}},Interpreter.prototype.stepFunctionDeclaration=function(r,e,t){r.pop()},Interpreter.prototype.stepFunctionExpression=function(r,e,t){r.pop(),(e=r[r.length-1]).value=this.createFunction(t,e.scope,e.destinationName)},Interpreter.prototype.stepIdentifier=function(r,e,t){if(r.pop(),e.components)r[r.length-1].value=[Interpreter.SCOPE_REFERENCE,t.name];else{var n=this.getValueFromScope(t.name);if(this.getterStep_)return this.createGetter_(n,this.globalObject);r[r.length-1].value=n}},Interpreter.prototype.stepIfStatement=Interpreter.prototype.stepConditionalExpression,Interpreter.prototype.stepLabeledStatement=function(r,e,t){r.pop();var n=e.labels||[];n.push(t.label.name);var i=new Interpreter.State(t.body,e.scope);return i.labels=n,i},Interpreter.prototype.stepLiteral=function(r,e,t){r.pop();var n=t.value;if(n instanceof RegExp){var i=this.createObjectProto(this.REGEXP_PROTO);this.populateRegExp(i,n),n=i}r[r.length-1].value=n},Interpreter.prototype.stepLogicalExpression=function(r,e,t){if("&&"!==t.operator&&"||"!==t.operator)throw SyntaxError("Unknown logical operator: "+t.operator);if(!e.doneLeft_)return e.doneLeft_=!0,new Interpreter.State(t.left,e.scope);if(e.doneRight_)r.pop(),r[r.length-1].value=e.value;else{if(!("&&"===t.operator&&!e.value||"||"===t.operator&&e.value))return e.doneRight_=!0,new Interpreter.State(t.right,e.scope);r.pop(),r[r.length-1].value=e.value}},Interpreter.prototype.stepMemberExpression=function(r,e,t){if(!e.doneObject_)return e.doneObject_=!0,new Interpreter.State(t.object,e.scope);var n;if(t.computed){if(!e.doneProperty_)return e.object_=e.value,e.doneProperty_=!0,new Interpreter.State(t.property,e.scope);n=e.value}else e.object_=e.value,n=t.property.name;if(r.pop(),e.components)r[r.length-1].value=[e.object_,n];else{var i=this.getProperty(e.object_,n);if(this.getterStep_)return this.createGetter_(i,e.object_);r[r.length-1].value=i}},Interpreter.prototype.stepNewExpression=Interpreter.prototype.stepCallExpression,Interpreter.prototype.stepObjectExpression=function(r,e,t){var n=e.n_||0,i=t.properties[n];if(e.object_?(e.properties_[a=e.destinationName]||(e.properties_[a]={}),e.properties_[a][i.kind]=e.value,e.n_=++n,i=t.properties[n]):(e.object_=this.createObjectProto(this.OBJECT_PROTO),e.properties_=Object.create(null)),i){if("Identifier"===(o=i.key).type)var a=o.name;else{if("Literal"!==o.type)throw SyntaxError("Unknown object structure: "+o.type);a=o.value}return e.destinationName=a,new Interpreter.State(i.value,e.scope)}for(var o in e.properties_){var c=e.properties_[o];"get"in c||"set"in c?this.setProperty(e.object_,o,Interpreter.VALUE_IN_DESCRIPTOR,{configurable:!0,enumerable:!0,get:c.get,set:c.set}):this.setProperty(e.object_,o,c.init)}r.pop(),r[r.length-1].value=e.object_},Interpreter.prototype.stepProgram=function(r,e,t){var n=t.body.shift();if(n)return e.done=!1,new Interpreter.State(n,e.scope);e.done=!0},Interpreter.prototype.stepReturnStatement=function(r,e,t){if(t.argument&&!e.done_)return e.done_=!0,new Interpreter.State(t.argument,e.scope);this.unwind(Interpreter.Completion.RETURN,e.value,void 0)},Interpreter.prototype.stepSequenceExpression=function(r,e,t){var n=e.n_||0,i=t.expressions[n];if(i)return e.n_=n+1,new Interpreter.State(i,e.scope);r.pop(),r[r.length-1].value=e.value},Interpreter.prototype.stepSwitchStatement=function(r,e,t){if(!e.test_)return e.test_=1,new Interpreter.State(t.discriminant,e.scope);for(1===e.test_&&(e.test_=2,e.switchValue_=e.value,e.defaultCase_=-1);;){var n=e.index_||0,i=t.cases[n];if(e.matched_||!i||i.test)if(i||e.matched_||-1===e.defaultCase_){if(!i)return void r.pop();if(!e.matched_&&!e.tested_&&i.test)return e.tested_=!0,new Interpreter.State(i.test,e.scope);if(e.matched_||e.value===e.switchValue_){e.matched_=!0;var a=e.n_||0;if(i.consequent[a])return e.isSwitch=!0,e.n_=a+1,new Interpreter.State(i.consequent[a],e.scope)}e.tested_=!1,e.n_=0,e.index_=n+1}else e.matched_=!0,e.index_=e.defaultCase_;else e.defaultCase_=n,e.index_=n+1}},Interpreter.prototype.stepThisExpression=function(r,e,t){r.pop(),r[r.length-1].value=this.getValueFromScope("this")},Interpreter.prototype.stepThrowStatement=function(r,e,t){if(!e.done_)return e.done_=!0,new Interpreter.State(t.argument,e.scope);this.throwException(e.value)},Interpreter.prototype.stepTryStatement=function(r,e,t){if(!e.doneBlock_)return e.doneBlock_=!0,new Interpreter.State(t.block,e.scope);if(e.cv&&e.cv.type===Interpreter.Completion.THROW&&!e.doneHandler_&&t.handler){e.doneHandler_=!0;var n=this.createSpecialScope(e.scope);return this.setProperty(n.object,t.handler.param.name,e.cv.value),e.cv=void 0,new Interpreter.State(t.handler.body,n)}if(!e.doneFinalizer_&&t.finalizer)return e.doneFinalizer_=!0,new Interpreter.State(t.finalizer,e.scope);r.pop(),e.cv&&this.unwind(e.cv.type,e.cv.value,e.cv.label)},Interpreter.prototype.stepUnaryExpression=function(r,e,t){if(!e.done_){e.done_=!0;var n=new Interpreter.State(t.argument,e.scope);return n.components="delete"===t.operator,n}r.pop();var i=e.value;switch(t.operator){case"-":i=-i;break;case"+":i=+i;break;case"!":i=!i;break;case"~":i=~i;break;case"delete":var a=!0;if(Array.isArray(i)){var o=i[0];o===Interpreter.SCOPE_REFERENCE&&(o=e.scope);var c=String(i[1]);try{delete o.properties[c]}catch{e.scope.strict?this.throwException(this.TYPE_ERROR,"Cannot delete property '"+c+"' of '"+o+"'"):a=!1}}i=a;break;case"typeof":i=i&&"Function"===i.class?"function":typeof i;break;case"void":i=void 0;break;default:throw SyntaxError("Unknown unary operator: "+t.operator)}r[r.length-1].value=i},Interpreter.prototype.stepUpdateExpression=function(r,e,t){if(!e.doneLeft_){e.doneLeft_=!0;var n=new Interpreter.State(t.argument,e.scope);return n.components=!0,n}if(e.leftSide_||(e.leftSide_=e.value),e.doneGetter_&&(e.leftValue_=e.value),!e.doneGetter_){var a=this.getValue(e.leftSide_);if(e.leftValue_=a,this.getterStep_)return e.doneGetter_=!0,this.createGetter_(a,e.leftSide_)}if(e.doneSetter_)return r.pop(),void(r[r.length-1].value=e.setterValue_);var o;if(a=Number(e.leftValue_),"++"===t.operator)o=a+1;else{if("--"!==t.operator)throw SyntaxError("Unknown update expression: "+t.operator);o=a-1}var c=t.prefix?o:a,u=this.setValue(e.leftSide_,o);if(u)return e.doneSetter_=!0,e.setterValue_=c,this.createSetter_(u,e.leftSide_,o);r.pop(),r[r.length-1].value=c},Interpreter.prototype.stepVariableDeclaration=function(r,e,t){var n=t.declarations,i=e.n_||0,a=n[i];for(e.init_&&a&&(this.setValueToScope(a.id.name,e.value),e.init_=!1,a=n[++i]);a;){if(a.init)return e.n_=i,e.init_=!0,e.destinationName=a.id.name,new Interpreter.State(a.init,e.scope);a=n[++i]}r.pop()},Interpreter.prototype.stepWithStatement=function(r,e,t){if(!e.doneObject_)return e.doneObject_=!0,new Interpreter.State(t.object,e.scope);r.pop();var n=this.createSpecialScope(e.scope,e.value);return new Interpreter.State(t.body,n)},Interpreter.prototype.stepWhileStatement=Interpreter.prototype.stepDoWhileStatement,Interpreter.nativeGlobal.Interpreter=Interpreter,Interpreter.prototype.step=Interpreter.prototype.step,Interpreter.prototype.run=Interpreter.prototype.run,Interpreter.prototype.appendCode=Interpreter.prototype.appendCode,Interpreter.prototype.createObject=Interpreter.prototype.createObject,Interpreter.prototype.createObjectProto=Interpreter.prototype.createObjectProto,Interpreter.prototype.createAsyncFunction=Interpreter.prototype.createAsyncFunction,Interpreter.prototype.createNativeFunction=Interpreter.prototype.createNativeFunction,Interpreter.prototype.getProperty=Interpreter.prototype.getProperty,Interpreter.prototype.setProperty=Interpreter.prototype.setProperty,Interpreter.prototype.nativeToPseudo=Interpreter.prototype.nativeToPseudo,Interpreter.prototype.pseudoToNative=Interpreter.prototype.pseudoToNative,Interpreter.prototype.getGlobalScope=Interpreter.prototype.getGlobalScope,Interpreter.prototype.getStateStack=Interpreter.prototype.getStateStack,Interpreter.prototype.setStateStack=Interpreter.prototype.setStateStack,Interpreter.VALUE_IN_DESCRIPTOR=Interpreter.VALUE_IN_DESCRIPTOR;class UniqueQueue{_queue;_inQueue;constructor(){this._queue=[],this._inQueue={}}get length(){return this._queue.length}enqueue(e){this._inQueue[e]||(this._queue.push(e),this._inQueue[e]=!0)}dequeue(){const e=this._queue.shift();return delete this._inQueue[e],e}remove(e){this._inQueue[e]&&(delete this._inQueue[e],this._queue=this._queue.filter(t=>t!==e))}}class DependencyStore{_dependencies;_triggers;constructor(){this._dependencies={},this._triggers={}}add(e,t){this._dependencies[e]||(this._dependencies[e]={}),this._dependencies[e][t]=!0,this._triggers[t]||(this._triggers[t]={}),this._triggers[t][e]=!0}reset(e){const t=this._dependencies[e];if(t)for(let n in t)this._triggers[n]&&delete this._triggers[n][e];this._dependencies[e]={}}triggers(e){return Object.keys(this._triggers[e]||{})}dependencies(e){return Object.keys(this._dependencies[e]||{})}}class CalculationEngine{static _getPath(e,t,n){return n?(e||"")+"["+t+"]":(e&&e.length>0?e+".":"")+t}static flattenObject(e){return function t(n,i){const a=Array.isArray(n);return Object.keys(n).reduce(function(o,c){const u=CalculationEngine._getPath(i,c,a),h=n[c];return h&&"object"==typeof h?Object.assign(o,t(h,u)):o[u]=h,o},{})}(e)}static unflattenObject(e){const t={};return Object.keys(e).forEach(function(n){const i=e[n],a=n.split(".").flatMap(h=>h.split("[").map((E,b)=>0===b?E:(E=parseInt(E),isNaN(E)?null:E)).filter(function(E){return null!==E}).map(function(E,b,S){return{prop:E,isArray:b!==S.length-1}}));let o=t,c=t,u=null;for(let h of a)null!==u&&(o[u]=c,o=c),u=h.prop,c=o[u]?o[u]:h.isArray?[]:{};o[u]=i}),t}_currentPath;_dependencyStore;_expressions;_state;_listenerState;_changeCallbacks;_expressionQueue;_running;constructor(){this._dependencyStore=new DependencyStore,this._changeCallbacks=[],this._expressionQueue=new UniqueQueue,this._state={},this._listenerState={},this._expressions={}}registerChangeCallback(e){this._changeCallbacks.push(e)}registerValue(e,t){this.setValue(e,t)}registerExpression(e,t){this._expressions[e]={expression:t,isListener:!1},this.setValue(e,null),this._expressionQueue.enqueue(e)}registerListenerExpression(e,t){this._expressions[e]={expression:t,isListener:!0},this.setListenerValue(e,null),this._expressionQueue.enqueue(e)}deregisterValue(e){delete this._state[e],this._triggerDependents(e)}deregisterExpression(e){delete this._expressions[e],delete this._state[e],this._expressionQueue.remove(e),this._triggerDependents(e)}deregisterListenerExpression(e){delete this._expressions[e],delete this._listenerState[e],this._expressionQueue.remove(e)}start(){setTimeout(this._run.bind(this),0)}getTriggers(e){return this._dependencyStore.triggers(e)}getDependencies(e){return this._dependencyStore.dependencies(e)}getValue(e){return this._state[e]}setValue(e,t){this._state[e]=t;for(let n of this._changeCallbacks)n(e,t);this._triggerDependents(e)}getListenerValue(e){return this._listenerState[e]}setListenerValue(e,t){this._listenerState[e]=t;for(let n of this._changeCallbacks)n(e,t)}_registerDependency(e){this._currentPath&&this._dependencyStore.add(this._currentPath,e)}_triggerDependents(e){const t=this.getTriggers(e);for(let n of t)this._expressionQueue.enqueue(n);this._run()}_startTracking(e){this._currentPath=e,this._dependencyStore.reset(e)}_stopTracking(){this._currentPath=null}_executeCalculation(e,t,n){const i=this;let a=!1,o=i.getValue(e);const c=new Interpreter(t,(E,b)=>{const S=(m,k)=>function(){return this._registerDependency(m),k}.bind(i),d=m=>function(){return this._registerDependency(m),this.getValue(m)}.bind(i),v=(m,k)=>{const U=Array.isArray(m),G=k?E.nativeToPseudo(U?[]:{}):b;for(let D in m)if(m.hasOwnProperty(D)){let Y=m[D],F=CalculationEngine._getPath(k,D,U),w=Y&&"object"==typeof Y?S(F,v(Y,F)):d(F);E.setProperty(G,D,Interpreter.VALUE_IN_DESCRIPTOR,{get:E.createNativeFunction(w)})}return G};v(CalculationEngine.unflattenObject(n),null),E.setProperty(b,"$value",Interpreter.VALUE_IN_DESCRIPTOR,{get:E.createNativeFunction(function(){return o}),set:E.createNativeFunction(function(m){return a=!0,o=m,m})}),E.setProperty(b,"$value",Interpreter.VALUE_IN_DESCRIPTOR,{get:E.createNativeFunction(function(){return o}),set:E.createNativeFunction(function(m){return a=!0,o=m,m})})});c.run();let u=a?o:c.value,h=typeof u;if("undefined"===h)return null;if(null===u||"number"===h||"boolean"===h||"string"===h)return u;throw"Only primitive types (number, boolean, string, and null) can be returned from calculations."}_calculateStep(e,t,n){this._startTracking(e);let i=null;try{i=this._executeCalculation(e,t,n)}catch(a){console.error("Calculation '"+e+"' failed. "+(a?.message||a))}return this._stopTracking(),i}_run(){if(!this._running){this._running=!0;for(let t=0;t<25&&this._expressionQueue.length>0;t++){let n=this._expressionQueue.dequeue(),i=this._expressions[n],a=this._calculateStep(n,i.expression,this._state);i.isListener?this.getListenerValue(n)!==a&&this.setListenerValue(n,a):this.getValue(n)!==a&&this.setValue(n,a),setTimeout(this._run.bind(this),0)}this._running=!1}}}!function(r){"use strict";var e=function(){function n(){this._dropEffect="move",this._effectAllowed="all",this._data={}}return Object.defineProperty(n.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(i){this._dropEffect=i},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(i){this._effectAllowed=i},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),n.prototype.clearData=function(i){null!==i?delete this._data[i.toLowerCase()]:this._data={}},n.prototype.getData=function(i){return this._data[i.toLowerCase()]||""},n.prototype.setData=function(i,a){this._data[i.toLowerCase()]=a},n.prototype.setDragImage=function(i,a,o){var c=t._instance;c._imgCustom=i,c._imgOffset={x:a,y:o}},n}();r.DataTransfer=e;var t=function(){function n(){if(this._lastClick=0,n._instance)throw"DragDropTouch instance already created.";var i=!1;if(document.addEventListener("test",function(){},{get passive(){return i=!0,!0}}),navigator.maxTouchPoints){var a=document,o=this._touchstart.bind(this),c=this._touchmove.bind(this),u=this._touchend.bind(this),h=!!i&&{passive:!1,capture:!1};a.addEventListener("touchstart",o,h),a.addEventListener("touchmove",c,h),a.addEventListener("touchend",u),a.addEventListener("touchcancel",u)}}return n.getInstance=function(){return n._instance},n.prototype._touchstart=function(i){var a=this;if(this._shouldHandle(i)){this._reset();var o=this._closestDraggable(i.target);o&&!this._dispatchEvent(i,"mousemove",i.target)&&!this._dispatchEvent(i,"mousedown",i.target)&&(this._dragSource=o,this._ptDown=this._getPoint(i),this._lastTouch=i,i.preventDefault(),setTimeout(function(){a._dragSource===o&&null===a._img&&a._dispatchEvent(i,"contextmenu",o)&&a._reset()},n._CTXMENU),n._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout(function(){a._isDragEnabled=!0,a._touchmove(i)},n._PRESSHOLDAWAIT)))}},n.prototype._touchmove=function(i){if(this._shouldCancelPressHoldMove(i))this._reset();else if(this._shouldHandleMove(i)||this._shouldHandlePressHoldMove(i)){var a=this._getTarget(i);if(this._dispatchEvent(i,"mousemove",a))return this._lastTouch=i,void i.preventDefault();if(this._dragSource&&!this._img&&this._shouldStartDragging(i)){if(this._dispatchEvent(this._lastTouch,"dragstart",this._dragSource))return void(this._dragSource=null);this._createImage(i),this._dispatchEvent(i,"dragenter",a)}this._img&&(this._lastTouch=i,i.preventDefault(),this._dispatchEvent(i,"drag",this._dragSource),a!==this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(i,"dragenter",a),this._lastTarget=a),this._moveImage(i),this._isDropZone=this._dispatchEvent(i,"dragover",a))}},n.prototype._touchend=function(i){if(this._shouldHandle(i)){if(this._dispatchEvent(this._lastTouch,"mouseup",i.target))return void i.preventDefault();this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",i.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(i.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())}},n.prototype._shouldHandle=function(i){return i&&!i.defaultPrevented&&i.touches&&i.touches.length<2},n.prototype._shouldHandleMove=function(i){return!n._ISPRESSHOLDMODE&&this._shouldHandle(i)},n.prototype._shouldHandlePressHoldMove=function(i){return n._ISPRESSHOLDMODE&&this._isDragEnabled&&i&&i.touches&&i.touches.length},n.prototype._shouldCancelPressHoldMove=function(i){return n._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(i)>n._PRESSHOLDMARGIN},n.prototype._shouldStartDragging=function(i){var a=this._getDelta(i);return a>n._THRESHOLD||n._ISPRESSHOLDMODE&&a>=n._PRESSHOLDTHRESHOLD},n.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new e,clearInterval(this._pressHoldInterval)},n.prototype._getPoint=function(i,a){return i&&i.touches&&(i=i.touches[0]),{x:a?i.pageX:i.clientX,y:a?i.pageY:i.clientY}},n.prototype._getDelta=function(i){if(n._ISPRESSHOLDMODE&&!this._ptDown)return 0;var a=this._getPoint(i);return Math.abs(a.x-this._ptDown.x)+Math.abs(a.y-this._ptDown.y)},n.prototype._getTarget=function(i){for(var a=this._getPoint(i),o=document.elementFromPoint(a.x,a.y);o&&"none"==getComputedStyle(o).pointerEvents;)o=o.parentElement;return o},n.prototype._createImage=function(i){this._img&&this._destroyImage();var a=this._imgCustom||this._dragSource;if(this._img=a.cloneNode(!0),this._copyStyle(a,this._img),this._img.style.top=this._img.style.left="-9999px",!this._imgCustom){var o=a.getBoundingClientRect(),c=this._getPoint(i);this._imgOffset={x:c.x-o.left,y:c.y-o.top},this._img.style.opacity=n._OPACITY.toString()}this._moveImage(i),document.body.appendChild(this._img)},n.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},n.prototype._moveImage=function(i){var a=this;requestAnimationFrame(function(){if(a._img){var o=a._getPoint(i,!0),c=a._img.style;c.position="absolute",c.pointerEvents="none",c.zIndex="999999",c.left=Math.round(o.x-a._imgOffset.x)+"px",c.top=Math.round(o.y-a._imgOffset.y)+"px"}})},n.prototype._copyProps=function(i,a,o){for(var c=0;c<o.length;c++){var u=o[c];i[u]=a[u]}},n.prototype._copyStyle=function(i,a){if(n._rmvAtts.forEach(function(b){a.removeAttribute(b)}),i instanceof HTMLCanvasElement){var o=i,c=a;c.width=o.width,c.height=o.height,c.getContext("2d").drawImage(o,0,0)}for(var u=getComputedStyle(i),h=0;h<u.length;h++){var E=u[h];E.indexOf("transition")<0&&(a.style[E]=u[E])}for(a.style.pointerEvents="none",h=0;h<i.children.length;h++)this._copyStyle(i.children[h],a.children[h])},n.prototype._setOffsetAndLayerProps=function(i,a){var o=void 0;void 0===i.offsetX&&(o=a.getBoundingClientRect(),i.offsetX=i.clientX-o.x,i.offsetY=i.clientY-o.y),void 0===i.layerX&&(o=o||a.getBoundingClientRect(),i.layerX=i.pageX-o.left,i.layerY=i.pageY-o.top)},n.prototype._dispatchEvent=function(i,a,o){if(i&&o){var c=document.createEvent("Event"),u=i.touches?i.touches[0]:i;return c.initEvent(a,!0,!0),c.button=0,c.which=c.buttons=1,this._copyProps(c,i,n._kbdProps),this._copyProps(c,u,n._ptProps),this._setOffsetAndLayerProps(c,o),c.dataTransfer=this._dataTransfer,o.dispatchEvent(c),c.defaultPrevented}return!1},n.prototype._closestDraggable=function(i){for(;i;i=i.parentElement)if(i.hasAttribute("draggable")&&i.draggable)return i;return null},n}();t._instance=new t,t._THRESHOLD=5,t._OPACITY=.5,t._DBLCLICK=500,t._CTXMENU=900,t._ISPRESSHOLDMODE=!1,t._PRESSHOLDAWAIT=400,t._PRESSHOLDMARGIN=25,t._PRESSHOLDTHRESHOLD=0,t._rmvAtts="id,class,style,draggable".split(","),t._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),t._ptProps="pageX,pageY,clientX,clientY,screenX,screenY,offsetX,offsetY".split(","),r.DragDropTouch=t}(DragDropTouch||(DragDropTouch={}));
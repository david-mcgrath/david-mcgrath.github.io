!function(t,e){"object"==typeof exports&&"object"==typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.acorn||(t.acorn={}))}(this,function(t){"use strict";var e,r,i,n;t.version="0.5.0",t.parse=function(u,c){return r=String(u),i=r.length,function o(u){for(var c in e=u||{},a)Object.prototype.hasOwnProperty.call(e,c)||(e[c]=a[c]);n=e.sourceFile||null}(c),function Jt(){U=1,s=D=0,S=!0,ae()}(),function nr(u){G=k=s,e.locations&&(V=new z),M=F=null,w=[],ee();var c=u||I(),l=!0;for(u||(c.body=[]);d!==Ne;){var p=B();c.body.push(p),l&&Le(p)&&ke(!0),l=!1}return v(c,"Program")}(e.program)};var s,h,E,O,N,d,_,S,U,D,G,k,V,M,w,F,a={strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null},f=function(u,c){for(var l=1,p=0;;){ye.lastIndex=p;var g=ye.exec(u);if(!(g&&g.index<c))break;++l,p=g.index+g[0].length}return{line:l,column:c-p}};function b(u,c){var l=f(r,u),p=new SyntaxError(c+=" ("+l.line+":"+l.column+")");throw p.pos=u,p.loc=l,p.raisedAt=s,p}var Ct=[],le={type:"num"},Xe={type:"regexp"},Oe={type:"string"},K={type:"name"},Ne={type:"eof"},Se={keyword:"break"},Pe={keyword:"case",beforeExpr:!0},Je={keyword:"catch"},qe={keyword:"continue"},We={keyword:"debugger"},Qe={keyword:"default"},He={keyword:"do",isLoop:!0},ze={keyword:"else",beforeExpr:!0},$e={keyword:"finally"},Ke={keyword:"for",isLoop:!0},me={keyword:"function"},Ze={keyword:"if"},et={keyword:"return",beforeExpr:!0},Te={keyword:"switch"},tt={keyword:"throw",beforeExpr:!0},rt={keyword:"try"},we={keyword:"var"},Ce={keyword:"while",isLoop:!0},it={keyword:"with"},nt={keyword:"new",beforeExpr:!0},at={keyword:"this"},ot={keyword:"null",atomValue:null},ut={keyword:"true",atomValue:!0},st={keyword:"false",atomValue:!1},pe={keyword:"in",binop:7,beforeExpr:!0},At={break:Se,case:Pe,catch:Je,continue:qe,debugger:We,default:Qe,do:He,else:ze,finally:$e,for:Ke,function:me,if:Ze,return:et,switch:Te,throw:tt,try:rt,var:we,while:Ce,with:it,null:ot,true:ut,false:st,new:nt,in:pe,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:at,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},Ae={type:"[",beforeExpr:!0},xe={type:"]"},ie={type:"{",beforeExpr:!0},Z={type:"}"},Y={type:"(",beforeExpr:!0},j={type:")"},q={type:",",beforeExpr:!0},X={type:";",beforeExpr:!0},ne={type:":",beforeExpr:!0},ct={type:"."},ft={type:"?",beforeExpr:!0},lt={binop:10,beforeExpr:!0},pt={isAssign:!0,beforeExpr:!0},H={isAssign:!0,beforeExpr:!0},xt={postfix:!0,prefix:!0,isUpdate:!0},ht={prefix:!0,beforeExpr:!0},dt={binop:1,beforeExpr:!0},Et={binop:2,beforeExpr:!0},It={binop:3,beforeExpr:!0},kt={binop:4,beforeExpr:!0},Lt={binop:5,beforeExpr:!0},Ut={binop:6,beforeExpr:!0},Dt={binop:7,beforeExpr:!0},Ft={binop:8,beforeExpr:!0},Mt={binop:9,prefix:!0,beforeExpr:!0},Bt={binop:10,beforeExpr:!0};function he(u){u=u.split(" ");for(var c=Object.create(null),l=0;l<u.length;l++)c[u[l]]=!0;return function(p){return c[p]||!1}}var te,jt=he("class enum extends super const export import"),yt=he("implements interface let package private protected public static yield"),de=he("eval arguments"),Gt=he("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Vt=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,vt="\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",_t=new RegExp("["+vt+"]"),Xt=new RegExp("["+vt+"\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u0620-\u0649\u0672-\u06d3\u06e7-\u06e8\u06fb-\u06fc\u0730-\u074a\u0800-\u0814\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0840-\u0857\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962-\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09d7\u09df-\u09e0\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5f-\u0b60\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62-\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2-\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d46-\u0d48\u0d57\u0d62-\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e34-\u0e3a\u0e40-\u0e45\u0e50-\u0e59\u0eb4-\u0eb9\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f41-\u0f47\u0f71-\u0f84\u0f86-\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1029\u1040-\u1049\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u170e-\u1710\u1720-\u1730\u1740-\u1750\u1772\u1773\u1780-\u17b2\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1920-\u192b\u1930-\u193b\u1951-\u196d\u19b0-\u19c0\u19c8-\u19c9\u19d0-\u19d9\u1a00-\u1a15\u1a20-\u1a53\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b46-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1bb0-\u1bb9\u1be6-\u1bf3\u1c00-\u1c22\u1c40-\u1c49\u1c5b-\u1c7d\u1cd0-\u1cd2\u1d00-\u1dbe\u1e01-\u1f15\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2d81-\u2d96\u2de0-\u2dff\u3021-\u3028\u3099\u309a\ua640-\ua66d\ua674-\ua67d\ua69f\ua6f0-\ua6f1\ua7f8-\ua800\ua806\ua80b\ua823-\ua827\ua880-\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8f3-\ua8f7\ua900-\ua909\ua926-\ua92d\ua930-\ua945\ua980-\ua983\ua9b3-\ua9c0\uaa00-\uaa27\uaa40-\uaa41\uaa4c-\uaa4d\uaa50-\uaa59\uaa7b\uaae0-\uaae9\uaaf2-\uaaf3\uabc0-\uabe1\uabec\uabed\uabf0-\uabf9\ufb20-\ufb28\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]"),Ee=/[\n\r\u2028\u2029]/,ye=/\r\n|[\n\r\u2028\u2029]/g,ve=function(u){return u<65?36===u:u<91||(u<97?95===u:u<123||u>=170&&_t.test(String.fromCharCode(u)))},gt=function(u){return u<48?36===u:u<58||!(u<65)&&(u<91||(u<97?95===u:u<123||u>=170&&Xt.test(String.fromCharCode(u))))};function z(){this.line=U,this.column=s-D}function A(u,c){E=s,e.locations&&(N=new z),d=u,ae(),_=c,S=u.beforeExpr}function qt(){var u=e.onComment&&e.locations&&new z,c=s,l=r.indexOf("*/",s+=2);if(-1===l&&b(s-2,"Unterminated comment"),s=l+2,e.locations){ye.lastIndex=c;for(var p;(p=ye.exec(r))&&p.index<s;)++U,D=p.index+p[0].length}e.onComment&&e.onComment(!0,r.slice(c+2,l),c,s,u,e.locations&&new z)}function Ie(){for(var u=s,c=e.onComment&&e.locations&&new z,l=r.charCodeAt(s+=2);s<i&&10!==l&&13!==l&&8232!==l&&8233!==l;)++s,l=r.charCodeAt(s);e.onComment&&e.onComment(!1,r.slice(u+2,s),u,s,c,e.locations&&new z)}function ae(){for(;s<i;){var u=r.charCodeAt(s);if(32===u)++s;else if(13===u)++s,10===(c=r.charCodeAt(s))&&++s,e.locations&&(++U,D=s);else if(10===u||8232===u||8233===u)++s,e.locations&&(++U,D=s);else if(u>8&&u<14)++s;else if(47===u){var c;if(42===(c=r.charCodeAt(s+1)))qt();else{if(47!==c)break;Ie()}}else if(160===u)++s;else{if(!(u>=5760&&Vt.test(String.fromCharCode(u))))break;++s}}}function ee(u){if(u?s=h+1:h=s,e.locations&&(O=new z),u)return Rt();if(s>=i)return A(Ne);var c=r.charCodeAt(s);if(ve(c)||92===c)return Nt();var l=function tr(u){switch(u){case 46:return function Wt(){var u=r.charCodeAt(s+1);return u>=48&&u<=57?bt(!0):(++s,A(ct))}();case 40:return++s,A(Y);case 41:return++s,A(j);case 59:return++s,A(X);case 44:return++s,A(q);case 91:return++s,A(Ae);case 93:return++s,A(xe);case 123:return++s,A(ie);case 125:return++s,A(Z);case 58:return++s,A(ne);case 63:return++s,A(ft);case 48:var c=r.charCodeAt(s+1);if(120===c||88===c)return function rr(){s+=2;var u=oe(16);return null==u&&b(h+2,"Expected hexadecimal number"),ve(r.charCodeAt(s))&&b(s,"Identifier directly after number"),A(le,u)}();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return bt(!1);case 34:case 39:return function ir(u){s++;for(var c="";;){s>=i&&b(h,"Unterminated string constant");var l=r.charCodeAt(s);if(l===u)return++s,A(Oe,c);if(92===l){l=r.charCodeAt(++s);var p=/^[0-7]+/.exec(r.slice(s,s+3));for(p&&(p=p[0]);p&&parseInt(p,8)>255;)p=p.slice(0,-1);if("0"===p&&(p=null),++s,p)F&&b(s-2,"Octal literal in strict mode"),c+=String.fromCharCode(parseInt(p,8)),s+=p.length-1;else switch(l){case 110:c+="\n";break;case 114:c+="\r";break;case 120:c+=String.fromCharCode(_e(2));break;case 117:c+=String.fromCharCode(_e(4));break;case 85:c+=String.fromCharCode(_e(8));break;case 116:c+="\t";break;case 98:c+="\b";break;case 118:c+="\v";break;case 102:c+="\f";break;case 48:c+="\0";break;case 13:10===r.charCodeAt(s)&&++s;case 10:e.locations&&(D=s,++U);break;default:c+=String.fromCharCode(l)}}else(13===l||10===l||8232===l||8233===l)&&b(h,"Unterminated string constant"),c+=String.fromCharCode(l),++s}}(u);case 47:return function Qt(){var u=r.charCodeAt(s+1);return S?(++s,Rt()):61===u?x(H,2):x(lt,1)}();case 37:case 42:return function Ht(){return 61===r.charCodeAt(s+1)?x(H,2):x(Bt,1)}();case 124:case 38:return function zt(u){var c=r.charCodeAt(s+1);return c===u?x(124===u?dt:Et,2):61===c?x(H,2):x(124===u?It:Lt,1)}(u);case 94:return function $t(){return 61===r.charCodeAt(s+1)?x(H,2):x(kt,1)}();case 43:case 45:return function Kt(u){var c=r.charCodeAt(s+1);return c===u?45==c&&62==r.charCodeAt(s+2)&&Ee.test(r.slice(k,s))?(s+=3,Ie(),ae(),ee()):x(xt,2):61===c?x(H,2):x(Mt,1)}(u);case 60:case 62:return function Zt(u){var c=r.charCodeAt(s+1),l=1;return c===u?(l=62===u&&62===r.charCodeAt(s+2)?3:2,61===r.charCodeAt(s+l)?x(H,l+1):x(Ft,l)):33==c&&60==u&&45==r.charCodeAt(s+2)&&45==r.charCodeAt(s+3)?(s+=4,Ie(),ae(),ee()):(61===c&&(l=61===r.charCodeAt(s+2)?3:2),x(Dt,l))}(u);case 61:case 33:return function er(u){return 61===r.charCodeAt(s+1)?x(Ut,61===r.charCodeAt(s+2)?3:2):x(61===u?pt:ht,1)}(u);case 126:return x(ht,1)}return!1}(c);if(!1===l){var p=String.fromCharCode(c);if("\\"===p||_t.test(p))return Nt();b(s,"Unexpected character '"+p+"'")}return l}function x(u,c){var l=r.slice(s,s+c);s+=c,A(u,l)}function Rt(){for(var u,c,l=s;;){s>=i&&b(l,"Unterminated regular expression");var p=r.charAt(s);if(Ee.test(p)&&b(l,"Unterminated regular expression"),u)u=!1;else{if("["===p)c=!0;else if("]"===p&&c)c=!1;else if("/"===p&&!c)break;u="\\"===p}++s}var g=r.slice(l,s);++s;var y=Ot();y&&!/^[gmi]*$/.test(y)&&b(l,"Invalid regexp flag");try{var R=new RegExp(g,y)}catch(m){m instanceof SyntaxError&&b(l,m.message),b(m)}return A(Xe,R)}function oe(u,c){for(var l=s,p=0,g=0,y=c??1/0;g<y;++g){var m,R=r.charCodeAt(s);if((m=R>=97?R-97+10:R>=65?R-65+10:R>=48&&R<=57?R-48:1/0)>=u)break;++s,p=p*u+m}return s===l||null!=c&&s-l!==c?null:p}function bt(u){var c=s,l=!1,p=48===r.charCodeAt(s);!u&&null===oe(10)&&b(c,"Invalid number"),46===r.charCodeAt(s)&&(++s,oe(10),l=!0);var g=r.charCodeAt(s);(69===g||101===g)&&((43===(g=r.charCodeAt(++s))||45===g)&&++s,null===oe(10)&&b(c,"Invalid number"),l=!0),ve(r.charCodeAt(s))&&b(s,"Identifier directly after number");var R,y=r.slice(c,s);return l?R=parseFloat(y):p&&1!==y.length?/[89]/.test(y)||F?b(c,"Invalid number"):R=parseInt(y,8):R=parseInt(y,10),A(le,R)}function _e(u){var c=oe(16,u);return null===c&&b(h,"Bad character escape sequence"),c}function Ot(){te=!1;for(var u,c=!0,l=s;;){var p=r.charCodeAt(s);if(gt(p))te&&(u+=r.charAt(s)),++s;else{if(92!==p)break;te||(u=r.slice(l,s)),te=!0,117!=r.charCodeAt(++s)&&b(s,"Expecting Unicode escape sequence \\uXXXX"),++s;var g=_e(4),y=String.fromCharCode(g);y||b(s-1,"Invalid Unicode escape"),(c?ve(g):gt(g))||b(s-4,"Invalid Unicode escape"),u+=y}c=!1}return te?u:r.slice(l,s)}function Nt(){var u=Ot(),c=K;return!te&&Gt(u)&&(c=At[u]),A(c,u)}function P(){G=h,k=E,V=N,ee()}function ke(u){if(F=u,s=h,e.locations)for(;s<D;)D=r.lastIndexOf("\n",D-2)+1,--U;ae(),ee()}function St(){this.type=null,this.start=h,this.end=null}function Pt(){this.start=O,this.end=null,null!==n&&(this.source=n)}function I(){var u=new St;return e.locations&&(u.loc=new Pt),e.directSourceFile&&(u.sourceFile=e.directSourceFile),e.ranges&&(u.range=[h,0]),u}function W(u){var c=new St;return c.start=u.start,e.locations&&(c.loc=new Pt,c.loc.start=u.loc.start),e.ranges&&(c.range=[u.range[0],0]),c}function v(u,c){return u.type=c,u.end=k,e.locations&&(u.loc.end=V),e.ranges&&(u.range[1]=k),u}function Le(u){return"ExpressionStatement"===u.type&&"Literal"===u.expression.type&&"use strict"===u.expression.value}function T(u){if(d===u)return P(),!0}function ge(){return!e.strictSemicolons&&(d===Ne||d===Z||Ee.test(r.slice(k,h)))}function $(){!T(X)&&!ge()&&J()}function C(u){d===u?P():J()}function J(){b(h,"Unexpected token")}function Re(u){"Identifier"!==u.type&&"MemberExpression"!==u.type&&b(u.start,"Assigning to rvalue"),F&&"Identifier"===u.type&&de(u.name)&&b(u.start,"Assigning to "+u.name+" in strict mode")}var Ue={kind:"loop"},ar={kind:"switch"};function B(){(d===lt||d===H&&"/="==_)&&ee(!0);var u=d,c=I();switch(u){case Se:case qe:P();var l=u===Se;T(X)||ge()?c.label=null:d!==K?J():(c.label=Q(),$());for(var p=0;p<w.length;++p){var g=w[p];if((null==c.label||g.name===c.label.name)&&(null!=g.kind&&(l||"loop"===g.kind)||c.label&&l))break}return p===w.length&&b(c.start,"Unsyntactic "+u.keyword),v(c,l?"BreakStatement":"ContinueStatement");case We:return P(),$(),v(c,"DebuggerStatement");case He:return P(),w.push(Ue),c.body=B(),w.pop(),C(Ce),c.test=ue(),$(),v(c,"DoWhileStatement");case Ke:if(P(),w.push(Ue),C(Y),d===X)return De(c,null);if(d===we){var y=I();return P(),Tt(y,!0),v(y,"VariableDeclaration"),1===y.declarations.length&&T(pe)?mt(c,y):De(c,y)}return y=L(!1,!0),T(pe)?(Re(y),mt(c,y)):De(c,y);case me:return P(),Ge(c,!0);case Ze:return P(),c.test=ue(),c.consequent=B(),c.alternate=T(ze)?B():null,v(c,"IfStatement");case et:return!M&&!e.allowReturnOutsideFunction&&b(h,"'return' outside of function"),P(),T(X)||ge()?c.argument=null:(c.argument=L(),$()),v(c,"ReturnStatement");case Te:P(),c.discriminant=ue(),c.cases=[],C(ie),w.push(ar);for(var R,m;d!=Z;)if(d===Pe||d===Qe){var fe=d===Pe;R&&v(R,"SwitchCase"),c.cases.push(R=I()),R.consequent=[],P(),fe?R.test=L():(m&&b(G,"Multiple default clauses"),m=!0,R.test=null),C(ne)}else R||J(),R.consequent.push(B());return R&&v(R,"SwitchCase"),P(),w.pop(),v(c,"SwitchStatement");case tt:return P(),Ee.test(r.slice(k,h))&&b(k,"Illegal newline after throw"),c.argument=L(),$(),v(c,"ThrowStatement");case rt:if(P(),c.block=se(),c.handler=null,d===Je){var re=I();P(),C(Y),re.param=Q(),F&&de(re.param.name)&&b(re.param.start,"Binding "+re.param.name+" in strict mode"),C(j),re.body=se(),c.handler=v(re,"CatchClause")}return c.finalizer=T($e)?se():null,!c.handler&&!c.finalizer&&b(c.start,"Missing catch or finally clause"),v(c,"TryStatement");case we:return P(),Tt(c),$(),v(c,"VariableDeclaration");case Ce:return P(),c.test=ue(),w.push(Ue),c.body=B(),w.pop(),v(c,"WhileStatement");case it:return F&&b(h,"'with' in strict mode"),P(),c.object=ue(),c.body=B(),v(c,"WithStatement");case ie:return se();case X:return P(),v(c,"EmptyStatement");default:var Ye=_,be=L();if(u===K&&"Identifier"===be.type&&T(ne)){for(p=0;p<w.length;++p)w[p].name===Ye&&b(be.start,"Label '"+Ye+"' is already declared");return w.push({name:Ye,kind:d.isLoop?"loop":d===Te?"switch":null}),c.body=B(),w.pop(),c.label=be,v(c,"LabeledStatement")}return c.expression=be,$(),v(c,"ExpressionStatement")}}function ue(){C(Y);var u=L();return C(j),u}function se(u){var g,c=I(),l=!0,p=!1;for(c.body=[],C(ie);!T(Z);){var y=B();c.body.push(y),l&&u&&Le(y)&&(g=p,ke(p=!0)),l=!1}return p&&!g&&ke(!1),v(c,"BlockStatement")}function De(u,c){return u.init=c,C(X),u.test=d===X?null:L(),C(X),u.update=d===j?null:L(),C(j),u.body=B(),w.pop(),v(u,"ForStatement")}function mt(u,c){return u.left=c,u.right=L(),C(j),u.body=B(),w.pop(),v(u,"ForInStatement")}function Tt(u,c){for(u.declarations=[],u.kind="var";;){var l=I();if(l.id=Q(),F&&de(l.id.name)&&b(l.id.start,"Binding "+l.id.name+" in strict mode"),l.init=T(pt)?L(!0,c):null,u.declarations.push(v(l,"VariableDeclarator")),!T(q))break}return u}function L(u,c){var l=Fe(c);if(!u&&d===q){var p=W(l);for(p.expressions=[l];T(q);)p.expressions.push(Fe(c));return v(p,"SequenceExpression")}return l}function Fe(u){var c=function or(u){var c=function ur(u){return Me(Be(),-1,u)}(u);if(T(ft)){var l=W(c);return l.test=c,l.consequent=L(!0),C(ne),l.alternate=L(!0,u),v(l,"ConditionalExpression")}return c}(u);if(d.isAssign){var l=W(c);return l.operator=_,l.left=c,P(),l.right=Fe(u),Re(c),v(l,"AssignmentExpression")}return c}function Me(u,c,l){var p=d.binop;if(null!=p&&(!l||d!==pe)&&p>c){var g=W(u);g.left=u,g.operator=_;var y=d;return P(),g.right=Me(Be(),p,l),Me(v(g,y===dt||y===Et?"LogicalExpression":"BinaryExpression"),c,l)}return u}function Be(){if(d.prefix){var u=I(),c=d.isUpdate;return u.operator=_,u.prefix=!0,S=!0,P(),u.argument=Be(),c?Re(u.argument):F&&"delete"===u.operator&&"Identifier"===u.argument.type&&b(u.start,"Deleting local variable in strict mode"),v(u,c?"UpdateExpression":"UnaryExpression")}for(var l=function sr(){return ce(je())}();d.postfix&&!ge();)(u=W(l)).operator=_,u.prefix=!1,u.argument=l,Re(l),P(),l=v(u,"UpdateExpression");return l}function ce(u,c){var l;return T(ct)?((l=W(u)).object=u,l.property=Q(!0),l.computed=!1,ce(v(l,"MemberExpression"),c)):T(Ae)?((l=W(u)).object=u,l.property=L(),l.computed=!0,C(xe),ce(v(l,"MemberExpression"),c)):!c&&T(Y)?((l=W(u)).callee=u,l.arguments=Ve(j,!1),ce(v(l,"CallExpression"),c)):u}function je(){switch(d){case at:var p=I();return P(),v(p,"ThisExpression");case K:return Q();case le:case Oe:case Xe:return(p=I()).value=_,p.raw=r.slice(h,E),P(),v(p,"Literal");case ot:case ut:case st:return(p=I()).value=d.atomValue,p.raw=d.keyword,P(),v(p,"Literal");case Y:var u=O,c=h;P();var l=L();return l.start=c,l.end=E,e.locations&&(l.loc.start=u,l.loc.end=N),e.ranges&&(l.range=[c,E]),C(j),l;case Ae:return p=I(),P(),p.elements=Ve(xe,!0,!0),v(p,"ArrayExpression");case ie:return function fr(){var u=I(),c=!0,l=!1;for(u.properties=[],P();!T(Z);){if(c)c=!1;else if(C(q),e.allowTrailingCommas&&T(Z))break;var y,p={key:wt()},g=!1;if(T(ne)?(p.value=L(!0),y=p.kind="init"):"Identifier"!==p.key.type||"get"!==p.key.name&&"set"!==p.key.name?J():(g=l=!0,y=p.kind=p.key.name,p.key=wt(),d!==Y&&J(),p.value=Ge(I(),!1)),"Identifier"===p.key.type&&(F||l))for(var R=0;R<u.properties.length;++R){var m=u.properties[R];if(m.key.name===p.key.name){var fe=y==m.kind||g&&"init"===m.kind||"init"===y&&("get"===m.kind||"set"===m.kind);fe&&!F&&"init"===y&&"init"===m.kind&&(fe=!1),fe&&b(p.key.start,"Redefinition of property")}}u.properties.push(p)}return v(u,"ObjectExpression")}();case me:return p=I(),P(),Ge(p,!1);case nt:return function cr(){var u=I();return P(),u.callee=ce(je(),!0),u.arguments=T(Y)?Ve(j,!1):Ct,v(u,"NewExpression")}();default:J()}}function wt(){return d===le||d===Oe?je():Q(!0)}function Ge(u,c){d===K?u.id=Q():c?J():u.id=null,u.params=[];var l=!0;for(C(Y);!T(j);)l?l=!1:C(q),u.params.push(Q());var p=M,g=w;if(M=!0,w=[],u.body=se(!0),M=p,w=g,F||u.body.body.length&&Le(u.body.body[0]))for(var y=u.id?-1:0;y<u.params.length;++y){var R=y<0?u.id:u.params[y];if((yt(R.name)||de(R.name))&&b(R.start,"Defining '"+R.name+"' in strict mode"),y>=0)for(var m=0;m<y;++m)R.name===u.params[m].name&&b(R.start,"Argument name clash in strict mode")}return v(u,c?"FunctionDeclaration":"FunctionExpression")}function Ve(u,c,l){for(var p=[],g=!0;!T(u);){if(g)g=!1;else if(C(q),c&&e.allowTrailingCommas&&T(u))break;p.push(l&&d===q?null:L(!0))}return p}function Q(u){var c=I();return u&&"everywhere"==e.forbidReserved&&(u=!1),d===K?(!u&&(e.forbidReserved&&jt(_)||F&&yt(_))&&-1==r.slice(h,E).indexOf("\\")&&b(h,"The keyword '"+_+"' is reserved"),c.name=_):u&&d.keyword?c.name=d.keyword:J(),S=!1,P(),v(c,"Identifier")}});var Interpreter=function(t,e){"string"==typeof t&&(t=this.parse_(t,"code"));var r=t.constructor;this.newNode=function(){return new r({options:{}})};var i=this.newNode();for(var n in t)i[n]="body"===n?t[n].slice():t[n];this.ast=i,this.initFunc_=e,this.paused_=!1,this.polyfills_=[],this.functionCounter_=0,this.stepFunctions_=Object.create(null);var o,a=/^step([A-Z]\w*)$/;for(var f in this)"function"==typeof this[f]&&(o=f.match(a))&&(this.stepFunctions_[o[1]]=this[f].bind(this));this.globalScope=this.createScope(this.ast,null),this.globalObject=this.globalScope.object,this.ast=this.parse_(this.polyfills_.join("\n"),"polyfills"),this.polyfills_=void 0,Interpreter.stripLocations_(this.ast,void 0,void 0);var s=new Interpreter.State(this.ast,this.globalScope);s.done=!1,this.stateStack=[s],this.run(),this.value=void 0,this.ast=i,(s=new Interpreter.State(this.ast,this.globalScope)).done=!1,this.stateStack.length=0,this.stateStack[0]=s};Interpreter.Completion={NORMAL:0,BREAK:1,CONTINUE:2,RETURN:3,THROW:4},Interpreter.PARSE_OPTIONS={locations:!0,ecmaVersion:5},Interpreter.READONLY_DESCRIPTOR={configurable:!0,enumerable:!0,writable:!1},Interpreter.NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!0},Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!1},Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!1,enumerable:!1,writable:!1},Interpreter.VARIABLE_DESCRIPTOR={configurable:!1,enumerable:!0,writable:!0},Interpreter.STEP_ERROR={STEP_ERROR:!0},Interpreter.SCOPE_REFERENCE={SCOPE_REFERENCE:!0},Interpreter.VALUE_IN_DESCRIPTOR={VALUE_IN_DESCRIPTOR:!0},Interpreter.REGEXP_TIMEOUT={REGEXP_TIMEOUT:!0},Interpreter.toStringCycles_=[],Interpreter.vm=null,Interpreter.currentInterpreter_=null,Interpreter.nativeGlobal=typeof globalThis>"u"?this:globalThis,Interpreter.WORKER_CODE=["onmessage = function(e) {","var result;","var data = e.data;","switch (data[0]) {","case 'split':","result = data[1].split(data[2], data[3]);","break;","case 'match':","result = data[1].match(data[2]);","break;","case 'search':","result = data[1].search(data[2]);","break;","case 'replace':","result = data[1].replace(data[2], data[3]);","break;","case 'exec':","var regexp = data[1];","regexp.lastIndex = data[2];","result = [regexp.exec(data[3]), data[1].lastIndex];","break;","default:","throw Error('Unknown RegExp operation: ' + data[0]);","}","postMessage(result);","close();","};"],Interpreter.legalArrayLength=function(t){var e=t>>>0;return e===Number(t)?e:NaN},Interpreter.legalArrayIndex=function(t){var e=t>>>0;return String(e)===String(t)&&4294967295!==e?e:NaN},Interpreter.stripLocations_=function(t,e,r){for(var i in e?t.start=e:delete t.start,r?t.end=r:delete t.end,t)if("loc"!==i&&t.hasOwnProperty(i)){var n=t[i];n&&"object"==typeof n&&Interpreter.stripLocations_(n,e,r)}},Interpreter.prototype.REGEXP_MODE=2,Interpreter.prototype.REGEXP_THREAD_TIMEOUT=1e3,Interpreter.prototype.POLYFILL_TIMEOUT=1e3,Interpreter.prototype.getterStep_=!1,Interpreter.prototype.setterStep_=!1,Interpreter.prototype.appendCodeNumber_=0,Interpreter.prototype.parse_=function(t,e){var r={};for(var i in Interpreter.PARSE_OPTIONS)r[i]=Interpreter.PARSE_OPTIONS[i];return r.sourceFile=e,Interpreter.nativeGlobal.acorn.parse(t,r)},Interpreter.prototype.appendCode=function(t){var e=this.stateStack[0];if(!e||"Program"!==e.node.type)throw Error("Expecting original AST to start with a Program node");if("string"==typeof t&&(t=this.parse_(t,"appendCode"+this.appendCodeNumber_++)),!t||"Program"!==t.type)throw Error("Expecting new AST to start with a Program node");this.populateScope_(t,e.scope),Array.prototype.push.apply(e.node.body,t.body),e.node.body.variableCache_=null,e.done=!1},Interpreter.prototype.step=function(){var t=this.stateStack;do{var e=t[t.length-1];if(!e)return!1;var r=e.node,i=r.type;if("Program"===i&&e.done)return!1;if(this.paused_)return!0;var n=Interpreter.currentInterpreter_;Interpreter.currentInterpreter_=this;try{var a=this.stepFunctions_[i](t,e,r)}catch(f){if(f!==Interpreter.STEP_ERROR)throw this.value!==f&&(this.value=void 0),f}finally{Interpreter.currentInterpreter_=n}if(a&&t.push(a),this.getterStep_)throw this.value=void 0,Error("Getter not supported in this context");if(this.setterStep_)throw this.value=void 0,Error("Setter not supported in this context");if(!o&&!r.end)var o=Date.now()+this.POLYFILL_TIMEOUT}while(!r.end&&o>Date.now());return!0},Interpreter.prototype.run=function(){for(;!this.paused_&&this.step(););return this.paused_},Interpreter.prototype.initGlobal=function(t){this.setProperty(t,"NaN",NaN,Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"Infinity",1/0,Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"undefined",void 0,Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"window",t,Interpreter.READONLY_DESCRIPTOR),this.setProperty(t,"this",t,Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"self",t),this.OBJECT_PROTO=new Interpreter.Object(null),this.FUNCTION_PROTO=new Interpreter.Object(this.OBJECT_PROTO),this.initFunction(t),this.initObject(t),t.proto=this.OBJECT_PROTO,this.setProperty(t,"constructor",this.OBJECT,Interpreter.NONENUMERABLE_DESCRIPTOR),this.initArray(t),this.initString(t),this.initBoolean(t),this.initNumber(t),this.initDate(t),this.initRegExp(t),this.initError(t),this.initMath(t),this.initJSON(t);var e=this,r=this.createNativeFunction(function(o){throw EvalError("Can't happen")},!1);r.eval=!0,this.setProperty(t,"eval",r,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"parseInt",this.createNativeFunction(parseInt,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"parseFloat",this.createNativeFunction(parseFloat,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"isNaN",this.createNativeFunction(isNaN,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"isFinite",this.createNativeFunction(isFinite,!1),Interpreter.NONENUMERABLE_DESCRIPTOR);for(var i=[[escape,"escape"],[unescape,"unescape"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"]],n=0;n<i.length;n++){var a=function(o){return function(f){try{return o(f)}catch(s){e.throwException(e.URI_ERROR,s.message)}}}(i[n][0]);this.setProperty(t,i[n][1],this.createNativeFunction(a,!1),Interpreter.NONENUMERABLE_DESCRIPTOR)}this.OBJECT=this.OBJECT,this.OBJECT_PROTO=this.OBJECT_PROTO,this.FUNCTION=this.FUNCTION,this.FUNCTION_PROTO=this.FUNCTION_PROTO,this.ARRAY=this.ARRAY,this.ARRAY_PROTO=this.ARRAY_PROTO,this.REGEXP=this.REGEXP,this.REGEXP_PROTO=this.REGEXP_PROTO,this.DATE=this.DATE,this.DATE_PROTO=this.DATE_PROTO,this.initFunc_&&this.initFunc_(this,t)},Interpreter.prototype.functionCodeNumber_=0,Interpreter.prototype.initFunction=function(t){var r,e=this,i=/^[A-Za-z_$][\w$]*$/;r=function(a){if(arguments.length)var o=String(arguments[arguments.length-1]);else o="";var f=Array.prototype.slice.call(arguments,0,-1).join(",").trim();if(f){for(var s=f.split(/\s*,\s*/),h=0;h<s.length;h++){var E=s[h];i.test(E)||e.throwException(e.SYNTAX_ERROR,"Invalid function argument: "+E)}f=s.join(", ")}try{var O=e.parse_("(function("+f+") {"+o+"})","function"+e.functionCodeNumber_++)}catch(d){e.throwException(e.SYNTAX_ERROR,"Invalid code: "+d.message)}return 1!==O.body.length&&e.throwException(e.SYNTAX_ERROR,"Invalid code in function body."),e.createFunction(O.body[0].expression,e.globalScope,"anonymous")},this.FUNCTION=this.createNativeFunction(r,!0),this.setProperty(t,"Function",this.FUNCTION,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION,"prototype",this.FUNCTION_PROTO,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION_PROTO,"constructor",this.FUNCTION,Interpreter.NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.nativeFunc=function(){},this.FUNCTION_PROTO.nativeFunc.id=this.functionCounter_++,this.FUNCTION_PROTO.illegalConstructor=!0,this.setProperty(this.FUNCTION_PROTO,"length",0,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.class="Function",this.setNativeFunctionPrototype(this.FUNCTION,"apply",r=function(a,o){var f=e.stateStack[e.stateStack.length-1];f.func_=this,f.funcThis_=a,f.arguments_=[],null!=o&&(o instanceof Interpreter.Object?f.arguments_=e.arrayPseudoToNative(o):e.throwException(e.TYPE_ERROR,"CreateListFromArrayLike called on non-object")),f.doneExec_=!1}),r=function(a){var o=e.stateStack[e.stateStack.length-1];o.func_=this,o.funcThis_=a,o.arguments_=[];for(var f=1;f<arguments.length;f++)o.arguments_.push(arguments[f]);o.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"call",r),this.polyfills_.push("Object.defineProperty(Function.prototype, 'bind',","{configurable: true, writable: true, value:","function bind(oThis) {","if (typeof this !== 'function') {","throw TypeError('What is trying to be bound is not callable');","}","var aArgs   = Array.prototype.slice.call(arguments, 1),","fToBind = this,","fNOP    = function() {},","fBound  = function() {","return fToBind.apply(this instanceof fNOP","? this",": oThis,","aArgs.concat(Array.prototype.slice.call(arguments)));","};","if (this.prototype) {","fNOP.prototype = this.prototype;","}","fBound.prototype = new fNOP();","return fBound;","}","});",""),this.setNativeFunctionPrototype(this.FUNCTION,"toString",r=function(){return String(this)}),this.setProperty(this.FUNCTION,"toString",this.createNativeFunction(r,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setNativeFunctionPrototype(this.FUNCTION,"valueOf",r=function(){return this.valueOf()}),this.setProperty(this.FUNCTION,"valueOf",this.createNativeFunction(r,!1),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.initObject=function(t){var e=this;this.OBJECT=this.createNativeFunction(function(a){if(null==a)return e.calledWithNew()?this:e.createObjectProto(e.OBJECT_PROTO);if(!(a instanceof Interpreter.Object)){var o=e.createObjectProto(e.getPrototype(a));return o.data=a,o}return a},!0),this.setProperty(this.OBJECT,"prototype",this.OBJECT_PROTO,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT_PROTO,"constructor",this.OBJECT,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"Object",this.OBJECT,Interpreter.NONENUMERABLE_DESCRIPTOR);var i=function(n){null==n&&e.throwException(e.TYPE_ERROR,"Cannot convert '"+n+"' to object")};this.setProperty(this.OBJECT,"getOwnPropertyNames",this.createNativeFunction(function(a){return i(a),e.arrayNativeToPseudo(Object.getOwnPropertyNames(a instanceof Interpreter.Object?a.properties:a))},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"keys",this.createNativeFunction(function(a){return i(a),a instanceof Interpreter.Object&&(a=a.properties),e.arrayNativeToPseudo(Object.keys(a))},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"create",this.createNativeFunction(function(a){return null===a?e.createObjectProto(null):(a instanceof Interpreter.Object||e.throwException(e.TYPE_ERROR,"Object prototype may only be an Object or null"),e.createObjectProto(a))},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var create_ = Object.create;","Object.create = function create(proto, props) {","var obj = create_(proto);","props && Object.defineProperties(obj, props);","return obj;","};","})();",""),this.setProperty(this.OBJECT,"defineProperty",this.createNativeFunction(function(a,o,f){return o=String(o),a instanceof Interpreter.Object||e.throwException(e.TYPE_ERROR,"Object.defineProperty called on non-object"),f instanceof Interpreter.Object||e.throwException(e.TYPE_ERROR,"Property description must be an object"),!a.properties[o]&&a.preventExtensions&&e.throwException(e.TYPE_ERROR,"Can't define property '"+o+"', object is not extensible"),e.setProperty(a,o,Interpreter.VALUE_IN_DESCRIPTOR,f.properties),a},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var defineProperty_ = Object.defineProperty;","Object.defineProperty = function defineProperty(obj, prop, d1) {","var d2 = {};","if ('configurable' in d1) d2.configurable = d1.configurable;","if ('enumerable' in d1) d2.enumerable = d1.enumerable;","if ('writable' in d1) d2.writable = d1.writable;","if ('value' in d1) d2.value = d1.value;","if ('get' in d1) d2.get = d1.get;","if ('set' in d1) d2.set = d1.set;","return defineProperty_(obj, prop, d2);","};","})();","Object.defineProperty(Object, 'defineProperties',","{configurable: true, writable: true, value:","function defineProperties(obj, props) {","var keys = Object.keys(props);","for (var i = 0; i < keys.length; i++) {","Object.defineProperty(obj, keys[i], props[keys[i]]);","}","return obj;","}","});",""),this.setProperty(this.OBJECT,"getOwnPropertyDescriptor",this.createNativeFunction(function(a,o){if(a instanceof Interpreter.Object||e.throwException(e.TYPE_ERROR,"Object.getOwnPropertyDescriptor called on non-object"),(o=String(o))in a.properties){var f=Object.getOwnPropertyDescriptor(a.properties,o),s=a.getter[o],h=a.setter[o],E=e.createObjectProto(e.OBJECT_PROTO);return s||h?(e.setProperty(E,"get",s),e.setProperty(E,"set",h)):(e.setProperty(E,"value",f.value),e.setProperty(E,"writable",f.writable)),e.setProperty(E,"configurable",f.configurable),e.setProperty(E,"enumerable",f.enumerable),E}},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"getPrototypeOf",this.createNativeFunction(function(a){return i(a),e.getPrototype(a)},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"isExtensible",this.createNativeFunction(function(a){return Boolean(a)&&!a.preventExtensions},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT,"preventExtensions",this.createNativeFunction(function(a){return a instanceof Interpreter.Object&&(a.preventExtensions=!0),a},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setNativeFunctionPrototype(this.OBJECT,"toString",Interpreter.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"toLocaleString",Interpreter.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"valueOf",Interpreter.Object.prototype.valueOf),this.setNativeFunctionPrototype(this.OBJECT,"hasOwnProperty",function(a){return i(this),this instanceof Interpreter.Object?String(a)in this.properties:this.hasOwnProperty(a)}),this.setNativeFunctionPrototype(this.OBJECT,"propertyIsEnumerable",function(a){return i(this),this instanceof Interpreter.Object?Object.prototype.propertyIsEnumerable.call(this.properties,a):this.propertyIsEnumerable(a)}),this.setNativeFunctionPrototype(this.OBJECT,"isPrototypeOf",function(a){for(;;){if(!(a=e.getPrototype(a)))return!1;if(a===this)return!0}})},Interpreter.prototype.initArray=function(t){var r,e=this;r=function(n){if(e.calledWithNew())var a=this;else a=e.createArray();var o=arguments[0];if(1===arguments.length&&"number"==typeof o)isNaN(Interpreter.legalArrayLength(o))&&e.throwException(e.RANGE_ERROR,"Invalid array length"),a.properties.length=o;else{for(var f=0;f<arguments.length;f++)a.properties[f]=arguments[f];a.properties.length=f}return a},this.ARRAY=this.createNativeFunction(r,!0),this.ARRAY_PROTO=this.ARRAY.properties.prototype,this.setProperty(t,"Array",this.ARRAY,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ARRAY,"isArray",this.createNativeFunction(r=function(n){return n&&"Array"===n.class},!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ARRAY_PROTO,"length",0,{configurable:!1,enumerable:!1,writable:!0}),this.ARRAY_PROTO.class="Array",this.polyfills_.push("(function() {","function createArrayMethod_(f) {","Object.defineProperty(Array.prototype, f.name,","{configurable: true, writable: true, value: f});","}","createArrayMethod_(","function pop() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","len--;","var x = o[len];","delete o[len];","o.length = len;","return x;","}",");","createArrayMethod_(","function push(var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","for (var i = 0; i < arguments.length; i++) {","o[len] = arguments[i];","len++;","}","o.length = len;","return len;","}",");","createArrayMethod_(","function shift() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","var value = o[0];","for (var i = 0; i < len - 1; i++) {","if ((i + 1) in o) {","o[i] = o[i + 1];","} else {","delete o[i];","}","}","delete o[i];","o.length = len - 1;","return value;","}",");","createArrayMethod_(","function unshift(var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","len = 0;","}","for (var i = len - 1; i >= 0; i--) {","if (i in o) {","o[i + arguments.length] = o[i];","} else {","delete o[i + arguments.length];","}","}","for (var i = 0; i < arguments.length; i++) {","o[i] = arguments[i];","}","return (o.length = len + arguments.length);","}",");","createArrayMethod_(","function reverse() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 2) {","return o;","}","for (var i = 0; i < len / 2 - 0.5; i++) {","var x = o[i];","var hasX = i in o;","if ((len - i - 1) in o) {","o[i] = o[len - i - 1];","} else {","delete o[i];","}","if (hasX) {","o[len - i - 1] = x;","} else {","delete o[len - i - 1];","}","}","return o;","}",");","createArrayMethod_(","function indexOf(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var n = fromIndex | 0;","if (!len || n >= len) {","return -1;","}","var i = Math.max(n >= 0 ? n : len - Math.abs(n), 0);","while (i < len) {","if (i in o && o[i] === searchElement) {","return i;","}","i++;","}","return -1;","}",");","createArrayMethod_(","function lastIndexOf(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len) {","return -1;","}","var n = len - 1;","if (arguments.length > 1) {","n = fromIndex | 0;","if (n) {","n = (n > 0 || -1) * Math.floor(Math.abs(n));","}","}","var i = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);","while (i >= 0) {","if (i in o && o[i] === searchElement) {","return i;","}","i--;","}","return -1;","}",");","createArrayMethod_(","function slice(start, end) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","start |= 0;","start = (start >= 0) ? start : Math.max(0, len + start);","if (typeof end !== 'undefined') {","if (end !== Infinity) {","end |= 0;","}","if (end < 0) {","end = len + end;","} else {","end = Math.min(end, len);","}","} else {","end = len;","}","var size = end - start;","var cloned = new Array(size);","for (var i = 0; i < size; i++) {","if ((start + i) in o) {","cloned[i] = o[start + i];","}","}","return cloned;","}",");","createArrayMethod_(","function splice(start, deleteCount, var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","start |= 0;","if (start < 0) {","start = Math.max(len + start, 0);","} else {","start = Math.min(start, len);","}","if (arguments.length < 1) {","deleteCount = len - start;","} else {","deleteCount |= 0;","deleteCount = Math.max(0, Math.min(deleteCount, len - start));","}","var removed = [];","for (var i = start; i < start + deleteCount; i++) {","if (i in o) {","removed.push(o[i]);","} else {","removed.length++;","}","if ((i + deleteCount) in o) {","o[i] = o[i + deleteCount];","} else {","delete o[i];","}","}","for (var i = start + deleteCount; i < len - deleteCount; i++) {","if ((i + deleteCount) in o) {","o[i] = o[i + deleteCount];","} else {","delete o[i];","}","}","for (var i = len - deleteCount; i < len; i++) {","delete o[i];","}","len -= deleteCount;","var arl = arguments.length - 2;","for (var i = len - 1; i >= start; i--) {","if (i in o) {","o[i + arl] = o[i];","} else {","delete o[i + arl];","}","}","len += arl;","for (var i = 2; i < arguments.length; i++) {","o[start + i - 2] = arguments[i];","}","o.length = len;","return removed;","}",");","createArrayMethod_(","function concat(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var cloned = [];","for (var i = -1; i < arguments.length; i++) {","var value = (i === -1) ? o : arguments[i];","if (Array.isArray(value)) {","for (var j = 0, l = value.length; j < l; j++) {","if (j in value) {","cloned.push(value[j]);","} else {","cloned.length++;","}","}","} else {","cloned.push(value);","}","}","return cloned;","}",");","createArrayMethod_(","function join(opt_separator) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var sep = typeof opt_separator === 'undefined' ?","',' : ('' + opt_separator);","var str = '';","for (var i = 0; i < len; i++) {","if (i && sep) {","str += sep;","}","str += (o[i] === null || o[i] === undefined) ? '' : o[i];","}","return str;","}",");","createArrayMethod_(","function every(callbackfn, thisArg) {","if (!this || typeof callbackfn !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","while (k < len) {","if (k in o && !callbackfn.call(t, o[k], k, o)) return false;","k++;","}","return true;","}",");","createArrayMethod_(","function filter(fun, var_args) {","if (this === void 0 || this === null || typeof fun !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var res = [];","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o) {","var val = o[i];","if (fun.call(thisArg, val, i, o)) res.push(val);","}","}","return res;","}",");","createArrayMethod_(","function forEach(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","while (k < len) {","if (k in o) callback.call(t, o[k], k, o);","k++;","}","}",");","createArrayMethod_(","function map(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","var a = new Array(len);","while (k < len) {","if (k in o) a[k] = callback.call(t, o[k], k, o);","k++;","}","return a;","}",");","createArrayMethod_(","function reduce(callback /*, initialValue*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var k = 0, value;","if (arguments.length === 2) {","value = arguments[1];","} else {","while (k < len && !(k in o)) k++;","if (k >= len) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k++];","}","for (; k < len; k++) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}",");","createArrayMethod_(","function reduceRight(callback /*, initialValue*/) {","if (null === this || 'undefined' === typeof this || 'function' !== typeof callback) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var k = len - 1, value;","if (arguments.length >= 2) {","value = arguments[1];","} else {","while (k >= 0 && !(k in o)) k--;","if (k < 0) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k--];","}","for (; k >= 0; k--) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}",");","createArrayMethod_(","function some(fun/*, thisArg*/) {","if (!this || typeof fun !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o && fun.call(thisArg, o[i], i, o)) {","return true;","}","}","return false;","}",");","createArrayMethod_(","function sort(opt_comp) {","if (!this) throw TypeError();","if (typeof opt_comp !== 'function') {","opt_comp = undefined;","}","for (var i = 0; i < this.length; i++) {","var changes = 0;","for (var j = 0; j < this.length - i - 1; j++) {","if (opt_comp ? (opt_comp(this[j], this[j + 1]) > 0) :","(String(this[j]) > String(this[j + 1]))) {","var swap = this[j];","var hasSwap = j in this;","if ((j + 1) in this) {","this[j] = this[j + 1];","} else {","delete this[j];","}","if (hasSwap) {","this[j + 1] = swap;","} else {","delete this[j + 1];","}","changes++;","}","}","if (!changes) break;","}","return this;","}",");","createArrayMethod_(","function toLocaleString() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var out = [];","for (var i = 0; i < len; i++) {","out[i] = (o[i] === null || o[i] === undefined) ? '' : o[i].toLocaleString();","}","return out.join(',');","}",");","})();","")},Interpreter.prototype.initString=function(t){var r,e=this;r=function(o){return o=arguments.length?Interpreter.nativeGlobal.String(o):"",e.calledWithNew()?(this.data=o,this):o},this.STRING=this.createNativeFunction(r,!0),this.setProperty(t,"String",this.STRING,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.STRING,"fromCharCode",this.createNativeFunction(String.fromCharCode,!1),Interpreter.NONENUMERABLE_DESCRIPTOR);for(var i=["charAt","charCodeAt","concat","indexOf","lastIndexOf","slice","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim"],n=0;n<i.length;n++)this.setNativeFunctionPrototype(this.STRING,i[n],String.prototype[i[n]]);this.setNativeFunctionPrototype(this.STRING,"localeCompare",r=function(o,f,s){f=e.pseudoToNative(f),s=e.pseudoToNative(s);try{return String(this).localeCompare(o,f,s)}catch(h){e.throwException(e.ERROR,"localeCompare: "+h.message)}}),this.setAsyncFunctionPrototype(this.STRING,"split",r=function(o,f,s){var h=String(this);if(f=f?Number(f):void 0,e.isa(o,e.REGEXP)&&(e.maybeThrowRegExp(o=o.data,s),2===e.REGEXP_MODE))if(Interpreter.vm)(_=e.vmCall("string.split(separator, limit)",{string:h,separator:o,limit:f},o,s))!==Interpreter.REGEXP_TIMEOUT&&s(e.arrayNativeToPseudo(_));else{var N=e.createWorker(),d=e.regExpTimeout(o,N,s);N.onmessage=function(S){clearTimeout(d),s(e.arrayNativeToPseudo(S.data))},N.postMessage(["split",h,o,f])}else{var _=h.split(o,f);s(e.arrayNativeToPseudo(_))}}),this.setAsyncFunctionPrototype(this.STRING,"match",r=function(o,f){var s=String(this);if(o=e.isa(o,e.REGEXP)?o.data:new RegExp(o),e.maybeThrowRegExp(o,f),2!==e.REGEXP_MODE)d=s.match(o),f(d&&e.arrayNativeToPseudo(d));else if(Interpreter.vm){var d;(d=e.vmCall("string.match(regexp)",{string:s,regexp:o},o,f))!==Interpreter.REGEXP_TIMEOUT&&f(d&&e.arrayNativeToPseudo(d))}else{var O=e.createWorker(),N=e.regExpTimeout(o,O,f);O.onmessage=function(_){clearTimeout(N),f(_.data&&e.arrayNativeToPseudo(_.data))},O.postMessage(["match",s,o])}}),this.setAsyncFunctionPrototype(this.STRING,"search",r=function(o,f){var s=String(this);if(o=e.isa(o,e.REGEXP)?o.data:new RegExp(o),e.maybeThrowRegExp(o,f),2!==e.REGEXP_MODE)f(s.search(o));else if(Interpreter.vm){var O=e.vmCall("string.search(regexp)",{string:s,regexp:o},o,f);O!==Interpreter.REGEXP_TIMEOUT&&f(O)}else{var N=e.createWorker(),d=e.regExpTimeout(o,N,f);N.onmessage=function(_){clearTimeout(d),f(_.data)},N.postMessage(["search",s,o])}}),this.setAsyncFunctionPrototype(this.STRING,"replace",r=function(o,f,s){var h=String(this);if(f=String(f),e.isa(o,e.REGEXP)&&(e.maybeThrowRegExp(o=o.data,s),2===e.REGEXP_MODE))if(Interpreter.vm){var N=e.vmCall("string.replace(substr, newSubstr)",{string:h,substr:o,newSubstr:f},o,s);N!==Interpreter.REGEXP_TIMEOUT&&s(N)}else{var d=e.createWorker(),_=e.regExpTimeout(o,d,s);d.onmessage=function(S){clearTimeout(_),s(S.data)},d.postMessage(["replace",h,o,f])}else s(h.replace(o,f))}),this.polyfills_.push("(function() {","var replace_ = String.prototype.replace;","String.prototype.replace = function replace(substr, newSubstr) {","if (typeof newSubstr !== 'function') {","return replace_.call(this, substr, newSubstr);","}","var str = this;","if (substr instanceof RegExp) {","var subs = [];","var m = substr.exec(str);","while (m) {","m.push(m.index, str);","var inject = newSubstr.apply(null, m);","subs.push([m.index, m[0].length, inject]);","m = substr.global ? substr.exec(str) : null;","}","for (var i = subs.length - 1; i >= 0; i--) {","str = str.substring(0, subs[i][0]) + subs[i][2] + str.substring(subs[i][0] + subs[i][1]);","}","} else {","var i = str.indexOf(substr);","if (i !== -1) {","var inject = newSubstr(str.substr(i, substr.length), i, str);","str = str.substring(0, i) + inject + str.substring(i + substr.length);","}","}","return str;","};","})();","")},Interpreter.prototype.initBoolean=function(t){var e=this;this.BOOLEAN=this.createNativeFunction(function(n){return n=Interpreter.nativeGlobal.Boolean(n),e.calledWithNew()?(this.data=n,this):n},!0),this.setProperty(t,"Boolean",this.BOOLEAN,Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.initNumber=function(t){var r,e=this;r=function(o){return o=arguments.length?Interpreter.nativeGlobal.Number(o):0,e.calledWithNew()?(this.data=o,this):o},this.NUMBER=this.createNativeFunction(r,!0),this.setProperty(t,"Number",this.NUMBER,Interpreter.NONENUMERABLE_DESCRIPTOR);for(var i=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],n=0;n<i.length;n++)this.setProperty(this.NUMBER,i[n],Number[i[n]],Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);this.setNativeFunctionPrototype(this.NUMBER,"toExponential",r=function(o){try{return Number(this).toExponential(o)}catch(f){e.throwException(e.ERROR,f.message)}}),this.setNativeFunctionPrototype(this.NUMBER,"toFixed",r=function(o){try{return Number(this).toFixed(o)}catch(f){e.throwException(e.ERROR,f.message)}}),this.setNativeFunctionPrototype(this.NUMBER,"toPrecision",r=function(o){try{return Number(this).toPrecision(o)}catch(f){e.throwException(e.ERROR,f.message)}}),this.setNativeFunctionPrototype(this.NUMBER,"toString",r=function(o){try{return Number(this).toString(o)}catch(f){e.throwException(e.ERROR,f.message)}}),this.setNativeFunctionPrototype(this.NUMBER,"toLocaleString",r=function(o,f){return o=o?e.pseudoToNative(o):void 0,f=f?e.pseudoToNative(f):void 0,Number(this).toLocaleString(o,f)})},Interpreter.prototype.initDate=function(t){var r,e=this;r=function(o,f){if(!e.calledWithNew())return Interpreter.nativeGlobal.Date();var s=[null].concat(Array.from(arguments));return this.data=new(Function.prototype.bind.apply(Interpreter.nativeGlobal.Date,s)),this},this.DATE=this.createNativeFunction(r,!0),this.DATE_PROTO=this.DATE.properties.prototype,this.setProperty(t,"Date",this.DATE,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"now",this.createNativeFunction(Date.now,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"parse",this.createNativeFunction(Date.parse,!1),Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"UTC",this.createNativeFunction(Date.UTC,!1),Interpreter.NONENUMERABLE_DESCRIPTOR);for(var i=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toISOString","toJSON","toGMTString","toLocaleDateString","toLocaleString","toLocaleTimeString","toTimeString","toUTCString"],n=0;n<i.length;n++)r=function(a){return function(o){var f=this.data;f instanceof Date||e.throwException(e.TYPE_ERROR,a+" not called on a Date");for(var s=[],h=0;h<arguments.length;h++)s[h]=e.pseudoToNative(arguments[h]);return f[a].apply(f,s)}}(i[n]),this.setNativeFunctionPrototype(this.DATE,i[n],r)},Interpreter.prototype.initRegExp=function(t){var e=this;this.REGEXP=this.createNativeFunction(function(n,a){if(e.calledWithNew())var o=this;else{if(void 0===a&&e.isa(n,e.REGEXP))return n;o=e.createObjectProto(e.REGEXP_PROTO)}n=void 0===n?"":String(n),a=a?String(a):"",/^[gmi]*$/.test(a)||e.throwException(e.SYNTAX_ERROR,"Invalid regexp flag");try{var f=new Interpreter.nativeGlobal.RegExp(n,a)}catch(s){e.throwException(e.SYNTAX_ERROR,s.message)}return e.populateRegExp(o,f),o},!0),this.REGEXP_PROTO=this.REGEXP.properties.prototype,this.setProperty(t,"RegExp",this.REGEXP,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"global",void 0,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"ignoreCase",void 0,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"multiline",void 0,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"source","(?:)",Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("Object.defineProperty(RegExp.prototype, 'test',","{configurable: true, writable: true, value:","function test(str) {","return !!this.exec(str);","}","});"),this.setAsyncFunctionPrototype(this.REGEXP,"exec",function(n,a){var o=this.data;if(n=String(n),o.lastIndex=Number(e.getProperty(this,"lastIndex")),e.maybeThrowRegExp(o,a),2!==e.REGEXP_MODE)N=o.exec(n),e.setProperty(this,"lastIndex",o.lastIndex),a(d(N));else if(Interpreter.vm){var N;(N=e.vmCall("regexp.exec(string)",{string:n,regexp:o},o,a))!==Interpreter.REGEXP_TIMEOUT&&(e.setProperty(this,"lastIndex",o.lastIndex),a(d(N)))}else{var h=e.createWorker(),E=e.regExpTimeout(o,h,a),O=this;h.onmessage=function(_){clearTimeout(E),e.setProperty(O,"lastIndex",_.data[1]),a(d(_.data[0]))},h.postMessage(["exec",o,o.lastIndex,n])}function d(_){if(_){var S=e.arrayNativeToPseudo(_);return e.setProperty(S,"index",_.index),e.setProperty(S,"input",_.input),S}return null}})},Interpreter.prototype.initError=function(t){var e=this;this.ERROR=this.createNativeFunction(function(n){if(e.calledWithNew())var a=this;else a=e.createObject(e.ERROR);return e.populateError(a,n),a},!0),this.setProperty(t,"Error",this.ERROR,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"message","",Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"name","Error",Interpreter.NONENUMERABLE_DESCRIPTOR);var r=function(i){var n=e.createNativeFunction(function(a){if(e.calledWithNew())var o=this;else o=e.createObject(n);return e.populateError(o,a),o},!0);return e.setProperty(n,"prototype",e.createObject(e.ERROR),Interpreter.NONENUMERABLE_DESCRIPTOR),e.setProperty(n.properties.prototype,"name",i,Interpreter.NONENUMERABLE_DESCRIPTOR),e.setProperty(t,i,n,Interpreter.NONENUMERABLE_DESCRIPTOR),n};this.EVAL_ERROR=r("EvalError"),this.RANGE_ERROR=r("RangeError"),this.REFERENCE_ERROR=r("ReferenceError"),this.SYNTAX_ERROR=r("SyntaxError"),this.TYPE_ERROR=r("TypeError"),this.URI_ERROR=r("URIError")},Interpreter.prototype.initMath=function(t){var e=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(t,"Math",e,Interpreter.NONENUMERABLE_DESCRIPTOR);for(var r=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],i=0;i<r.length;i++)this.setProperty(e,r[i],Math[r[i]],Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);var n=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"];for(i=0;i<n.length;i++)this.setProperty(e,n[i],this.createNativeFunction(Math[n[i]],!1),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.initJSON=function(t){var e=this,r=e.createObjectProto(this.OBJECT_PROTO);this.setProperty(t,"JSON",r,Interpreter.NONENUMERABLE_DESCRIPTOR);var i=function(a){try{var o=JSON.parse(String(a))}catch(f){e.throwException(e.SYNTAX_ERROR,f.message)}return e.nativeToPseudo(o)};this.setProperty(r,"parse",this.createNativeFunction(i,!1)),this.setProperty(r,"stringify",this.createNativeFunction(i=function(a,o,f){o&&"Function"===o.class?e.throwException(e.TYPE_ERROR,"Function replacer on JSON.stringify not supported"):o=o&&"Array"===o.class?(o=e.arrayPseudoToNative(o)).filter(function(E){return"string"==typeof E||"number"==typeof E}):null,"string"!=typeof f&&"number"!=typeof f&&(f=void 0);var s=e.pseudoToNative(a);try{var h=JSON.stringify(s,o,f)}catch(E){e.throwException(e.TYPE_ERROR,E.message)}return h},!1))},Interpreter.prototype.isa=function(t,e){if(null==t||!e)return!1;var r=e.properties.prototype;if(t===r)return!0;for(t=this.getPrototype(t);t;){if(t===r)return!0;t=t.proto}return!1},Interpreter.prototype.populateRegExp=function(t,e){t.data=new RegExp(e.source,e.flags),this.setProperty(t,"lastIndex",e.lastIndex,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"source",e.source,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"global",e.global,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"ignoreCase",e.ignoreCase,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"multiline",e.multiline,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.populateError=function(t,e){e&&this.setProperty(t,"message",String(e),Interpreter.NONENUMERABLE_DESCRIPTOR);for(var r=[],i=this.stateStack.length-1;i>=0;i--){var n=this.stateStack[i],a=n.node;if("CallExpression"===a.type){var o=n.func_;o&&r.length&&(r[r.length-1].datumName=this.getProperty(o,"name"))}a.loc&&(!r.length||"CallExpression"===a.type)&&r.push({datumLoc:a.loc})}var h=String(this.getProperty(t,"name"))+": "+String(this.getProperty(t,"message"))+"\n";for(i=0;i<r.length;i++){var E=r[i].datumLoc,O=r[i].datumName,N=E.source+":"+E.start.line+":"+E.start.column;h+=O?"  at "+O+" ("+N+")\n":"  at "+N+"\n"}this.setProperty(t,"stack",h.trim(),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.createWorker=function(){var t=this.createWorker.blob_;return t||(t=new Blob([Interpreter.WORKER_CODE.join("\n")],{type:"application/javascript"}),this.createWorker.blob_=t),new Worker(URL.createObjectURL(t))},Interpreter.prototype.vmCall=function(t,e,r,i){var n={timeout:this.REGEXP_THREAD_TIMEOUT};try{return Interpreter.vm.runInNewContext(t,e,n)}catch{i(null),this.throwException(this.ERROR,"RegExp Timeout: "+r)}return Interpreter.REGEXP_TIMEOUT},Interpreter.prototype.maybeThrowRegExp=function(t,e){var r;if(0===this.REGEXP_MODE)r=!1;else if(1===this.REGEXP_MODE)r=!0;else if(Interpreter.vm)r=!0;else if("function"==typeof Worker&&"function"==typeof URL)r=!0;else if("function"==typeof require){try{Interpreter.vm=require("vm")}catch{}r=!!Interpreter.vm}else r=!1;r||(e(null),this.throwException(this.ERROR,"Regular expressions not supported: "+t))},Interpreter.prototype.regExpTimeout=function(t,e,r){var i=this;return setTimeout(function(){e.terminate(),r(null);try{i.throwException(i.ERROR,"RegExp Timeout: "+t)}catch{}},this.REGEXP_THREAD_TIMEOUT)},Interpreter.prototype.createObject=function(t){return this.createObjectProto(t&&t.properties.prototype)},Interpreter.prototype.createObjectProto=function(t){if("object"!=typeof t)throw Error("Non object prototype");var e=new Interpreter.Object(t);return this.isa(e,this.ERROR)&&(e.class="Error"),e},Interpreter.prototype.createArray=function(){var t=this.createObjectProto(this.ARRAY_PROTO);return this.setProperty(t,"length",0,{configurable:!1,enumerable:!1,writable:!0}),t.class="Array",t},Interpreter.prototype.createFunctionBase_=function(t,e){var r=this.createObjectProto(this.FUNCTION_PROTO);if(e){var i=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(r,"prototype",i,Interpreter.NONENUMERABLE_DESCRIPTOR),this.setProperty(i,"constructor",r,Interpreter.NONENUMERABLE_DESCRIPTOR)}else r.illegalConstructor=!0;return this.setProperty(r,"length",t,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),r.class="Function",r},Interpreter.prototype.createFunction=function(t,e,r){var i=this.createFunctionBase_(t.params.length,!0);i.parentScope=e,i.node=t;var n=t.id?String(t.id.name):r||"";return this.setProperty(i,"name",n,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),i},Interpreter.prototype.createNativeFunction=function(t,e){var r=this.createFunctionBase_(t.length,e);return r.nativeFunc=t,t.id=this.functionCounter_++,this.setProperty(r,"name",t.name,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),r},Interpreter.prototype.createAsyncFunction=function(t){var e=this.createFunctionBase_(t.length,!0);return e.asyncFunc=t,t.id=this.functionCounter_++,this.setProperty(e,"name",t.name,Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR),e},Interpreter.prototype.nativeToPseudo=function(t){if(t instanceof Interpreter.Object)throw Error("Object is already pseudo");if("object"!=typeof t&&"function"!=typeof t||null===t)return t;if(t instanceof RegExp){var e=this.createObjectProto(this.REGEXP_PROTO);return this.populateRegExp(e,t),e}if(t instanceof Date){var r=this.createObjectProto(this.DATE_PROTO);return r.data=new Date(t.valueOf()),r}if("function"==typeof t){var i=this,a=Object.getOwnPropertyDescriptor(t,"prototype");return this.createNativeFunction(function(){var E=Array.prototype.slice.call(arguments).map(function(N){return i.pseudoToNative(N)}),O=t.apply(i,E);return i.nativeToPseudo(O)},!!a)}if(Array.isArray(t)){for(var o=this.createArray(),f=0;f<t.length;f++)f in t&&this.setProperty(o,f,this.nativeToPseudo(t[f]));return o}var s=this.createObjectProto(this.OBJECT_PROTO);for(var h in t)this.setProperty(s,h,this.nativeToPseudo(t[h]));return s},Interpreter.prototype.pseudoToNative=function(t,e){if("object"!=typeof t&&"function"!=typeof t||null===t)return t;if(!(t instanceof Interpreter.Object))throw Error("Object is not pseudo");if(this.isa(t,this.REGEXP)){var r=new RegExp(t.data.source,t.data.flags);return r.lastIndex=t.data.lastIndex,r}if(this.isa(t,this.DATE))return new Date(t.data.valueOf());var a,i=e||{pseudo:[],native:[]},n=i.pseudo.indexOf(t);if(-1!==n)return i.native[n];if(i.pseudo.push(t),this.isa(t,this.ARRAY)){i.native.push(a=[]);for(var o=this.getProperty(t,"length"),f=0;f<o;f++)this.hasProperty(t,f)&&(a[f]=this.pseudoToNative(this.getProperty(t,f),i))}else{var s;for(var h in i.native.push(a={}),t.properties)s=this.pseudoToNative(t.properties[h],i),Object.defineProperty(a,h,{value:s,writable:!0,enumerable:!0,configurable:!0})}return i.pseudo.pop(),i.native.pop(),a},Interpreter.prototype.arrayNativeToPseudo=function(t){for(var e=this.createArray(),r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++)this.setProperty(e,r[i],t[r[i]]);return e},Interpreter.prototype.arrayPseudoToNative=function(t){var e=[];for(var r in t.properties)e[r]=this.getProperty(t,r);return e.length=Interpreter.legalArrayLength(this.getProperty(t,"length"))||0,e},Interpreter.prototype.getPrototype=function(t){switch(typeof t){case"number":return this.NUMBER.properties.prototype;case"boolean":return this.BOOLEAN.properties.prototype;case"string":return this.STRING.properties.prototype}return t?t.proto:null},Interpreter.prototype.getProperty=function(t,e){if(this.getterStep_)throw Error("Getter not supported in that context");if(e=String(e),null==t&&this.throwException(this.TYPE_ERROR,"Cannot read property '"+e+"' of "+t),"object"==typeof t&&!(t instanceof Interpreter.Object))throw TypeError("Expecting native value or pseudo object");if("length"===e){if(this.isa(t,this.STRING))return String(t).length}else if(e.charCodeAt(0)<64&&this.isa(t,this.STRING)){var r=Interpreter.legalArrayIndex(e);if(!isNaN(r)&&r<String(t).length)return String(t)[r]}do{if(t.properties&&e in t.properties){var i=t.getter[e];return i?(this.getterStep_=!0,i):t.properties[e]}}while(t=this.getPrototype(t))},Interpreter.prototype.hasProperty=function(t,e){if(!(t instanceof Interpreter.Object))throw TypeError("Primitive data type has no properties");if("length"===(e=String(e))&&this.isa(t,this.STRING))return!0;if(this.isa(t,this.STRING)){var r=Interpreter.legalArrayIndex(e);if(!isNaN(r)&&r<String(t).length)return!0}do{if(t.properties&&e in t.properties)return!0}while(t=this.getPrototype(t));return!1},Interpreter.prototype.setProperty=function(t,e,r,i){if(this.setterStep_)throw Error("Setter not supported in that context");if(e=String(e),null==t&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+e+"' of "+t),"object"==typeof t&&!(t instanceof Interpreter.Object))throw TypeError("Expecting native value or pseudo object");i&&("get"in i||"set"in i)&&("value"in i||"writable"in i)&&this.throwException(this.TYPE_ERROR,"Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");var n=!this.stateStack||this.getScope().strict;if(t instanceof Interpreter.Object){if(this.isa(t,this.STRING)){var a=Interpreter.legalArrayIndex(e);if("length"===e||!isNaN(a)&&a<String(t).length)return void(n&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+e+"' of String '"+t.data+"'"))}if("Array"===t.class){var f,o=t.properties.length;if("length"===e){if(i){if(!("value"in i))return;r=i.value}if(r=Interpreter.legalArrayLength(r),isNaN(r)&&this.throwException(this.RANGE_ERROR,"Invalid array length"),r<o)for(f in t.properties)f=Interpreter.legalArrayIndex(f),!isNaN(f)&&r<=f&&delete t.properties[f]}else isNaN(f=Interpreter.legalArrayIndex(e))||(t.properties.length=Math.max(o,f+1))}if(!t.preventExtensions||e in t.properties)if(i){var s={};"get"in i&&i.get&&(t.getter[e]=i.get,s.get=this.setProperty.placeholderGet_),"set"in i&&i.set&&(t.setter[e]=i.set,s.set=this.setProperty.placeholderSet_),"configurable"in i&&(s.configurable=i.configurable),"enumerable"in i&&(s.enumerable=i.enumerable),"writable"in i&&(s.writable=i.writable,delete t.getter[e],delete t.setter[e]),"value"in i?(s.value=i.value,delete t.getter[e],delete t.setter[e]):r!==Interpreter.VALUE_IN_DESCRIPTOR&&(s.value=r,delete t.getter[e],delete t.setter[e]);try{Object.defineProperty(t.properties,e,s)}catch{this.throwException(this.TYPE_ERROR,"Cannot redefine property: "+e)}"get"in i&&!i.get&&delete t.getter[e],"set"in i&&!i.set&&delete t.setter[e]}else{if(r===Interpreter.VALUE_IN_DESCRIPTOR)throw ReferenceError("Value not specified");for(var h=t;!(e in h.properties);)if(!(h=this.getPrototype(h))){h=t;break}if(h.setter&&h.setter[e])return this.setterStep_=!0,h.setter[e];if(h.getter&&h.getter[e])n&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+e+"' of object '"+t+"' which only has a getter");else try{t.properties[e]=r}catch{n&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+e+"' of object '"+t+"'")}}else n&&this.throwException(this.TYPE_ERROR,"Can't add property '"+e+"', object is not extensible")}else n&&this.throwException(this.TYPE_ERROR,"Can't create property '"+e+"' on '"+t+"'")},Interpreter.prototype.setProperty.placeholderGet_=function(){throw Error("Placeholder getter")},Interpreter.prototype.setProperty.placeholderSet_=function(){throw Error("Placeholder setter")},Interpreter.prototype.setNativeFunctionPrototype=function(t,e,r){this.setProperty(t.properties.prototype,e,this.createNativeFunction(r,!1),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.setAsyncFunctionPrototype=function(t,e,r){this.setProperty(t.properties.prototype,e,this.createAsyncFunction(r),Interpreter.NONENUMERABLE_DESCRIPTOR)},Interpreter.prototype.getScope=function(){var t=this.stateStack[this.stateStack.length-1].scope;if(!t)throw Error("No scope found");return t},Interpreter.prototype.createScope=function(t,e){var r=!1;if(e&&e.strict)r=!0;else{var i=t.body&&t.body[0];i&&i.expression&&"Literal"===i.expression.type&&"use strict"===i.expression.value&&(r=!0)}var n=this.createObjectProto(null),a=new Interpreter.Scope(e,r,n);return e||this.initGlobal(a.object),this.populateScope_(t,a),a},Interpreter.prototype.createSpecialScope=function(t,e){if(!t)throw Error("parentScope required");var r=e||this.createObjectProto(null);return new Interpreter.Scope(t,t.strict,r)},Interpreter.prototype.getValueFromScope=function(t){for(var e=this.getScope();e&&e!==this.globalScope;){if(t in e.object.properties)return e.object.properties[t];e=e.parentScope}if(e===this.globalScope&&this.hasProperty(e.object,t))return this.getProperty(e.object,t);var r=this.stateStack[this.stateStack.length-1].node;"UnaryExpression"===r.type&&"typeof"===r.operator||this.throwException(this.REFERENCE_ERROR,t+" is not defined")},Interpreter.prototype.setValueToScope=function(t,e){for(var r=this.getScope(),i=r.strict;r&&r!==this.globalScope;){if(t in r.object.properties)return void(r.object.properties[t]=e);r=r.parentScope}if(r===this.globalScope&&(!i||this.hasProperty(r.object,t)))return this.setProperty(r.object,t,e);this.throwException(this.REFERENCE_ERROR,t+" is not defined")},Interpreter.prototype.populateScope_=function(t,e){var r;if(t.variableCache_)r=t.variableCache_;else{switch(r=Object.create(null),t.type){case"VariableDeclaration":for(var i=0;i<t.declarations.length;i++)r[t.declarations[i].id.name]=!0;break;case"FunctionDeclaration":r[t.id.name]=t;break;case"BlockStatement":case"CatchClause":case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"Program":case"SwitchCase":case"SwitchStatement":case"TryStatement":case"WithStatement":case"WhileStatement":var n=t.constructor;for(var a in t)if("loc"!==a){var f,o=t[a];if(o&&"object"==typeof o)if(Array.isArray(o)){for(i=0;i<o.length;i++)if(o[i]&&o[i].constructor===n)for(var a in f=this.populateScope_(o[i],e))r[a]=f[a]}else if(o.constructor===n)for(var a in f=this.populateScope_(o,e))r[a]=f[a]}}t.variableCache_=r}for(var a in r)this.setProperty(e.object,a,!0===r[a]?void 0:this.createFunction(r[a],e),Interpreter.VARIABLE_DESCRIPTOR);return r},Interpreter.prototype.calledWithNew=function(){return this.stateStack[this.stateStack.length-1].isConstructor},Interpreter.prototype.getValue=function(t){return t[0]===Interpreter.SCOPE_REFERENCE?this.getValueFromScope(t[1]):this.getProperty(t[0],t[1])},Interpreter.prototype.setValue=function(t,e){return t[0]===Interpreter.SCOPE_REFERENCE?this.setValueToScope(t[1],e):this.setProperty(t[0],t[1],e)},Interpreter.prototype.throwException=function(t,e){if(!this.globalScope)throw void 0===e?t:e;if(void 0===e)var r=t;else r=this.createObject(t),this.populateError(r,e);throw this.unwind(Interpreter.Completion.THROW,r,void 0),Interpreter.STEP_ERROR},Interpreter.prototype.unwind=function(t,e,r){if(t===Interpreter.Completion.NORMAL)throw TypeError("Should not unwind for NORMAL completions");e:for(var i=this.stateStack;i.length>0;i.pop()){var n=i[i.length-1];switch(n.node.type){case"TryStatement":return void(n.cv={type:t,value:e,label:r});case"CallExpression":case"NewExpression":if(t===Interpreter.Completion.RETURN)return void(n.value=e);if(t!==Interpreter.Completion.THROW)throw Error("Unsynatctic break/continue not rejected by Acorn");break;case"Program":n.done=!0;break e}if(t===Interpreter.Completion.BREAK){if(r?n.labels&&-1!==n.labels.indexOf(r):n.isLoop||n.isSwitch)return void i.pop()}else if(t===Interpreter.Completion.CONTINUE&&(r?n.labels&&-1!==n.labels.indexOf(r):n.isLoop))return}var a;if(this.isa(e,this.ERROR)){var o={EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},f=String(this.getProperty(e,"name")),s=this.getProperty(e,"message").valueOf();(a=(o[f]||Error)(s)).stack=String(this.getProperty(e,"stack"))}else a=String(e);throw this.value=a,a},Interpreter.prototype.createGetter_=function(t,e){if(!this.getterStep_)throw Error("Unexpected call to createGetter");this.getterStep_=!1;var r=Array.isArray(e)?e[0]:e,i=new this.newNode;i.type="CallExpression";var n=new Interpreter.State(i,this.stateStack[this.stateStack.length-1].scope);return n.doneCallee_=2,n.funcThis_=r,n.func_=t,n.doneArgs_=!0,n.arguments_=[],n},Interpreter.prototype.createSetter_=function(t,e,r){if(!this.setterStep_)throw Error("Unexpected call to createSetter");this.setterStep_=!1;var i=Array.isArray(e)?e[0]:this.globalObject,n=new this.newNode;n.type="CallExpression";var a=new Interpreter.State(n,this.stateStack[this.stateStack.length-1].scope);return a.doneCallee_=2,a.funcThis_=i,a.func_=t,a.doneArgs_=!0,a.arguments_=[r],a},Interpreter.prototype.boxThis_=function(t){if(null==t)return this.globalObject;if(!(t instanceof Interpreter.Object)){var e=this.createObjectProto(this.getPrototype(t));return e.data=t,e}return t},Interpreter.prototype.getGlobalScope=function(){return this.globalScope},Interpreter.prototype.getStateStack=function(){return this.stateStack},Interpreter.prototype.setStateStack=function(t){this.stateStack=t},Interpreter.State=function(t,e){this.node=t,this.scope=e},Interpreter.Scope=function(t,e,r){this.parentScope=t,this.strict=e,this.object=r},Interpreter.Object=function(t){this.getter=Object.create(null),this.setter=Object.create(null),this.properties=Object.create(null),this.proto=t},Interpreter.Object.prototype.proto=null,Interpreter.Object.prototype.class="Object",Interpreter.Object.prototype.data=null,Interpreter.Object.prototype.toString=function(){if(!Interpreter.currentInterpreter_)return"[object Interpreter.Object]";if(!(this instanceof Interpreter.Object))return String(this);if("Array"===this.class){(t=Interpreter.toStringCycles_).push(this);try{var e=[],r=this.properties.length,i=!1;r>1024&&(r=1e3,i=!0);for(var n=0;n<r;n++){var a=this.properties[n];e[n]=a instanceof Interpreter.Object&&-1!==t.indexOf(a)?"...":a}i&&e.push("...")}finally{t.pop()}return e.join(",")}if("Error"===this.class){var t;if(-1!==(t=Interpreter.toStringCycles_).indexOf(this))return"[object Error]";var o,f,s=this;do{if("name"in s.properties){o=s.properties.name;break}}while(s=s.proto);s=this;do{if("message"in s.properties){f=s.properties.message;break}}while(s=s.proto);t.push(this);try{o=o&&String(o),f=f&&String(f)}finally{t.pop()}return f?o+": "+f:String(o)}return null!==this.data?String(this.data):"[object "+this.class+"]"},Interpreter.Object.prototype.valueOf=function(){return Interpreter.currentInterpreter_?null==this.data||this.data instanceof RegExp?this:this.data instanceof Date?this.data.valueOf():this.data:this},Interpreter.prototype.stepArrayExpression=function(t,e,r){var i=r.elements,n=e.n_||0;for(e.array_?(this.setProperty(e.array_,n,e.value),n++):(e.array_=this.createArray(),e.array_.properties.length=i.length);n<i.length;){if(i[n])return e.n_=n,new Interpreter.State(i[n],e.scope);n++}t.pop(),t[t.length-1].value=e.array_},Interpreter.prototype.stepAssignmentExpression=function(t,e,r){if(!e.doneLeft_){e.doneLeft_=!0;var i=new Interpreter.State(r.left,e.scope);return i.components=!0,i}if(!e.doneRight_){if(e.leftReference_||(e.leftReference_=e.value),e.doneGetter_&&(e.leftValue_=e.value),!e.doneGetter_&&"="!==r.operator){var n=this.getValue(e.leftReference_);if(e.leftValue_=n,this.getterStep_)return e.doneGetter_=!0,this.createGetter_(n,e.leftReference_)}return e.doneRight_=!0,"="===r.operator&&"Identifier"===r.left.type&&(e.destinationName=r.left.name),new Interpreter.State(r.right,e.scope)}if(e.doneSetter_)return t.pop(),void(t[t.length-1].value=e.setterValue_);var o=e.leftValue_,f=e.value;switch(r.operator){case"=":o=f;break;case"+=":o+=f;break;case"-=":o-=f;break;case"*=":o*=f;break;case"/=":o/=f;break;case"%=":o%=f;break;case"<<=":o<<=f;break;case">>=":o>>=f;break;case">>>=":o>>>=f;break;case"&=":o&=f;break;case"^=":o^=f;break;case"|=":o|=f;break;default:throw SyntaxError("Unknown assignment expression: "+r.operator)}var s=this.setValue(e.leftReference_,o);if(s)return e.doneSetter_=!0,e.setterValue_=o,this.createSetter_(s,e.leftReference_,o);t.pop(),t[t.length-1].value=o},Interpreter.prototype.stepBinaryExpression=function(t,e,r){if(!e.doneLeft_)return e.doneLeft_=!0,new Interpreter.State(r.left,e.scope);if(!e.doneRight_)return e.doneRight_=!0,e.leftValue_=e.value,new Interpreter.State(r.right,e.scope);t.pop();var a,i=e.leftValue_,n=e.value;switch(r.operator){case"==":a=i==n;break;case"!=":a=i!=n;break;case"===":a=i===n;break;case"!==":a=i!==n;break;case">":a=i>n;break;case">=":a=i>=n;break;case"<":a=i<n;break;case"<=":a=i<=n;break;case"+":a=i+n;break;case"-":a=i-n;break;case"*":a=i*n;break;case"/":a=i/n;break;case"%":a=i%n;break;case"&":a=i&n;break;case"|":a=i|n;break;case"^":a=i^n;break;case"<<":a=i<<n;break;case">>":a=i>>n;break;case">>>":a=i>>>n;break;case"in":n instanceof Interpreter.Object||this.throwException(this.TYPE_ERROR,"'in' expects an object, not '"+n+"'"),a=this.hasProperty(n,i);break;case"instanceof":this.isa(n,this.FUNCTION)||this.throwException(this.TYPE_ERROR,"Right-hand side of instanceof is not an object"),a=i instanceof Interpreter.Object&&this.isa(i,n);break;default:throw SyntaxError("Unknown binary operator: "+r.operator)}t[t.length-1].value=a},Interpreter.prototype.stepBlockStatement=function(t,e,r){var i=e.n_||0,n=r.body[i];if(n)return e.n_=i+1,new Interpreter.State(n,e.scope);t.pop()},Interpreter.prototype.stepBreakStatement=function(t,e,r){this.unwind(Interpreter.Completion.BREAK,void 0,r.label&&r.label.name)},Interpreter.prototype.evalCodeNumber_=0,Interpreter.prototype.stepCallExpression=function(t,e,r){if(!e.doneCallee_){e.doneCallee_=1;var i=new Interpreter.State(r.callee,e.scope);return i.components=!0,i}if(1===e.doneCallee_){e.doneCallee_=2;var n=e.value;if(Array.isArray(n)){if(e.func_=this.getValue(n),n[0]===Interpreter.SCOPE_REFERENCE?e.directEval_="eval"===n[1]:e.funcThis_=n[0],n=e.func_,this.getterStep_)return e.doneCallee_=1,this.createGetter_(n,e.value)}else e.func_=n;e.arguments_=[],e.n_=0}if(n=e.func_,!e.doneArgs_){if(0!==e.n_&&e.arguments_.push(e.value),r.arguments[e.n_])return new Interpreter.State(r.arguments[e.n_++],e.scope);if("NewExpression"===r.type){if((!(n instanceof Interpreter.Object)||n.illegalConstructor)&&this.throwException(this.TYPE_ERROR,n+" is not a constructor"),n===this.ARRAY)e.funcThis_=this.createArray();else{var a=n.properties.prototype;("object"!=typeof a||null===a)&&(a=this.OBJECT_PROTO),e.funcThis_=this.createObjectProto(a)}e.isConstructor=!0}e.doneArgs_=!0}if(e.doneExec_)t.pop(),t[t.length-1].value=e.isConstructor&&"object"!=typeof e.value?e.funcThis_:e.value;else{e.doneExec_=!0,n instanceof Interpreter.Object||this.throwException(this.TYPE_ERROR,n+" is not a function");var o=n.node;if(o){for(var f=this.createScope(o.body,n.parentScope),s=0;s<o.params.length;s++)this.setProperty(f.object,o.params[s].name,e.arguments_.length>s?e.arguments_[s]:void 0);var O=this.createArray();for(s=0;s<e.arguments_.length;s++)this.setProperty(O,s,e.arguments_[s]);this.setProperty(f.object,"arguments",O);var N=o.id&&o.id.name;return N&&this.setProperty(f.object,N,n),f.strict||(e.funcThis_=this.boxThis_(e.funcThis_)),this.setProperty(f.object,"this",e.funcThis_,Interpreter.READONLY_DESCRIPTOR),e.value=void 0,new Interpreter.State(o.body,f)}if(n.eval){var d=e.arguments_[0];if("string"==typeof d){try{var _=this.parse_(String(d),"eval"+this.evalCodeNumber_++)}catch(M){this.throwException(this.SYNTAX_ERROR,"Invalid code: "+M.message)}var S=new this.newNode;return S.type="EvalProgram_",S.body=_.body,Interpreter.stripLocations_(S,r.start,r.end),(f=e.directEval_?e.scope:this.globalScope).strict?f=this.createScope(_,f):this.populateScope_(_,f),this.value=void 0,new Interpreter.State(S,f)}e.value=d}else if(n.nativeFunc)e.scope.strict||(e.funcThis_=this.boxThis_(e.funcThis_)),e.value=n.nativeFunc.apply(e.funcThis_,e.arguments_);else{if(n.asyncFunc){var U=this,G=n.asyncFunc.length-1,k=e.arguments_.concat(new Array(G)).slice(0,G);return k.push(function(V){e.value=V,U.paused_=!1}),this.paused_=!0,e.scope.strict||(e.funcThis_=this.boxThis_(e.funcThis_)),void n.asyncFunc.apply(e.funcThis_,k)}this.throwException(this.TYPE_ERROR,n.class+" is not callable")}}},Interpreter.prototype.stepConditionalExpression=function(t,e,r){var i=e.mode_||0;if(0===i)return e.mode_=1,new Interpreter.State(r.test,e.scope);if(1===i){e.mode_=2;var n=Boolean(e.value);if(n&&r.consequent)return new Interpreter.State(r.consequent,e.scope);if(!n&&r.alternate)return new Interpreter.State(r.alternate,e.scope);this.value=void 0}t.pop(),"ConditionalExpression"===r.type&&(t[t.length-1].value=e.value)},Interpreter.prototype.stepContinueStatement=function(t,e,r){this.unwind(Interpreter.Completion.CONTINUE,void 0,r.label&&r.label.name)},Interpreter.prototype.stepDebuggerStatement=function(t,e,r){t.pop()},Interpreter.prototype.stepDoWhileStatement=function(t,e,r){if("DoWhileStatement"===r.type&&void 0===e.test_&&(e.value=!0,e.test_=!0),!e.test_)return e.test_=!0,new Interpreter.State(r.test,e.scope);if(e.value){if(r.body)return e.test_=!1,e.isLoop=!0,new Interpreter.State(r.body,e.scope)}else t.pop()},Interpreter.prototype.stepEmptyStatement=function(t,e,r){t.pop()},Interpreter.prototype.stepEvalProgram_=function(t,e,r){var i=e.n_||0,n=r.body[i];if(n)return e.n_=i+1,new Interpreter.State(n,e.scope);t.pop(),t[t.length-1].value=this.value},Interpreter.prototype.stepExpressionStatement=function(t,e,r){if(!e.done_)return this.value=void 0,e.done_=!0,new Interpreter.State(r.expression,e.scope);t.pop(),this.value=e.value},Interpreter.prototype.stepForInStatement=function(t,e,r){if(!e.doneInit_&&(e.doneInit_=!0,r.left.declarations&&r.left.declarations[0].init))return e.scope.strict&&this.throwException(this.SYNTAX_ERROR,"for-in loop variable declaration may not have an initializer."),new Interpreter.State(r.left,e.scope);if(!e.doneObject_)return e.doneObject_=!0,e.variable_||(e.variable_=e.value),new Interpreter.State(r.right,e.scope);if(e.isLoop||(e.isLoop=!0,e.object_=e.value,e.visited_=Object.create(null)),void 0===e.name_)e:for(;;){if(e.object_ instanceof Interpreter.Object){for(e.props_||(e.props_=Object.getOwnPropertyNames(e.object_.properties));void 0!==(i=e.props_.shift());)if(Object.prototype.hasOwnProperty.call(e.object_.properties,i)&&!e.visited_[i]&&(e.visited_[i]=!0,Object.prototype.propertyIsEnumerable.call(e.object_.properties,i))){e.name_=i;break e}}else if(null!=e.object_)for(e.props_||(e.props_=Object.getOwnPropertyNames(e.object_));;){var i;if(void 0===(i=e.props_.shift()))break;if(e.visited_[i]=!0,Object.prototype.propertyIsEnumerable.call(e.object_,i)){e.name_=i;break e}}if(e.object_=this.getPrototype(e.object_),e.props_=null,null===e.object_)return void t.pop()}if(!e.doneVariable_){e.doneVariable_=!0;var n=r.left;if("VariableDeclaration"!==n.type){e.variable_=null;var a=new Interpreter.State(n,e.scope);return a.components=!0,a}e.variable_=[Interpreter.SCOPE_REFERENCE,n.declarations[0].id.name]}if(e.variable_||(e.variable_=e.value),!e.doneSetter_){e.doneSetter_=!0;var o=e.name_,f=this.setValue(e.variable_,o);if(f)return this.createSetter_(f,e.variable_,o)}return e.name_=void 0,e.doneVariable_=!1,e.doneSetter_=!1,r.body?new Interpreter.State(r.body,e.scope):void 0},Interpreter.prototype.stepForStatement=function(t,e,r){switch(e.mode_){default:if(e.mode_=1,r.init)return new Interpreter.State(r.init,e.scope);break;case 1:if(e.mode_=2,r.test)return new Interpreter.State(r.test,e.scope);break;case 2:if(e.mode_=3,!r.test||e.value)return e.isLoop=!0,new Interpreter.State(r.body,e.scope);t.pop();break;case 3:if(e.mode_=1,r.update)return new Interpreter.State(r.update,e.scope)}},Interpreter.prototype.stepFunctionDeclaration=function(t,e,r){t.pop()},Interpreter.prototype.stepFunctionExpression=function(t,e,r){t.pop(),(e=t[t.length-1]).value=this.createFunction(r,e.scope,e.destinationName)},Interpreter.prototype.stepIdentifier=function(t,e,r){if(t.pop(),e.components)t[t.length-1].value=[Interpreter.SCOPE_REFERENCE,r.name];else{var i=this.getValueFromScope(r.name);if(this.getterStep_)return this.createGetter_(i,this.globalObject);t[t.length-1].value=i}},Interpreter.prototype.stepIfStatement=Interpreter.prototype.stepConditionalExpression,Interpreter.prototype.stepLabeledStatement=function(t,e,r){t.pop();var i=e.labels||[];i.push(r.label.name);var n=new Interpreter.State(r.body,e.scope);return n.labels=i,n},Interpreter.prototype.stepLiteral=function(t,e,r){t.pop();var i=r.value;if(i instanceof RegExp){var n=this.createObjectProto(this.REGEXP_PROTO);this.populateRegExp(n,i),i=n}t[t.length-1].value=i},Interpreter.prototype.stepLogicalExpression=function(t,e,r){if("&&"!==r.operator&&"||"!==r.operator)throw SyntaxError("Unknown logical operator: "+r.operator);if(!e.doneLeft_)return e.doneLeft_=!0,new Interpreter.State(r.left,e.scope);if(e.doneRight_)t.pop(),t[t.length-1].value=e.value;else{if(!("&&"===r.operator&&!e.value||"||"===r.operator&&e.value))return e.doneRight_=!0,new Interpreter.State(r.right,e.scope);t.pop(),t[t.length-1].value=e.value}},Interpreter.prototype.stepMemberExpression=function(t,e,r){if(!e.doneObject_)return e.doneObject_=!0,new Interpreter.State(r.object,e.scope);var i;if(r.computed){if(!e.doneProperty_)return e.object_=e.value,e.doneProperty_=!0,new Interpreter.State(r.property,e.scope);i=e.value}else e.object_=e.value,i=r.property.name;if(t.pop(),e.components)t[t.length-1].value=[e.object_,i];else{var n=this.getProperty(e.object_,i);if(this.getterStep_)return this.createGetter_(n,e.object_);t[t.length-1].value=n}},Interpreter.prototype.stepNewExpression=Interpreter.prototype.stepCallExpression,Interpreter.prototype.stepObjectExpression=function(t,e,r){var i=e.n_||0,n=r.properties[i];if(e.object_?(e.properties_[a=e.destinationName]||(e.properties_[a]={}),e.properties_[a][n.kind]=e.value,e.n_=++i,n=r.properties[i]):(e.object_=this.createObjectProto(this.OBJECT_PROTO),e.properties_=Object.create(null)),n){if("Identifier"===(o=n.key).type)var a=o.name;else{if("Literal"!==o.type)throw SyntaxError("Unknown object structure: "+o.type);a=o.value}return e.destinationName=a,new Interpreter.State(n.value,e.scope)}for(var o in e.properties_){var f=e.properties_[o];"get"in f||"set"in f?this.setProperty(e.object_,o,Interpreter.VALUE_IN_DESCRIPTOR,{configurable:!0,enumerable:!0,get:f.get,set:f.set}):this.setProperty(e.object_,o,f.init)}t.pop(),t[t.length-1].value=e.object_},Interpreter.prototype.stepProgram=function(t,e,r){var i=r.body.shift();if(i)return e.done=!1,new Interpreter.State(i,e.scope);e.done=!0},Interpreter.prototype.stepReturnStatement=function(t,e,r){if(r.argument&&!e.done_)return e.done_=!0,new Interpreter.State(r.argument,e.scope);this.unwind(Interpreter.Completion.RETURN,e.value,void 0)},Interpreter.prototype.stepSequenceExpression=function(t,e,r){var i=e.n_||0,n=r.expressions[i];if(n)return e.n_=i+1,new Interpreter.State(n,e.scope);t.pop(),t[t.length-1].value=e.value},Interpreter.prototype.stepSwitchStatement=function(t,e,r){if(!e.test_)return e.test_=1,new Interpreter.State(r.discriminant,e.scope);for(1===e.test_&&(e.test_=2,e.switchValue_=e.value,e.defaultCase_=-1);;){var i=e.index_||0,n=r.cases[i];if(e.matched_||!n||n.test)if(n||e.matched_||-1===e.defaultCase_){if(!n)return void t.pop();if(!e.matched_&&!e.tested_&&n.test)return e.tested_=!0,new Interpreter.State(n.test,e.scope);if(e.matched_||e.value===e.switchValue_){e.matched_=!0;var a=e.n_||0;if(n.consequent[a])return e.isSwitch=!0,e.n_=a+1,new Interpreter.State(n.consequent[a],e.scope)}e.tested_=!1,e.n_=0,e.index_=i+1}else e.matched_=!0,e.index_=e.defaultCase_;else e.defaultCase_=i,e.index_=i+1}},Interpreter.prototype.stepThisExpression=function(t,e,r){t.pop(),t[t.length-1].value=this.getValueFromScope("this")},Interpreter.prototype.stepThrowStatement=function(t,e,r){if(!e.done_)return e.done_=!0,new Interpreter.State(r.argument,e.scope);this.throwException(e.value)},Interpreter.prototype.stepTryStatement=function(t,e,r){if(!e.doneBlock_)return e.doneBlock_=!0,new Interpreter.State(r.block,e.scope);if(e.cv&&e.cv.type===Interpreter.Completion.THROW&&!e.doneHandler_&&r.handler){e.doneHandler_=!0;var i=this.createSpecialScope(e.scope);return this.setProperty(i.object,r.handler.param.name,e.cv.value),e.cv=void 0,new Interpreter.State(r.handler.body,i)}if(!e.doneFinalizer_&&r.finalizer)return e.doneFinalizer_=!0,new Interpreter.State(r.finalizer,e.scope);t.pop(),e.cv&&this.unwind(e.cv.type,e.cv.value,e.cv.label)},Interpreter.prototype.stepUnaryExpression=function(t,e,r){if(!e.done_){e.done_=!0;var i=new Interpreter.State(r.argument,e.scope);return i.components="delete"===r.operator,i}t.pop();var n=e.value;switch(r.operator){case"-":n=-n;break;case"+":n=+n;break;case"!":n=!n;break;case"~":n=~n;break;case"delete":var a=!0;if(Array.isArray(n)){var o=n[0];o===Interpreter.SCOPE_REFERENCE&&(o=e.scope);var f=String(n[1]);try{delete o.properties[f]}catch{e.scope.strict?this.throwException(this.TYPE_ERROR,"Cannot delete property '"+f+"' of '"+o+"'"):a=!1}}n=a;break;case"typeof":n=n&&"Function"===n.class?"function":typeof n;break;case"void":n=void 0;break;default:throw SyntaxError("Unknown unary operator: "+r.operator)}t[t.length-1].value=n},Interpreter.prototype.stepUpdateExpression=function(t,e,r){if(!e.doneLeft_){e.doneLeft_=!0;var i=new Interpreter.State(r.argument,e.scope);return i.components=!0,i}if(e.leftSide_||(e.leftSide_=e.value),e.doneGetter_&&(e.leftValue_=e.value),!e.doneGetter_){var a=this.getValue(e.leftSide_);if(e.leftValue_=a,this.getterStep_)return e.doneGetter_=!0,this.createGetter_(a,e.leftSide_)}if(e.doneSetter_)return t.pop(),void(t[t.length-1].value=e.setterValue_);var o;if(a=Number(e.leftValue_),"++"===r.operator)o=a+1;else{if("--"!==r.operator)throw SyntaxError("Unknown update expression: "+r.operator);o=a-1}var f=r.prefix?o:a,s=this.setValue(e.leftSide_,o);if(s)return e.doneSetter_=!0,e.setterValue_=f,this.createSetter_(s,e.leftSide_,o);t.pop(),t[t.length-1].value=f},Interpreter.prototype.stepVariableDeclaration=function(t,e,r){var i=r.declarations,n=e.n_||0,a=i[n];for(e.init_&&a&&(this.setValueToScope(a.id.name,e.value),e.init_=!1,a=i[++n]);a;){if(a.init)return e.n_=n,e.init_=!0,e.destinationName=a.id.name,new Interpreter.State(a.init,e.scope);a=i[++n]}t.pop()},Interpreter.prototype.stepWithStatement=function(t,e,r){if(!e.doneObject_)return e.doneObject_=!0,new Interpreter.State(r.object,e.scope);t.pop();var i=this.createSpecialScope(e.scope,e.value);return new Interpreter.State(r.body,i)},Interpreter.prototype.stepWhileStatement=Interpreter.prototype.stepDoWhileStatement,Interpreter.nativeGlobal.Interpreter=Interpreter,Interpreter.prototype.step=Interpreter.prototype.step,Interpreter.prototype.run=Interpreter.prototype.run,Interpreter.prototype.appendCode=Interpreter.prototype.appendCode,Interpreter.prototype.createObject=Interpreter.prototype.createObject,Interpreter.prototype.createObjectProto=Interpreter.prototype.createObjectProto,Interpreter.prototype.createAsyncFunction=Interpreter.prototype.createAsyncFunction,Interpreter.prototype.createNativeFunction=Interpreter.prototype.createNativeFunction,Interpreter.prototype.getProperty=Interpreter.prototype.getProperty,Interpreter.prototype.setProperty=Interpreter.prototype.setProperty,Interpreter.prototype.nativeToPseudo=Interpreter.prototype.nativeToPseudo,Interpreter.prototype.pseudoToNative=Interpreter.prototype.pseudoToNative,Interpreter.prototype.getGlobalScope=Interpreter.prototype.getGlobalScope,Interpreter.prototype.getStateStack=Interpreter.prototype.getStateStack,Interpreter.prototype.setStateStack=Interpreter.prototype.setStateStack,Interpreter.VALUE_IN_DESCRIPTOR=Interpreter.VALUE_IN_DESCRIPTOR;class UniqueQueue{_queue;_inQueue;constructor(){this._queue=[],this._inQueue={}}get length(){return this._queue.length}enqueue(e){this._inQueue[e]||(this._queue.push(e),this._inQueue[e]=!0)}dequeue(){const e=this._queue.shift();return delete this._inQueue[e],e}remove(e){this._inQueue[e]&&(delete this._inQueue[e],this._queue=this._queue.filter(r=>r!==e))}}class DependencyStore{_dependencies;_triggers;constructor(){this._dependencies={},this._triggers={}}add(e,r){this._dependencies[e]||(this._dependencies[e]={}),this._dependencies[e][r]=!0,this._triggers[r]||(this._triggers[r]={}),this._triggers[r][e]=!0}reset(e){const r=this._dependencies[e];if(r)for(let i in r)this._triggers[i]&&delete this._triggers[i][e];this._dependencies[e]={}}triggers(e){return Object.keys(this._triggers[e]||{})}dependencies(e){return Object.keys(this._dependencies[e]||{})}}class CalculationEngine{static _getPath(e,r,i){return i?(e||"")+"["+r+"]":(e&&e.length>0?e+".":"")+r}static flattenObject(e){return function r(i,n){const a=Array.isArray(i);return Object.keys(i).reduce(function(o,f){const s=CalculationEngine._getPath(n,f,a),h=i[f];return h&&"object"==typeof h?Object.assign(o,r(h,s)):o[s]=h,o},{})}(e)}static unflattenObject(e){const r={};return Object.keys(e).forEach(function(i){const n=e[i],a=i.split(".").flatMap(h=>h.split("[").map((E,O)=>0===O?E:(E=parseInt(E),isNaN(E)?null:E)).filter(function(E){return null!==E}).map(function(E,O,N){return{prop:E,isArray:O!==N.length-1}}));let o=r,f=r,s=null;for(let h of a)null!==s&&(o[s]=f,o=f),s=h.prop,f=o[s]?o[s]:h.isArray?[]:{};o[s]=n}),r}_currentPath;_dependencyStore;_expressions;_state;_listenerState;_changeCallbacks;_expressionQueue;_running;constructor(){this._dependencyStore=new DependencyStore,this._changeCallbacks=[],this._expressionQueue=new UniqueQueue,this._state={},this._listenerState={},this._expressions={}}registerChangeCallback(e){this._changeCallbacks.push(e)}registerValue(e,r){this.setValue(e,r)}registerExpression(e,r){this._expressions[e]={expression:r,isListener:!1},this.setValue(e,null),this._expressionQueue.enqueue(e)}registerListenerExpression(e,r){this._expressions[e]={expression:r,isListener:!0},this.setListenerValue(e,null),this._expressionQueue.enqueue(e)}deregisterValue(e){delete this._state[e],this._triggerDependents(e)}deregisterExpression(e){delete this._expressions[e],delete this._state[e],this._expressionQueue.remove(e),this._triggerDependents(e)}deregisterListenerExpression(e){delete this._expressions[e],delete this._listenerState[e],this._expressionQueue.remove(e)}start(){setTimeout(this._run.bind(this),0)}getTriggers(e){return this._dependencyStore.triggers(e)}getDependencies(e){return this._dependencyStore.dependencies(e)}getValue(e){return this._state[e]}setValue(e,r){this._state[e]=r;for(let i of this._changeCallbacks)i(e,r);this._triggerDependents(e)}getListenerValue(e){return this._listenerState[e]}setListenerValue(e,r){this._listenerState[e]=r;for(let i of this._changeCallbacks)i(e,r)}_registerDependency(e){this._currentPath&&this._dependencyStore.add(this._currentPath,e)}_triggerDependents(e){const r=this.getTriggers(e);for(let i of r)this._expressionQueue.enqueue(i);this._run()}_startTracking(e){this._currentPath=e,this._dependencyStore.reset(e)}_stopTracking(){this._currentPath=null}_executeCalculation(e,r,i){const n=this;let a=!1,o=n.getValue(e);const f=new Interpreter(r,(E,O)=>{const N=(S,U)=>function(){return this._registerDependency(S),U}.bind(n),d=S=>function(){return this._registerDependency(S),this.getValue(S)}.bind(n),_=(S,U)=>{const D=Array.isArray(S),G=U?E.nativeToPseudo(D?[]:{}):O;for(let k in S)if(S.hasOwnProperty(k)){let V=S[k],M=CalculationEngine._getPath(U,k,D),w=V&&"object"==typeof V?N(M,_(V,M)):d(M);E.setProperty(G,k,Interpreter.VALUE_IN_DESCRIPTOR,{get:E.createNativeFunction(w)})}return G};_(CalculationEngine.unflattenObject(i),null),E.setProperty(O,"$value",Interpreter.VALUE_IN_DESCRIPTOR,{get:E.createNativeFunction(function(){return o}),set:E.createNativeFunction(function(S){return a=!0,o=S,S})}),E.setProperty(O,"$value",Interpreter.VALUE_IN_DESCRIPTOR,{get:E.createNativeFunction(function(){return o}),set:E.createNativeFunction(function(S){return a=!0,o=S,S})})});f.run();let s=a?o:f.value,h=typeof s;if("undefined"===h)return null;if(null===s||"number"===h||"boolean"===h||"string"===h)return s;throw"Only primitive types (number, boolean, string, and null) can be returned from calculations."}_calculateStep(e,r,i){this._startTracking(e);let n=null;try{n=this._executeCalculation(e,r,i)}catch(a){console.error("Calculation '"+e+"' failed. "+(a?.message||a))}return this._stopTracking(),n}_run(){if(!this._running){this._running=!0;for(let r=0;r<25&&this._expressionQueue.length>0;r++){let i=this._expressionQueue.dequeue(),n=this._expressions[i],a=this._calculateStep(i,n.expression,this._state);n.isListener?this.getListenerValue(i)!==a&&this.setListenerValue(i,a):this.getValue(i)!==a&&this.setValue(i,a),setTimeout(this._run.bind(this),0)}this._running=!1}}}